[
  {
    "question": "Which drivers scored more than 20 total points in seasons where they had at least 3 podium finishes?",
    "sql": "SELECT drivers.forename, drivers.surname, SUM(results.points) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId WHERE results.position <= 3 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING SUM(results.points) > 20 AND COUNT(results.resultId) >= 3 ORDER BY SUM(results.points) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position <= 3 WITH driver, sum(result.points) AS totalPoints, count(result) AS podiums WHERE totalPoints > 20 AND podiums >= 3 RETURN driver.forename, driver.surname, totalPoints ORDER BY totalPoints DESC"
  },
  {
    "question": "Find constructors whose drivers finished in the top 5 more than 10 times at circuits in Europe",
    "sql": "SELECT constructors.name, COUNT(results.resultId) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE results.position <= 5 AND circuits.country IN ('UK', 'Italy', 'Spain', 'Monaco', 'Belgium', 'Germany', 'France', 'Hungary', 'Austria', 'Portugal') GROUP BY constructors.constructorId, constructors.name HAVING COUNT(results.resultId) > 10 ORDER BY COUNT(results.resultId) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position <= 5 AND circuit.country IN ['UK', 'Italy', 'Spain', 'Monaco', 'Belgium', 'Germany', 'France', 'Hungary', 'Austria', 'Portugal'] WITH constructor, count(result) AS top5Count WHERE top5Count > 10 RETURN constructor.name, top5Count ORDER BY top5Count DESC"
  },
  {
    "question": "Which drivers won races at circuits where they also qualified in pole position, having done this more than twice?",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(DISTINCT results.raceId) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN qualifying ON drivers.driverId = qualifying.driverId AND results.raceId = qualifying.raceId JOIN races ON results.raceId = races.raceId WHERE results.position = 1 AND qualifying.position = 1 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(DISTINCT results.raceId) > 2 ORDER BY COUNT(DISTINCT results.raceId) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races), (driver)-[:QUALIFIED_IN]->(qualifying:qualifying)-[:FOR_RACE]->(race) WHERE result.position = 1 AND qualifying.position = 1 WITH driver, count(DISTINCT race) AS poleWins WHERE poleWins > 2 RETURN driver.forename, driver.surname, poleWins ORDER BY poleWins DESC"
  },
  {
    "question": "Find British constructors that scored more than 50 total points in races held after 2000 with at least 5 podium finishes",
    "sql": "SELECT constructors.name, SUM(results.points), COUNT(results.resultId) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE constructors.nationality = 'British' AND races.year > 2000 AND results.position <= 3 GROUP BY constructors.constructorId, constructors.name HAVING SUM(results.points) > 50 AND COUNT(results.resultId) >= 5 ORDER BY SUM(results.points) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE constructor.nationality = 'British' AND race.year > '2000' AND result.position <= 3 WITH constructor, sum(result.points) AS totalPoints, count(result) AS podiums WHERE totalPoints > 50 AND podiums >= 5 RETURN constructor.name, totalPoints, podiums ORDER BY totalPoints DESC"
  },
  {
    "question": "Which drivers from countries that have produced more than 5 F1 drivers scored points at circuits in their home country?",
    "sql": "SELECT drivers.forename, drivers.surname, drivers.nationality, SUM(results.points) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE results.points > 0 AND drivers.nationality IN (SELECT drivers.nationality FROM drivers GROUP BY drivers.nationality HAVING COUNT(drivers.driverId) > 5) GROUP BY drivers.driverId, drivers.forename, drivers.surname, drivers.nationality HAVING SUM(results.points) > 0 ORDER BY SUM(results.points) DESC",
    "cypher": "MATCH (d:drivers) WITH d.nationality AS nat, count(d) AS driverCount WHERE driverCount > 5 WITH collect(nat) AS validNationalities MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.points > 0 AND driver.nationality IN validNationalities WITH driver, sum(result.points) AS homePoints WHERE homePoints > 0 RETURN driver.forename, driver.surname, driver.nationality, homePoints ORDER BY homePoints DESC"
  },
  {
    "question": "Find drivers who had more than 3 DNFs but also won at least 2 races in the same season",
    "sql": "SELECT drivers.forename, drivers.surname, races.year, COUNT(DISTINCT CASE WHEN results.position IS NULL OR results.statusId != 1 THEN results.resultId END), COUNT(DISTINCT CASE WHEN results.position = 1 THEN results.resultId END) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId GROUP BY drivers.driverId, drivers.forename, drivers.surname, races.year HAVING COUNT(DISTINCT CASE WHEN results.position = 1 THEN results.resultId END) >= 2 ORDER BY races.year DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WITH driver, race.year AS season, sum(CASE WHEN result.position = 1 THEN 1 ELSE 0 END) AS wins WHERE wins >= 2 RETURN driver.forename, driver.surname, season, wins ORDER BY season DESC"
  },
  {
    "question": "Which constructors had drivers qualify in the top 3 more than 15 times in seasons after 1990?",
    "sql": "SELECT constructors.name, COUNT(qualifying.qualifyId) FROM constructors JOIN qualifying ON constructors.constructorId = qualifying.constructorId JOIN races ON qualifying.raceId = races.raceId WHERE qualifying.position <= 3 AND races.year > 1990 GROUP BY constructors.constructorId, constructors.name HAVING COUNT(qualifying.qualifyId) > 15 ORDER BY COUNT(qualifying.qualifyId) DESC",
    "cypher": "MATCH (constructor:constructors)-[:QUALIFIED_IN]->(qualifying:qualifying)-[:FOR_RACE]->(race:races) WHERE qualifying.position <= 3 AND race.year > '1990' WITH constructor, count(qualifying) AS topQualifyCount WHERE topQualifyCount > 15 RETURN constructor.name, topQualifyCount ORDER BY topQualifyCount DESC"
  },
  {
    "question": "Find drivers who scored points in more than 5 different countries and had at least 10 total points",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(DISTINCT circuits.country), SUM(results.points) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE results.points > 0 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(DISTINCT circuits.country) > 5 AND SUM(results.points) >= 10 ORDER BY COUNT(DISTINCT circuits.country) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.points > 0 WITH driver, count(DISTINCT circuit.country) AS countryCount, sum(result.points) AS totalPoints WHERE countryCount > 5 AND totalPoints >= 10 RETURN driver.forename, driver.surname, countryCount, totalPoints ORDER BY countryCount DESC"
  },
  {
    "question": "Which circuits hosted races where more than 5 different constructors had drivers finish on the podium?",
    "sql": "SELECT circuits.name, circuits.country, COUNT(DISTINCT constructors.constructorId) FROM circuits JOIN races ON circuits.circuitId = races.circuitId JOIN results ON races.raceId = results.raceId JOIN constructors ON results.constructorId = constructors.constructorId WHERE results.position <= 3 GROUP BY circuits.circuitId, circuits.name, circuits.country HAVING COUNT(DISTINCT constructors.constructorId) > 5 ORDER BY COUNT(DISTINCT constructors.constructorId) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position <= 3 WITH circuit, count(DISTINCT constructor) AS constructorCount WHERE constructorCount > 5 RETURN circuit.name, circuit.country, constructorCount ORDER BY constructorCount DESC"
  },
  {
    "question": "Find the top 10 drivers by average points per race, considering only those with more than 20 race entries",
    "sql": "SELECT drivers.forename, drivers.surname, AVG(results.points), COUNT(results.resultId) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(results.resultId) > 20 ORDER BY AVG(results.points) DESC LIMIT 10",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WITH driver, avg(result.points) AS avgPoints, count(result) AS raceCount WHERE raceCount > 20 RETURN driver.forename, driver.surname, avgPoints, raceCount ORDER BY avgPoints DESC LIMIT 10"
  },
  {
    "question": "Which nationality of drivers has won races at more than 3 different circuits?",
    "sql": "SELECT drivers.nationality, COUNT(DISTINCT circuits.circuitId) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE results.position = 1 GROUP BY drivers.nationality HAVING COUNT(DISTINCT circuits.circuitId) > 3 ORDER BY COUNT(DISTINCT circuits.circuitId) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position = 1 WITH driver.nationality AS nationality, count(DISTINCT circuit) AS circuitCount WHERE circuitCount > 3 RETURN nationality, circuitCount ORDER BY circuitCount DESC"
  },
  {
    "question": "Find constructors that had at least 2 drivers score points in the same race more than 5 times",
    "sql": "SELECT constructors.name, COUNT(DISTINCT races.raceId) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE results.points > 0 GROUP BY constructors.constructorId, constructors.name, races.raceId HAVING COUNT(DISTINCT results.driverId) >= 2",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.points > 0 WITH constructor, race, count(DISTINCT result.driverId) AS driverCount WHERE driverCount >= 2 WITH constructor, count(race) AS raceCount WHERE raceCount > 5 RETURN constructor.name, raceCount ORDER BY raceCount DESC"
  },
  {
    "question": "Which drivers improved their grid position by more than 5 places in at least 3 races at circuits above 500m altitude?",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(results.resultId) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE circuits.alt > 500 AND (results.grid - results.position) > 5 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(results.resultId) >= 3 ORDER BY COUNT(results.resultId) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE circuit.alt > 500 AND (result.grid - result.position) > 5 WITH driver, count(result) AS improvementCount WHERE improvementCount >= 3 RETURN driver.forename, driver.surname, improvementCount ORDER BY improvementCount DESC"
  },
  {
    "question": "Find the constructors whose average finishing position is better than 5th place with more than 50 race finishes",
    "sql": "SELECT constructors.name, AVG(results.position), COUNT(results.resultId) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE results.position IS NOT NULL GROUP BY constructors.constructorId, constructors.name HAVING AVG(results.position) < 5 AND COUNT(results.resultId) > 50 ORDER BY AVG(results.position)",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position IS NOT NULL WITH constructor, avg(result.position) AS avgPosition, count(result) AS finishes WHERE avgPosition < 5 AND finishes > 50 RETURN constructor.name, avgPosition, finishes ORDER BY avgPosition"
  },
  {
    "question": "Which drivers scored points in races at circuits that hosted more than 20 races historically?",
    "sql": "SELECT drivers.forename, drivers.surname, SUM(results.points) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE results.points > 0 AND circuits.circuitId IN (SELECT circuits.circuitId FROM circuits JOIN races ON circuits.circuitId = races.circuitId GROUP BY circuits.circuitId HAVING COUNT(races.raceId) > 20) GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING SUM(results.points) > 5 ORDER BY SUM(results.points) DESC",
    "cypher": "MATCH (r:races)-[:HELD_AT]->(c:circuits) WITH c, count(r) AS raceCount WHERE raceCount > 20 WITH collect(c) AS validCircuits MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.points > 0 AND circuit IN validCircuits WITH driver, sum(result.points) AS totalPoints WHERE totalPoints > 5 RETURN driver.forename, driver.surname, totalPoints ORDER BY totalPoints DESC"
  },
  {
    "question": "Find drivers who have both won and had pole position at Monaco with total points above 10",
    "sql": "SELECT drivers.forename, drivers.surname, SUM(results.points) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN qualifying ON drivers.driverId = qualifying.driverId AND results.raceId = qualifying.raceId JOIN races ON results.raceId = races.raceId WHERE races.name LIKE '%Monaco%' AND results.position = 1 AND qualifying.position = 1 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING SUM(results.points) > 10 ORDER BY SUM(results.points) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races), (driver)-[:QUALIFIED_IN]->(qualifying:qualifying)-[:FOR_RACE]->(race) WHERE race.name CONTAINS 'Monaco' AND result.position = 1 AND qualifying.position = 1 WITH driver, sum(result.points) AS totalPoints WHERE totalPoints > 10 RETURN driver.forename, driver.surname, totalPoints ORDER BY totalPoints DESC"
  },
  {
    "question": "Which constructors had drivers from more than 3 different nationalities compete for them?",
    "sql": "SELECT constructors.name, COUNT(DISTINCT drivers.nationality) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN drivers ON results.driverId = drivers.driverId JOIN races ON results.raceId = races.raceId GROUP BY constructors.constructorId, constructors.name HAVING COUNT(DISTINCT drivers.nationality) > 3 ORDER BY COUNT(DISTINCT drivers.nationality) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)<-[:ACHIEVED]-(driver:drivers) WITH constructor, count(DISTINCT driver.nationality) AS nationalityCount WHERE nationalityCount > 3 RETURN constructor.name, nationalityCount ORDER BY nationalityCount DESC"
  },
  {
    "question": "Find the top 5 circuits by total points scored across all races, excluding circuits with fewer than 10 races",
    "sql": "SELECT circuits.name, circuits.country, SUM(results.points), COUNT(DISTINCT races.raceId) FROM circuits JOIN races ON circuits.circuitId = races.circuitId JOIN results ON races.raceId = results.raceId GROUP BY circuits.circuitId, circuits.name, circuits.country HAVING COUNT(DISTINCT races.raceId) >= 10 ORDER BY SUM(results.points) DESC LIMIT 5",
    "cypher": "MATCH (result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WITH circuit, sum(result.points) AS totalPoints, count(DISTINCT race) AS raceCount WHERE raceCount >= 10 RETURN circuit.name, circuit.country, totalPoints, raceCount ORDER BY totalPoints DESC LIMIT 5"
  },
  {
    "question": "Which drivers finished every race they entered in a season with at least 10 races?",
    "sql": "SELECT drivers.forename, drivers.surname, races.year, COUNT(results.resultId) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId WHERE results.laps > 0 GROUP BY drivers.driverId, drivers.forename, drivers.surname, races.year HAVING COUNT(results.resultId) >= 10 ORDER BY COUNT(results.resultId) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.laps > 0 WITH driver, race.year AS season, count(result) AS raceCount WHERE raceCount >= 10 RETURN driver.forename, driver.surname, season, raceCount ORDER BY raceCount DESC"
  },
  {
    "question": "Find Italian constructors that had more than 20 podium finishes at European circuits",
    "sql": "SELECT constructors.name, COUNT(results.resultId) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE constructors.nationality = 'Italian' AND results.position <= 3 AND circuits.country IN ('UK', 'Italy', 'Spain', 'Monaco', 'Belgium', 'Germany', 'France', 'Hungary', 'Austria') GROUP BY constructors.constructorId, constructors.name HAVING COUNT(results.resultId) > 20 ORDER BY COUNT(results.resultId) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE constructor.nationality = 'Italian' AND result.position <= 3 AND circuit.country IN ['UK', 'Italy', 'Spain', 'Monaco', 'Belgium', 'Germany', 'France', 'Hungary', 'Austria'] WITH constructor, count(result) AS podiumCount WHERE podiumCount > 20 RETURN constructor.name, podiumCount ORDER BY podiumCount DESC"
  },
  {
    "question": "Which drivers have won races in at least 3 different decades?",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(DISTINCT (races.year / 10) * 10) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId WHERE results.position = 1 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(DISTINCT (races.year / 10) * 10) >= 3 ORDER BY COUNT(DISTINCT (races.year / 10) * 10) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position = 1 WITH driver, count(DISTINCT substring(race.year, 0, 3)) AS decadeCount WHERE decadeCount >= 3 RETURN driver.forename, driver.surname, decadeCount ORDER BY decadeCount DESC"
  },
  {
    "question": "Find drivers who scored more points in qualifying races than their average season points with at least 5 races",
    "sql": "SELECT drivers.forename, drivers.surname, races.year, SUM(results.points), AVG(results.points) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId GROUP BY drivers.driverId, drivers.forename, drivers.surname, races.year HAVING COUNT(results.resultId) >= 5 AND SUM(results.points) > 10 ORDER BY SUM(results.points) DESC LIMIT 20",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WITH driver, race.year AS season, sum(result.points) AS totalPoints, avg(result.points) AS avgPoints, count(result) AS raceCount WHERE raceCount >= 5 AND totalPoints > 10 RETURN driver.forename, driver.surname, season, totalPoints, avgPoints ORDER BY totalPoints DESC LIMIT 20"
  },
  {
    "question": "Which constructors have had drivers win at both Monaco and Silverstone circuits?",
    "sql": "SELECT DISTINCT constructors.name FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE results.position = 1 AND circuits.name IN ('Circuit de Monaco', 'Silverstone Circuit') GROUP BY constructors.constructorId, constructors.name HAVING COUNT(DISTINCT circuits.circuitId) >= 2",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position = 1 AND circuit.name IN ['Circuit de Monaco', 'Silverstone Circuit'] WITH constructor, count(DISTINCT circuit) AS circuitCount WHERE circuitCount >= 2 RETURN DISTINCT constructor.name"
  },
  {
    "question": "Find drivers whose best qualifying position was better than their best race finish, with at least 10 races",
    "sql": "SELECT drivers.forename, drivers.surname, MIN(qualifying.position), MIN(results.position), COUNT(DISTINCT results.raceId) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN qualifying ON drivers.driverId = qualifying.driverId AND results.raceId = qualifying.raceId JOIN races ON results.raceId = races.raceId GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING MIN(qualifying.position) < MIN(results.position) AND COUNT(DISTINCT results.raceId) >= 10 ORDER BY MIN(qualifying.position)",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races), (driver)-[:QUALIFIED_IN]->(qualifying:qualifying)-[:FOR_RACE]->(race) WITH driver, min(qualifying.position) AS bestQualify, min(result.position) AS bestFinish, count(DISTINCT race) AS raceCount WHERE bestQualify < bestFinish AND raceCount >= 10 RETURN driver.forename, driver.surname, bestQualify, bestFinish, raceCount ORDER BY bestQualify"
  },
  {
    "question": "Which seasons had more than 10 different race winners?",
    "sql": "SELECT races.year, COUNT(DISTINCT results.driverId) FROM races JOIN results ON races.raceId = results.raceId JOIN drivers ON results.driverId = drivers.driverId WHERE results.position = 1 GROUP BY races.year HAVING COUNT(DISTINCT results.driverId) > 10 ORDER BY COUNT(DISTINCT results.driverId) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position = 1 WITH race.year AS season, count(DISTINCT driver) AS winnerCount WHERE winnerCount > 10 RETURN season, winnerCount ORDER BY winnerCount DESC"
  },
  {
    "question": "Find drivers who had more than 5 pole positions but fewer than 10 wins in their career",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(DISTINCT CASE WHEN qualifying.position = 1 THEN qualifying.qualifyId END), COUNT(DISTINCT CASE WHEN results.position = 1 THEN results.resultId END) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN qualifying ON drivers.driverId = qualifying.driverId AND results.raceId = qualifying.raceId JOIN races ON results.raceId = races.raceId GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(DISTINCT CASE WHEN qualifying.position = 1 THEN qualifying.qualifyId END) > 5 AND COUNT(DISTINCT CASE WHEN results.position = 1 THEN results.resultId END) < 10",
    "cypher": "MATCH (driver:drivers)-[:QUALIFIED_IN]->(qualifying:qualifying)-[:FOR_RACE]->(race:races) WHERE qualifying.position = 1 WITH driver, count(qualifying) AS poles MATCH (driver)-[:ACHIEVED]->(result:results) WHERE result.position = 1 WITH driver, poles, count(result) AS wins WHERE poles > 5 AND wins < 10 RETURN driver.forename, driver.surname, poles, wins"
  },
  {
    "question": "Which constructors scored points in more than 50% of races they entered after 1990?",
    "sql": "SELECT constructors.name, COUNT(DISTINCT CASE WHEN results.points > 0 THEN results.raceId END), COUNT(DISTINCT results.raceId) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE races.year > 1990 GROUP BY constructors.constructorId, constructors.name HAVING COUNT(DISTINCT CASE WHEN results.points > 0 THEN results.raceId END) > COUNT(DISTINCT results.raceId) * 0.5 ORDER BY COUNT(DISTINCT results.raceId) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE race.year > '1990' WITH constructor, count(DISTINCT race) AS totalRaces, sum(CASE WHEN result.points > 0 THEN 1 ELSE 0 END) AS pointsRaces WHERE pointsRaces > totalRaces * 0.5 RETURN constructor.name, pointsRaces, totalRaces ORDER BY totalRaces DESC"
  },
  {
    "question": "Find circuits where British drivers have won more than 3 times",
    "sql": "SELECT circuits.name, circuits.country, COUNT(results.resultId) FROM circuits JOIN races ON circuits.circuitId = races.circuitId JOIN results ON races.raceId = results.raceId JOIN drivers ON results.driverId = drivers.driverId WHERE drivers.nationality = 'British' AND results.position = 1 GROUP BY circuits.circuitId, circuits.name, circuits.country HAVING COUNT(results.resultId) > 3 ORDER BY COUNT(results.resultId) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE driver.nationality = 'British' AND result.position = 1 WITH circuit, count(result) AS winCount WHERE winCount > 3 RETURN circuit.name, circuit.country, winCount ORDER BY winCount DESC"
  },
  {
    "question": "Which drivers scored their first points at a circuit that later hosted more than 10 races?",
    "sql": "SELECT DISTINCT drivers.forename, drivers.surname, circuits.name FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE results.points > 0 AND circuits.circuitId IN (SELECT circuits.circuitId FROM circuits JOIN races ON circuits.circuitId = races.circuitId GROUP BY circuits.circuitId HAVING COUNT(races.raceId) > 10) GROUP BY drivers.driverId, drivers.forename, drivers.surname, circuits.name HAVING COUNT(results.resultId) >= 1 ORDER BY drivers.surname LIMIT 20",
    "cypher": "MATCH (race:races)-[:HELD_AT]->(circuit:circuits) WITH circuit, count(race) AS raceCount WHERE raceCount > 10 WITH collect(circuit) AS validCircuits MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.points > 0 AND circuit IN validCircuits WITH driver, circuit, count(result) AS resultCount WHERE resultCount >= 1 RETURN DISTINCT driver.forename, driver.surname, circuit.name ORDER BY driver.surname LIMIT 20"
  },
  {
    "question": "Find the constructors with the highest win rate among those with more than 30 race entries",
    "sql": "SELECT constructors.name, COUNT(DISTINCT CASE WHEN results.position = 1 THEN results.raceId END), COUNT(DISTINCT results.raceId) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId GROUP BY constructors.constructorId, constructors.name HAVING COUNT(DISTINCT results.raceId) > 30 ORDER BY COUNT(DISTINCT CASE WHEN results.position = 1 THEN results.raceId END) * 1.0 / COUNT(DISTINCT results.raceId) DESC LIMIT 10",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WITH constructor, count(DISTINCT race) AS totalRaces, sum(CASE WHEN result.position = 1 THEN 1 ELSE 0 END) AS wins WHERE totalRaces > 30 RETURN constructor.name, wins, totalRaces ORDER BY toFloat(wins) / totalRaces DESC LIMIT 10"
  },
  {
    "question": "Which drivers have competed for more than 2 different constructors and scored points for each?",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(DISTINCT constructors.constructorId) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN constructors ON results.constructorId = constructors.constructorId JOIN races ON results.raceId = races.raceId WHERE results.points > 0 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(DISTINCT constructors.constructorId) > 2 ORDER BY COUNT(DISTINCT constructors.constructorId) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)<-[:ACHIEVED]-(constructor:constructors) WHERE result.points > 0 WITH driver, count(DISTINCT constructor) AS constructorCount WHERE constructorCount > 2 RETURN driver.forename, driver.surname, constructorCount ORDER BY constructorCount DESC"
  },
  {
    "question": "Find races where the winner started outside the top 5 grid positions with at least 50 laps completed",
    "sql": "SELECT races.name, races.year, drivers.forename, drivers.surname, results.grid, results.laps FROM races JOIN results ON races.raceId = results.raceId JOIN drivers ON results.driverId = drivers.driverId JOIN circuits ON races.circuitId = circuits.circuitId WHERE results.position = 1 AND results.grid > 5 AND results.laps >= 50 GROUP BY races.raceId, races.name, races.year, drivers.forename, drivers.surname, results.grid, results.laps HAVING COUNT(results.resultId) >= 1 ORDER BY results.grid DESC LIMIT 15",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position = 1 AND result.grid > 5 AND result.laps >= 50 RETURN race.name, race.year, driver.forename, driver.surname, result.grid, result.laps ORDER BY result.grid DESC LIMIT 15"
  },
  {
    "question": "Which nationalities have produced drivers with more than 100 total career points?",
    "sql": "SELECT drivers.nationality, COUNT(DISTINCT drivers.driverId), SUM(results.points) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId GROUP BY drivers.nationality HAVING SUM(results.points) > 100 ORDER BY SUM(results.points) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WITH driver.nationality AS nationality, count(DISTINCT driver) AS driverCount, sum(result.points) AS totalPoints WHERE totalPoints > 100 RETURN nationality, driverCount, totalPoints ORDER BY totalPoints DESC"
  },
  {
    "question": "Find constructors that won races in both the 1980s and 2000s",
    "sql": "SELECT constructors.name FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE results.position = 1 AND ((races.year >= 1980 AND races.year < 1990) OR (races.year >= 2000 AND races.year < 2010)) GROUP BY constructors.constructorId, constructors.name HAVING COUNT(DISTINCT CASE WHEN races.year >= 1980 AND races.year < 1990 THEN races.raceId END) > 0 AND COUNT(DISTINCT CASE WHEN races.year >= 2000 AND races.year < 2010 THEN races.raceId END) > 0",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position = 1 WITH constructor, sum(CASE WHEN race.year >= '1980' AND race.year < '1990' THEN 1 ELSE 0 END) AS wins80s, sum(CASE WHEN race.year >= '2000' AND race.year < '2010' THEN 1 ELSE 0 END) AS wins00s WHERE wins80s > 0 AND wins00s > 0 RETURN constructor.name, wins80s, wins00s"
  },
  {
    "question": "Which drivers had the most consistent qualifying performance with a standard deviation of position less than 3 over 10 races?",
    "sql": "SELECT drivers.forename, drivers.surname, AVG(qualifying.position), COUNT(qualifying.qualifyId) FROM drivers JOIN qualifying ON drivers.driverId = qualifying.driverId JOIN races ON qualifying.raceId = races.raceId GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(qualifying.qualifyId) >= 10 ORDER BY AVG(qualifying.position) LIMIT 15",
    "cypher": "MATCH (driver:drivers)-[:QUALIFIED_IN]->(qualifying:qualifying)-[:FOR_RACE]->(race:races) WITH driver, avg(qualifying.position) AS avgPosition, count(qualifying) AS qualifyCount WHERE qualifyCount >= 10 RETURN driver.forename, driver.surname, avgPosition, qualifyCount ORDER BY avgPosition LIMIT 15"
  },
  {
    "question": "Find circuits with an average race finish time where more than 15 drivers have finished races",
    "sql": "SELECT circuits.name, circuits.country, COUNT(DISTINCT drivers.driverId), AVG(results.laps) FROM circuits JOIN races ON circuits.circuitId = races.circuitId JOIN results ON races.raceId = results.raceId JOIN drivers ON results.driverId = drivers.driverId WHERE results.laps > 0 GROUP BY circuits.circuitId, circuits.name, circuits.country HAVING COUNT(DISTINCT drivers.driverId) > 15 ORDER BY AVG(results.laps) DESC LIMIT 10",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.laps > 0 WITH circuit, count(DISTINCT driver) AS driverCount, avg(result.laps) AS avgLaps WHERE driverCount > 15 RETURN circuit.name, circuit.country, driverCount, avgLaps ORDER BY avgLaps DESC LIMIT 10"
  },
  {
    "question": "Which seasons had constructors with more than 3 drivers scoring points?",
    "sql": "SELECT races.year, constructors.name, COUNT(DISTINCT drivers.driverId) FROM races JOIN results ON races.raceId = results.raceId JOIN constructors ON results.constructorId = constructors.constructorId JOIN drivers ON results.driverId = drivers.driverId WHERE results.points > 0 GROUP BY races.year, constructors.constructorId, constructors.name HAVING COUNT(DISTINCT drivers.driverId) > 3 ORDER BY races.year DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races), (constructor:constructors)-[:ACHIEVED]->(result) WHERE result.points > 0 WITH race.year AS season, constructor, count(DISTINCT driver) AS driverCount WHERE driverCount > 3 RETURN season, constructor.name, driverCount ORDER BY season DESC"
  },
  {
    "question": "Find drivers who won at high-altitude circuits above 500 meters with more than 2 wins",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(results.resultId), circuits.name, circuits.alt FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE results.position = 1 AND circuits.alt > 500 GROUP BY drivers.driverId, drivers.forename, drivers.surname, circuits.circuitId, circuits.name, circuits.alt HAVING COUNT(results.resultId) > 2 ORDER BY COUNT(results.resultId) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position = 1 AND circuit.alt > 500 WITH driver, circuit, count(result) AS winCount WHERE winCount > 2 RETURN driver.forename, driver.surname, winCount, circuit.name, circuit.alt ORDER BY winCount DESC"
  },
  {
    "question": "Which constructors had their drivers qualify in the top 10 more than 75% of the time in seasons after 1995?",
    "sql": "SELECT constructors.name, COUNT(DISTINCT CASE WHEN qualifying.position <= 10 THEN qualifying.qualifyId END), COUNT(DISTINCT qualifying.qualifyId) FROM constructors JOIN qualifying ON constructors.constructorId = qualifying.constructorId JOIN races ON qualifying.raceId = races.raceId WHERE races.year > 1995 GROUP BY constructors.constructorId, constructors.name HAVING COUNT(DISTINCT CASE WHEN qualifying.position <= 10 THEN qualifying.qualifyId END) > COUNT(DISTINCT qualifying.qualifyId) * 0.75 AND COUNT(DISTINCT qualifying.qualifyId) > 20 ORDER BY COUNT(DISTINCT qualifying.qualifyId) DESC",
    "cypher": "MATCH (constructor:constructors)-[:QUALIFIED_IN]->(qualifying:qualifying)-[:FOR_RACE]->(race:races) WHERE race.year > '1995' WITH constructor, count(qualifying) AS totalQualify, sum(CASE WHEN qualifying.position <= 10 THEN 1 ELSE 0 END) AS top10Qualify WHERE top10Qualify > totalQualify * 0.75 AND totalQualify > 20 RETURN constructor.name, top10Qualify, totalQualify ORDER BY totalQualify DESC"
  },
  {
    "question": "Find the drivers with the best average grid-to-finish position improvement over their career with at least 20 races",
    "sql": "SELECT drivers.forename, drivers.surname, AVG(results.grid - results.position), COUNT(results.resultId) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId WHERE results.grid > 0 AND results.position > 0 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(results.resultId) >= 20 ORDER BY AVG(results.grid - results.position) DESC LIMIT 15",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.grid > 0 AND result.position > 0 WITH driver, avg(result.grid - result.position) AS avgImprovement, count(result) AS raceCount WHERE raceCount >= 20 RETURN driver.forename, driver.surname, avgImprovement, raceCount ORDER BY avgImprovement DESC LIMIT 15"
  },
  {
    "question": "Which circuits in countries starting with letter 'A' or 'B' hosted races where constructors scored more than 5 points?",
    "sql": "SELECT circuits.name, circuits.country, constructors.name, SUM(results.points) FROM circuits JOIN races ON circuits.circuitId = races.circuitId JOIN results ON races.raceId = results.raceId JOIN constructors ON results.constructorId = constructors.constructorId WHERE circuits.country LIKE 'A%' OR circuits.country LIKE 'B%' GROUP BY circuits.circuitId, circuits.name, circuits.country, constructors.constructorId, constructors.name HAVING SUM(results.points) > 5 ORDER BY SUM(results.points) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE circuit.country STARTS WITH 'A' OR circuit.country STARTS WITH 'B' WITH circuit, constructor, sum(result.points) AS totalPoints WHERE totalPoints > 5 RETURN circuit.name, circuit.country, constructor.name, totalPoints ORDER BY totalPoints DESC"
  },
  {
    "question": "Find drivers who had at least 3 podiums in their rookie season before 2005",
    "sql": "SELECT drivers.forename, drivers.surname, MIN(races.year), COUNT(results.resultId) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId WHERE results.position <= 3 AND races.year < 2005 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(results.resultId) >= 3 ORDER BY MIN(races.year)",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position <= 3 AND race.year < '2005' WITH driver, min(race.year) AS rookieYear, count(result) AS podiumCount WHERE podiumCount >= 3 RETURN driver.forename, driver.surname, rookieYear, podiumCount ORDER BY rookieYear"
  },
  {
    "question": "Which constructors scored points in consecutive seasons from 2000 to 2005?",
    "sql": "SELECT constructors.name, COUNT(DISTINCT races.year) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE results.points > 0 AND races.year BETWEEN 2000 AND 2005 GROUP BY constructors.constructorId, constructors.name HAVING COUNT(DISTINCT races.year) = 6 ORDER BY constructors.name",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.points > 0 AND race.year >= '2000' AND race.year <= '2005' WITH constructor, count(DISTINCT race.year) AS seasonCount WHERE seasonCount = 6 RETURN constructor.name, seasonCount ORDER BY constructor.name"
  },
  {
    "question": "Find the drivers who scored the most points at circuits with latitude above 40 degrees",
    "sql": "SELECT drivers.forename, drivers.surname, SUM(results.points), COUNT(DISTINCT circuits.circuitId) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE circuits.lat > 40 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING SUM(results.points) > 10 ORDER BY SUM(results.points) DESC LIMIT 10",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE circuit.lat > 40 WITH driver, sum(result.points) AS totalPoints, count(DISTINCT circuit) AS circuitCount WHERE totalPoints > 10 RETURN driver.forename, driver.surname, totalPoints, circuitCount ORDER BY totalPoints DESC LIMIT 10"
  },
  {
    "question": "Which nationalities have had drivers qualify on pole position more than 20 times in total?",
    "sql": "SELECT drivers.nationality, COUNT(qualifying.qualifyId) FROM drivers JOIN qualifying ON drivers.driverId = qualifying.driverId JOIN races ON qualifying.raceId = races.raceId WHERE qualifying.position = 1 GROUP BY drivers.nationality HAVING COUNT(qualifying.qualifyId) > 20 ORDER BY COUNT(qualifying.qualifyId) DESC",
    "cypher": "MATCH (driver:drivers)-[:QUALIFIED_IN]->(qualifying:qualifying)-[:FOR_RACE]->(race:races) WHERE qualifying.position = 1 WITH driver.nationality AS nationality, count(qualifying) AS poleCount WHERE poleCount > 20 RETURN nationality, poleCount ORDER BY poleCount DESC"
  },
  {
    "question": "Find constructors whose drivers completed more than 500 total laps in 2008",
    "sql": "SELECT constructors.name, SUM(results.laps), COUNT(DISTINCT results.driverId) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE races.year = 2008 GROUP BY constructors.constructorId, constructors.name HAVING SUM(results.laps) > 500 ORDER BY SUM(results.laps) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE race.year = '2008' WITH constructor, sum(result.laps) AS totalLaps, count(DISTINCT result.driverId) AS driverCount WHERE totalLaps > 500 RETURN constructor.name, totalLaps, driverCount ORDER BY totalLaps DESC"
  },
  {
    "question": "Which drivers won races for at least 2 different constructors at the same circuit?",
    "sql": "SELECT drivers.forename, drivers.surname, circuits.name, COUNT(DISTINCT constructors.constructorId) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN constructors ON results.constructorId = constructors.constructorId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE results.position = 1 GROUP BY drivers.driverId, drivers.forename, drivers.surname, circuits.circuitId, circuits.name HAVING COUNT(DISTINCT constructors.constructorId) >= 2 ORDER BY COUNT(DISTINCT constructors.constructorId) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits), (constructor:constructors)-[:ACHIEVED]->(result) WHERE result.position = 1 WITH driver, circuit, count(DISTINCT constructor) AS constructorCount WHERE constructorCount >= 2 RETURN driver.forename, driver.surname, circuit.name, constructorCount ORDER BY constructorCount DESC"
  },
  {
    "question": "Find the top 5 seasons by total points scored across all drivers with more than 15 races",
    "sql": "SELECT races.year, SUM(results.points), COUNT(DISTINCT results.raceId) FROM races JOIN results ON races.raceId = results.raceId GROUP BY races.year HAVING COUNT(DISTINCT results.raceId) > 15 ORDER BY SUM(results.points) DESC LIMIT 5",
    "cypher": "MATCH (result:results)-[:IN_RACE]->(race:races) WITH race.year AS season, sum(result.points) AS totalPoints, count(DISTINCT race) AS raceCount WHERE raceCount > 15 RETURN season, totalPoints, raceCount ORDER BY totalPoints DESC LIMIT 5"
  },
  {
    "question": "Which drivers had better average finishing positions at circuits in Europe than at circuits outside Europe?",
    "sql": "SELECT drivers.forename, drivers.surname, AVG(CASE WHEN circuits.country IN ('UK', 'Italy', 'Spain', 'Monaco', 'Belgium', 'Germany', 'France', 'Hungary', 'Austria', 'Portugal') THEN results.position END), AVG(CASE WHEN circuits.country NOT IN ('UK', 'Italy', 'Spain', 'Monaco', 'Belgium', 'Germany', 'France', 'Hungary', 'Austria', 'Portugal') THEN results.position END) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE results.position IS NOT NULL GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING AVG(CASE WHEN circuits.country IN ('UK', 'Italy', 'Spain', 'Monaco', 'Belgium', 'Germany', 'France', 'Hungary', 'Austria', 'Portugal') THEN results.position END) < AVG(CASE WHEN circuits.country NOT IN ('UK', 'Italy', 'Spain', 'Monaco', 'Belgium', 'Germany', 'France', 'Hungary', 'Austria', 'Portugal') THEN results.position END) AND COUNT(results.resultId) > 10 ORDER BY AVG(CASE WHEN circuits.country IN ('UK', 'Italy', 'Spain', 'Monaco', 'Belgium', 'Germany', 'France', 'Hungary', 'Austria', 'Portugal') THEN results.position END) LIMIT 10",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position IS NOT NULL WITH driver, avg(CASE WHEN circuit.country IN ['UK', 'Italy', 'Spain', 'Monaco', 'Belgium', 'Germany', 'France', 'Hungary', 'Austria', 'Portugal'] THEN result.position ELSE NULL END) AS europeAvg, avg(CASE WHEN NOT circuit.country IN ['UK', 'Italy', 'Spain', 'Monaco', 'Belgium', 'Germany', 'France', 'Hungary', 'Austria', 'Portugal'] THEN result.position ELSE NULL END) AS nonEuropeAvg, count(result) AS raceCount WHERE europeAvg < nonEuropeAvg AND raceCount > 10 RETURN driver.forename, driver.surname, europeAvg, nonEuropeAvg ORDER BY europeAvg LIMIT 10"
  },
  {
    "question": "Find constructors that scored more than 30 total points at circuits with altitude between 0 and 200 meters",
    "sql": "SELECT constructors.name, SUM(results.points), COUNT(DISTINCT circuits.circuitId) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE circuits.alt BETWEEN 0 AND 200 GROUP BY constructors.constructorId, constructors.name HAVING SUM(results.points) > 30 ORDER BY SUM(results.points) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE circuit.alt >= 0 AND circuit.alt <= 200 WITH constructor, sum(result.points) AS totalPoints, count(DISTINCT circuit) AS circuitCount WHERE totalPoints > 30 RETURN constructor.name, totalPoints, circuitCount ORDER BY totalPoints DESC"
  },
  {
    "question": "Which drivers finished in the points in races where they started outside the top 10 more than 5 times?",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(results.resultId) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId WHERE results.grid > 10 AND results.points > 0 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(results.resultId) > 5 ORDER BY COUNT(results.resultId) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.grid > 10 AND result.points > 0 WITH driver, count(result) AS comebackCount WHERE comebackCount > 5 RETURN driver.forename, driver.surname, comebackCount ORDER BY comebackCount DESC"
  },
  {
    "question": "Find races where more than 10 drivers from the same constructor participated",
    "sql": "SELECT races.name, races.year, constructors.name, COUNT(DISTINCT results.driverId) FROM races JOIN results ON races.raceId = results.raceId JOIN constructors ON results.constructorId = constructors.constructorId JOIN drivers ON results.driverId = drivers.driverId GROUP BY races.raceId, races.name, races.year, constructors.constructorId, constructors.name HAVING COUNT(DISTINCT results.driverId) >= 2 ORDER BY COUNT(DISTINCT results.driverId) DESC LIMIT 20",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races), (constructor:constructors)-[:ACHIEVED]->(result) WITH race, constructor, count(DISTINCT driver) AS driverCount WHERE driverCount >= 2 RETURN race.name, race.year, constructor.name, driverCount ORDER BY driverCount DESC LIMIT 20"
  },
  {
    "question": "Which constructors never had a driver win from pole position but still won races?",
    "sql": "SELECT constructors.name, COUNT(DISTINCT results.raceId) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE results.position = 1 AND results.grid > 1 GROUP BY constructors.constructorId, constructors.name HAVING COUNT(DISTINCT results.raceId) >= 1 ORDER BY COUNT(DISTINCT results.raceId) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position = 1 AND result.grid > 1 WITH constructor, count(DISTINCT race) AS nonPoleWins WHERE nonPoleWins >= 1 RETURN constructor.name, nonPoleWins ORDER BY nonPoleWins DESC"
  },
  {
    "question": "Find drivers with more than 5 career wins whose average winning grid position was outside top 3",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(results.resultId), AVG(results.grid) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId WHERE results.position = 1 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(results.resultId) > 5 AND AVG(results.grid) > 3 ORDER BY AVG(results.grid) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position = 1 WITH driver, count(result) AS winCount, avg(result.grid) AS avgGrid WHERE winCount > 5 AND avgGrid > 3 RETURN driver.forename, driver.surname, winCount, avgGrid ORDER BY avgGrid DESC"
  },
  {
    "question": "Which seasons had more than 5 different constructors score podium finishes?",
    "sql": "SELECT races.year, COUNT(DISTINCT constructors.constructorId) FROM races JOIN results ON races.raceId = results.raceId JOIN constructors ON results.constructorId = constructors.constructorId WHERE results.position <= 3 GROUP BY races.year HAVING COUNT(DISTINCT constructors.constructorId) > 5 ORDER BY COUNT(DISTINCT constructors.constructorId) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position <= 3 WITH race.year AS season, count(DISTINCT constructor) AS podiumConstructors WHERE podiumConstructors > 5 RETURN season, podiumConstructors ORDER BY podiumConstructors DESC"
  },
  {
    "question": "Find the drivers who improved most positions on average at street circuits like Monaco",
    "sql": "SELECT drivers.forename, drivers.surname, AVG(results.grid - results.position), COUNT(results.resultId) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE circuits.name LIKE '%Monaco%' OR circuits.name LIKE '%Street%' AND results.grid > 0 AND results.position > 0 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(results.resultId) >= 3 ORDER BY AVG(results.grid - results.position) DESC LIMIT 10",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE (circuit.name CONTAINS 'Monaco' OR circuit.name CONTAINS 'Street') AND result.grid > 0 AND result.position > 0 WITH driver, avg(result.grid - result.position) AS avgImprovement, count(result) AS raceCount WHERE raceCount >= 3 RETURN driver.forename, driver.surname, avgImprovement, raceCount ORDER BY avgImprovement DESC LIMIT 10"
  },
  {
    "question": "Which constructors had drivers finish all races in at least one season with more than 10 races?",
    "sql": "SELECT constructors.name, races.year, COUNT(DISTINCT results.raceId) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE results.laps > 0 GROUP BY constructors.constructorId, constructors.name, races.year HAVING COUNT(DISTINCT results.raceId) >= 10 ORDER BY COUNT(DISTINCT results.raceId) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.laps > 0 WITH constructor, race.year AS season, count(DISTINCT race) AS finishedRaces WHERE finishedRaces >= 10 RETURN constructor.name, season, finishedRaces ORDER BY finishedRaces DESC"
  },
  {
    "question": "Find drivers who have both won and retired from the lead at the same circuit",
    "sql": "SELECT DISTINCT drivers.forename, drivers.surname, circuits.name FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE results.position = 1 OR (results.grid = 1 AND results.position > 10) GROUP BY drivers.driverId, drivers.forename, drivers.surname, circuits.circuitId, circuits.name HAVING COUNT(DISTINCT CASE WHEN results.position = 1 THEN races.raceId END) > 0 ORDER BY drivers.surname LIMIT 20",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position = 1 WITH driver, circuit, count(result) AS winCount WHERE winCount > 0 RETURN DISTINCT driver.forename, driver.surname, circuit.name ORDER BY driver.surname LIMIT 20"
  },
  {
    "question": "Which decades had the most competitive racing based on number of different winners?",
    "sql": "SELECT (races.year / 10) * 10, COUNT(DISTINCT results.driverId) FROM races JOIN results ON races.raceId = results.raceId WHERE results.position = 1 GROUP BY (races.year / 10) * 10 HAVING COUNT(DISTINCT results.driverId) > 10 ORDER BY COUNT(DISTINCT results.driverId) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position = 1 WITH substring(race.year, 0, 3) AS decade, count(DISTINCT driver) AS winnerCount WHERE winnerCount > 10 RETURN decade, winnerCount ORDER BY winnerCount DESC"
  },
  {
    "question": "Find constructors whose drivers scored fastest laps in more than 10 races where they also finished on the podium",
    "sql": "SELECT constructors.name, COUNT(results.resultId) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE results.rank = 1 AND results.position <= 3 GROUP BY constructors.constructorId, constructors.name HAVING COUNT(results.resultId) > 10 ORDER BY COUNT(results.resultId) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.rank = 1 AND result.position <= 3 WITH constructor, count(result) AS fastLapPodiums WHERE fastLapPodiums > 10 RETURN constructor.name, fastLapPodiums ORDER BY fastLapPodiums DESC"
  },
  {
    "question": "Which drivers had the highest average points at circuits that have hosted more than 15 races?",
    "sql": "SELECT drivers.forename, drivers.surname, AVG(results.points), COUNT(results.resultId) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE circuits.circuitId IN (SELECT circuits.circuitId FROM circuits JOIN races ON circuits.circuitId = races.circuitId GROUP BY circuits.circuitId HAVING COUNT(races.raceId) > 15) GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(results.resultId) >= 5 ORDER BY AVG(results.points) DESC LIMIT 10",
    "cypher": "MATCH (r:races)-[:HELD_AT]->(c:circuits) WITH c, count(r) AS raceCount WHERE raceCount > 15 WITH collect(c) AS validCircuits MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE circuit IN validCircuits WITH driver, avg(result.points) AS avgPoints, count(result) AS resultCount WHERE resultCount >= 5 RETURN driver.forename, driver.surname, avgPoints, resultCount ORDER BY avgPoints DESC LIMIT 10"
  },
  {
    "question": "Find the constructors with the most 1-2 finishes in races",
    "sql": "SELECT constructors.name, COUNT(DISTINCT races.raceId) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE results.position IN (1, 2) GROUP BY constructors.constructorId, constructors.name, races.raceId HAVING COUNT(results.resultId) = 2",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position IN [1, 2] WITH constructor, race, count(result) AS topTwoCount WHERE topTwoCount = 2 WITH constructor, count(race) AS oneTwoFinishes WHERE oneTwoFinishes > 0 RETURN constructor.name, oneTwoFinishes ORDER BY oneTwoFinishes DESC"
  },
  {
    "question": "Which drivers qualified in the top 5 but finished outside the top 10 more than 3 times?",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(results.resultId) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN qualifying ON drivers.driverId = qualifying.driverId AND results.raceId = qualifying.raceId JOIN races ON results.raceId = races.raceId WHERE qualifying.position <= 5 AND results.position > 10 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(results.resultId) > 3 ORDER BY COUNT(results.resultId) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races), (driver)-[:QUALIFIED_IN]->(qualifying:qualifying)-[:FOR_RACE]->(race) WHERE qualifying.position <= 5 AND result.position > 10 WITH driver, count(result) AS dropCount WHERE dropCount > 3 RETURN driver.forename, driver.surname, dropCount ORDER BY dropCount DESC"
  },
  {
    "question": "Find circuits where more than 3 different nationalities have won races",
    "sql": "SELECT circuits.name, circuits.country, COUNT(DISTINCT drivers.nationality) FROM circuits JOIN races ON circuits.circuitId = races.circuitId JOIN results ON races.raceId = results.raceId JOIN drivers ON results.driverId = drivers.driverId WHERE results.position = 1 GROUP BY circuits.circuitId, circuits.name, circuits.country HAVING COUNT(DISTINCT drivers.nationality) > 3 ORDER BY COUNT(DISTINCT drivers.nationality) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position = 1 WITH circuit, count(DISTINCT driver.nationality) AS nationalityCount WHERE nationalityCount > 3 RETURN circuit.name, circuit.country, nationalityCount ORDER BY nationalityCount DESC"
  },
  {
    "question": "Which constructors had drivers lead the most laps in total during seasons 2005-2009?",
    "sql": "SELECT constructors.name, SUM(results.laps), COUNT(DISTINCT results.raceId) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE races.year BETWEEN 2005 AND 2009 AND results.position <= 3 GROUP BY constructors.constructorId, constructors.name HAVING SUM(results.laps) > 500 ORDER BY SUM(results.laps) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE race.year >= '2005' AND race.year <= '2009' AND result.position <= 3 WITH constructor, sum(result.laps) AS totalLaps, count(DISTINCT race) AS raceCount WHERE totalLaps > 500 RETURN constructor.name, totalLaps, raceCount ORDER BY totalLaps DESC"
  },
  {
    "question": "Find drivers who competed in more than 100 races but never won",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(results.resultId), MAX(results.position) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(results.resultId) > 100 AND MIN(results.position) > 1 ORDER BY COUNT(results.resultId) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WITH driver, count(result) AS raceCount, min(result.position) AS bestFinish WHERE raceCount > 100 AND bestFinish > 1 RETURN driver.forename, driver.surname, raceCount, bestFinish ORDER BY raceCount DESC"
  },
  {
    "question": "Which circuits had the most comebacks from outside top 10 to podium?",
    "sql": "SELECT circuits.name, circuits.country, COUNT(results.resultId) FROM circuits JOIN races ON circuits.circuitId = races.circuitId JOIN results ON races.raceId = results.raceId WHERE results.grid > 10 AND results.position <= 3 GROUP BY circuits.circuitId, circuits.name, circuits.country HAVING COUNT(results.resultId) > 2 ORDER BY COUNT(results.resultId) DESC",
    "cypher": "MATCH (result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.grid > 10 AND result.position <= 3 WITH circuit, count(result) AS comebackCount WHERE comebackCount > 2 RETURN circuit.name, circuit.country, comebackCount ORDER BY comebackCount DESC"
  },
  {
    "question": "Find constructors whose drivers won more races starting from odd-numbered grid positions",
    "sql": "SELECT constructors.name, COUNT(results.resultId) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE results.position = 1 AND results.grid % 2 = 1 GROUP BY constructors.constructorId, constructors.name HAVING COUNT(results.resultId) > 5 ORDER BY COUNT(results.resultId) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position = 1 AND result.grid % 2 = 1 WITH constructor, count(result) AS oddGridWins WHERE oddGridWins > 5 RETURN constructor.name, oddGridWins ORDER BY oddGridWins DESC"
  },
  {
    "question": "Which drivers had more than 10 podium finishes but fewer than 3 wins in their entire career?",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(DISTINCT CASE WHEN results.position <= 3 THEN results.resultId END), COUNT(DISTINCT CASE WHEN results.position = 1 THEN results.resultId END) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(DISTINCT CASE WHEN results.position <= 3 THEN results.resultId END) > 10 AND COUNT(DISTINCT CASE WHEN results.position = 1 THEN results.resultId END) < 3 ORDER BY COUNT(DISTINCT CASE WHEN results.position <= 3 THEN results.resultId END) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WITH driver, sum(CASE WHEN result.position <= 3 THEN 1 ELSE 0 END) AS podiums, sum(CASE WHEN result.position = 1 THEN 1 ELSE 0 END) AS wins WHERE podiums > 10 AND wins < 3 RETURN driver.forename, driver.surname, podiums, wins ORDER BY podiums DESC"
  },
  {
    "question": "Find the seasons where British drivers won more than 5 races combined",
    "sql": "SELECT races.year, COUNT(results.resultId) FROM races JOIN results ON races.raceId = results.raceId JOIN drivers ON results.driverId = drivers.driverId WHERE drivers.nationality = 'British' AND results.position = 1 GROUP BY races.year HAVING COUNT(results.resultId) > 5 ORDER BY COUNT(results.resultId) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE driver.nationality = 'British' AND result.position = 1 WITH race.year AS season, count(result) AS britishWins WHERE britishWins > 5 RETURN season, britishWins ORDER BY britishWins DESC"
  },
  {
    "question": "Which constructors scored points in every race of at least one season?",
    "sql": "SELECT constructors.name, races.year, COUNT(DISTINCT races.raceId) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE results.points > 0 GROUP BY constructors.constructorId, constructors.name, races.year HAVING COUNT(DISTINCT races.raceId) >= 15 ORDER BY COUNT(DISTINCT races.raceId) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.points > 0 WITH constructor, race.year AS season, count(DISTINCT race) AS pointsRaces WHERE pointsRaces >= 15 RETURN constructor.name, season, pointsRaces ORDER BY pointsRaces DESC"
  },
  {
    "question": "Find drivers whose average grid position improved by more than 2 places between their first and second halves of seasons",
    "sql": "SELECT drivers.forename, drivers.surname, AVG(CASE WHEN races.round <= 8 THEN results.grid END), AVG(CASE WHEN races.round > 8 THEN results.grid END) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId WHERE results.grid > 0 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING AVG(CASE WHEN races.round <= 8 THEN results.grid END) - AVG(CASE WHEN races.round > 8 THEN results.grid END) > 2 AND COUNT(results.resultId) > 20 ORDER BY AVG(CASE WHEN races.round <= 8 THEN results.grid END) - AVG(CASE WHEN races.round > 8 THEN results.grid END) DESC LIMIT 15",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.grid > 0 WITH driver, avg(CASE WHEN toInteger(race.round) <= 8 THEN result.grid ELSE null END) AS earlyAvg, avg(CASE WHEN toInteger(race.round) > 8 THEN result.grid ELSE null END) AS lateAvg, count(result) AS raceCount WHERE earlyAvg - lateAvg > 2 AND raceCount > 20 RETURN driver.forename, driver.surname, earlyAvg, lateAvg ORDER BY (earlyAvg - lateAvg) DESC LIMIT 15"
  },
  {
    "question": "Which circuits have had the most dramatic finishes with less than 5 seconds between winner and second place?",
    "sql": "SELECT circuits.name, circuits.country, COUNT(DISTINCT races.raceId) FROM circuits JOIN races ON circuits.circuitId = races.circuitId JOIN results ON races.raceId = results.raceId WHERE results.position <= 2 AND results.milliseconds IS NOT NULL GROUP BY circuits.circuitId, circuits.name, circuits.country HAVING COUNT(DISTINCT races.raceId) > 10 ORDER BY COUNT(DISTINCT races.raceId) DESC",
    "cypher": "MATCH (result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position <= 2 AND result.milliseconds IS NOT NULL WITH circuit, count(DISTINCT race) AS closeRaces WHERE closeRaces > 10 RETURN circuit.name, circuit.country, closeRaces ORDER BY closeRaces DESC"
  },
  {
    "question": "Find constructors that had drivers from the same nationality as the constructor win races",
    "sql": "SELECT constructors.name, constructors.nationality, COUNT(results.resultId) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN drivers ON results.driverId = drivers.driverId JOIN races ON results.raceId = races.raceId WHERE results.position = 1 AND constructors.nationality = drivers.nationality GROUP BY constructors.constructorId, constructors.name, constructors.nationality HAVING COUNT(results.resultId) > 3 ORDER BY COUNT(results.resultId) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)<-[:ACHIEVED]-(driver:drivers) WHERE result.position = 1 AND constructor.nationality = driver.nationality WITH constructor, count(result) AS homeWins WHERE homeWins > 3 RETURN constructor.name, constructor.nationality, homeWins ORDER BY homeWins DESC"
  },
  {
    "question": "Which drivers scored points at circuits in both the Northern and Southern hemispheres?",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(DISTINCT CASE WHEN circuits.lat > 0 THEN circuits.circuitId END), COUNT(DISTINCT CASE WHEN circuits.lat < 0 THEN circuits.circuitId END) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE results.points > 0 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(DISTINCT CASE WHEN circuits.lat > 0 THEN circuits.circuitId END) > 0 AND COUNT(DISTINCT CASE WHEN circuits.lat < 0 THEN circuits.circuitId END) > 0 ORDER BY COUNT(DISTINCT circuits.circuitId) DESC LIMIT 20",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.points > 0 WITH driver, sum(CASE WHEN circuit.lat > 0 THEN 1 ELSE 0 END) AS northCircuits, sum(CASE WHEN circuit.lat < 0 THEN 1 ELSE 0 END) AS southCircuits, count(DISTINCT circuit) AS totalCircuits WHERE northCircuits > 0 AND southCircuits > 0 RETURN driver.forename, driver.surname, northCircuits, southCircuits, totalCircuits ORDER BY totalCircuits DESC LIMIT 20"
  },
  {
    "question": "Find the constructors with the best average finishing position at high-speed circuits with long straights",
    "sql": "SELECT constructors.name, AVG(results.position), COUNT(results.resultId) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE circuits.name IN ('Autodromo Nazionale di Monza', 'Hockenheimring', 'Spa-Francorchamps') AND results.position IS NOT NULL GROUP BY constructors.constructorId, constructors.name HAVING COUNT(results.resultId) > 10 ORDER BY AVG(results.position) LIMIT 10",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE circuit.name IN ['Autodromo Nazionale di Monza', 'Hockenheimring', 'Spa-Francorchamps'] AND result.position IS NOT NULL WITH constructor, avg(result.position) AS avgPosition, count(result) AS resultCount WHERE resultCount > 10 RETURN constructor.name, avgPosition, resultCount ORDER BY avgPosition LIMIT 10"
  },
  {
    "question": "Which drivers have never finished a race at Monaco despite multiple attempts?",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(results.resultId), MAX(results.position) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId WHERE races.name LIKE '%Monaco%' AND (results.laps < 50 OR results.position IS NULL) GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(results.resultId) >= 2 ORDER BY COUNT(results.resultId) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE race.name CONTAINS 'Monaco' AND (result.laps < 50 OR result.position IS NULL) WITH driver, count(result) AS monacoAttempts WHERE monacoAttempts >= 2 RETURN driver.forename, driver.surname, monacoAttempts ORDER BY monacoAttempts DESC"
  },
  {
    "question": "Find the seasons with the closest constructor championship battles based on points",
    "sql": "SELECT races.year, constructors.name, MAX(constructor_standings.points) FROM constructor_standings JOIN constructors ON constructor_standings.constructorId = constructors.constructorId JOIN races ON constructor_standings.raceId = races.raceId GROUP BY races.year, constructors.constructorId, constructors.name HAVING MAX(constructor_standings.points) > 50 ORDER BY races.year DESC, MAX(constructor_standings.points) DESC LIMIT 20",
    "cypher": "MATCH (race:races)-[:HAS_STANDING]->(cs:constructor_standings)<-[:HAS_STANDING]-(constructor:constructors) WITH race.year AS season, constructor, max(cs.points) AS maxPoints WHERE maxPoints > 50 RETURN season, constructor.name, maxPoints ORDER BY season DESC, maxPoints DESC LIMIT 20"
  },
  {
    "question": "Which drivers qualified outside top 10 but finished in points more than 5 times at European circuits?",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(results.resultId) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN qualifying ON drivers.driverId = qualifying.driverId AND results.raceId = qualifying.raceId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE qualifying.position > 10 AND results.points > 0 AND circuits.country IN ('UK', 'Italy', 'Spain', 'Monaco', 'Belgium', 'Germany', 'France', 'Hungary') GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(results.resultId) > 5 ORDER BY COUNT(results.resultId) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits), (driver)-[:QUALIFIED_IN]->(qualifying:qualifying)-[:FOR_RACE]->(race) WHERE qualifying.position > 10 AND result.points > 0 AND circuit.country IN ['UK', 'Italy', 'Spain', 'Monaco', 'Belgium', 'Germany', 'France', 'Hungary'] WITH driver, count(result) AS comebackCount WHERE comebackCount > 5 RETURN driver.forename, driver.surname, comebackCount ORDER BY comebackCount DESC"
  },
  {
    "question": "Find constructors that scored more points in the second half of seasons than the first half",
    "sql": "SELECT constructors.name, SUM(CASE WHEN races.round > 8 THEN results.points ELSE 0 END), SUM(CASE WHEN races.round <= 8 THEN results.points ELSE 0 END) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId GROUP BY constructors.constructorId, constructors.name HAVING SUM(CASE WHEN races.round > 8 THEN results.points ELSE 0 END) > SUM(CASE WHEN races.round <= 8 THEN results.points ELSE 0 END) AND SUM(results.points) > 20 ORDER BY SUM(results.points) DESC LIMIT 15",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WITH constructor, sum(CASE WHEN toInteger(race.round) > 8 THEN result.points ELSE 0 END) AS latePoints, sum(CASE WHEN toInteger(race.round) <= 8 THEN result.points ELSE 0 END) AS earlyPoints, sum(result.points) AS totalPoints WHERE latePoints > earlyPoints AND totalPoints > 20 RETURN constructor.name, latePoints, earlyPoints, totalPoints ORDER BY totalPoints DESC LIMIT 15"
  },
  {
    "question": "Which drivers had the most consecutive podium finishes at a single circuit?",
    "sql": "SELECT drivers.forename, drivers.surname, circuits.name, COUNT(results.resultId) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE results.position <= 3 GROUP BY drivers.driverId, drivers.forename, drivers.surname, circuits.circuitId, circuits.name HAVING COUNT(results.resultId) >= 3 ORDER BY COUNT(results.resultId) DESC LIMIT 15",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position <= 3 WITH driver, circuit, count(result) AS podiumCount WHERE podiumCount >= 3 RETURN driver.forename, driver.surname, circuit.name, podiumCount ORDER BY podiumCount DESC LIMIT 15"
  },
  {
    "question": "Find the drivers with the highest percentage of points-scoring finishes among those with at least 50 races",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(CASE WHEN results.points > 0 THEN 1 END), COUNT(results.resultId) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(results.resultId) >= 50 ORDER BY COUNT(CASE WHEN results.points > 0 THEN 1 END) * 1.0 / COUNT(results.resultId) DESC LIMIT 10",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WITH driver, count(result) AS totalRaces, sum(CASE WHEN result.points > 0 THEN 1 ELSE 0 END) AS pointsFinishes WHERE totalRaces >= 50 RETURN driver.forename, driver.surname, pointsFinishes, totalRaces ORDER BY toFloat(pointsFinishes) / totalRaces DESC LIMIT 10"
  },
  {
    "question": "Which constructors had the best reliability record with more than 80% finish rate over 30 races?",
    "sql": "SELECT constructors.name, COUNT(CASE WHEN results.laps > 40 THEN 1 END), COUNT(results.resultId) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId GROUP BY constructors.constructorId, constructors.name HAVING COUNT(results.resultId) >= 30 AND COUNT(CASE WHEN results.laps > 40 THEN 1 END) * 1.0 / COUNT(results.resultId) > 0.8 ORDER BY COUNT(CASE WHEN results.laps > 40 THEN 1 END) * 1.0 / COUNT(results.resultId) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WITH constructor, count(result) AS totalRaces, sum(CASE WHEN result.laps > 40 THEN 1 ELSE 0 END) AS finishedRaces WHERE totalRaces >= 30 AND toFloat(finishedRaces) / totalRaces > 0.8 RETURN constructor.name, finishedRaces, totalRaces ORDER BY toFloat(finishedRaces) / totalRaces DESC"
  },
  {
    "question": "Find drivers who have scored points in races across at least 4 different continents",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(DISTINCT CASE WHEN circuits.country IN ('UK', 'Italy', 'Spain', 'Monaco', 'Belgium', 'Germany', 'France') THEN 'Europe' WHEN circuits.country IN ('USA', 'Canada', 'Mexico') THEN 'Americas' WHEN circuits.country IN ('Japan', 'Malaysia', 'China', 'Bahrain') THEN 'Asia' WHEN circuits.country IN ('Australia') THEN 'Oceania' END) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE results.points > 0 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(DISTINCT CASE WHEN circuits.country IN ('UK', 'Italy', 'Spain', 'Monaco', 'Belgium', 'Germany', 'France') THEN 'Europe' WHEN circuits.country IN ('USA', 'Canada', 'Mexico') THEN 'Americas' WHEN circuits.country IN ('Japan', 'Malaysia', 'China', 'Bahrain') THEN 'Asia' WHEN circuits.country IN ('Australia') THEN 'Oceania' END) >= 4 ORDER BY COUNT(DISTINCT circuits.country) DESC LIMIT 15",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.points > 0 WITH driver, count(DISTINCT circuit.country) AS countryCount WHERE countryCount >= 8 RETURN driver.forename, driver.surname, countryCount ORDER BY countryCount DESC LIMIT 15"
  },
  {
    "question": "Which constructors had the most dramatic turnarounds from qualifying to race day with grid improvements?",
    "sql": "SELECT constructors.name, AVG(results.grid - results.position), COUNT(results.resultId) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE results.grid > 0 AND results.position > 0 GROUP BY constructors.constructorId, constructors.name HAVING COUNT(results.resultId) > 50 AND AVG(results.grid - results.position) > 1 ORDER BY AVG(results.grid - results.position) DESC LIMIT 10",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.grid > 0 AND result.position > 0 WITH constructor, avg(result.grid - result.position) AS avgImprovement, count(result) AS resultCount WHERE resultCount > 50 AND avgImprovement > 1 RETURN constructor.name, avgImprovement, resultCount ORDER BY avgImprovement DESC LIMIT 10"
  },
  {
    "question": "Find drivers with at least one win in each of the decades 1970s and 1980s",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(DISTINCT CASE WHEN races.year >= 1970 AND races.year < 1980 THEN races.raceId END), COUNT(DISTINCT CASE WHEN races.year >= 1980 AND races.year < 1990 THEN races.raceId END) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId WHERE results.position = 1 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(DISTINCT CASE WHEN races.year >= 1970 AND races.year < 1980 THEN races.raceId END) > 0 AND COUNT(DISTINCT CASE WHEN races.year >= 1980 AND races.year < 1990 THEN races.raceId END) > 0",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position = 1 WITH driver, sum(CASE WHEN race.year >= '1970' AND race.year < '1980' THEN 1 ELSE 0 END) AS wins70s, sum(CASE WHEN race.year >= '1980' AND race.year < '1990' THEN 1 ELSE 0 END) AS wins80s WHERE wins70s > 0 AND wins80s > 0 RETURN driver.forename, driver.surname, wins70s, wins80s"
  },
  {
    "question": "Which circuits had the highest variance in race winners with at least 5 different winners?",
    "sql": "SELECT circuits.name, circuits.country, COUNT(DISTINCT results.driverId), COUNT(races.raceId) FROM circuits JOIN races ON circuits.circuitId = races.circuitId JOIN results ON races.raceId = results.raceId WHERE results.position = 1 GROUP BY circuits.circuitId, circuits.name, circuits.country HAVING COUNT(DISTINCT results.driverId) >= 5 ORDER BY COUNT(DISTINCT results.driverId) * 1.0 / COUNT(races.raceId) DESC LIMIT 10",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position = 1 WITH circuit, count(DISTINCT driver) AS winnerCount, count(race) AS raceCount WHERE winnerCount >= 5 RETURN circuit.name, circuit.country, winnerCount, raceCount ORDER BY toFloat(winnerCount) / raceCount DESC LIMIT 10"
  },
  {
    "question": "Find constructors whose drivers improved their qualifying position to race finish more than 2 places on average over 30 races",
    "sql": "SELECT constructors.name, AVG(qualifying.position - results.position), COUNT(results.resultId) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN qualifying ON results.driverId = qualifying.driverId AND results.raceId = qualifying.raceId JOIN races ON results.raceId = races.raceId WHERE qualifying.position > 0 AND results.position > 0 GROUP BY constructors.constructorId, constructors.name HAVING COUNT(results.resultId) >= 30 AND AVG(qualifying.position - results.position) > 2 ORDER BY AVG(qualifying.position - results.position) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races), (driver:drivers)-[:ACHIEVED]->(result), (driver)-[:QUALIFIED_IN]->(qualifying:qualifying)-[:FOR_RACE]->(race) WHERE qualifying.position > 0 AND result.position > 0 WITH constructor, avg(qualifying.position - result.position) AS avgImprovement, count(result) AS resultCount WHERE resultCount >= 30 AND avgImprovement > 2 RETURN constructor.name, avgImprovement, resultCount ORDER BY avgImprovement DESC"
  },
  {
    "question": "Which drivers won at circuits where they previously failed to score points more than twice?",
    "sql": "SELECT drivers.forename, drivers.surname, circuits.name, COUNT(DISTINCT CASE WHEN results.position = 1 THEN races.raceId END), COUNT(DISTINCT CASE WHEN results.points = 0 THEN races.raceId END) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId GROUP BY drivers.driverId, drivers.forename, drivers.surname, circuits.circuitId, circuits.name HAVING COUNT(DISTINCT CASE WHEN results.position = 1 THEN races.raceId END) > 0 AND COUNT(DISTINCT CASE WHEN results.points = 0 THEN races.raceId END) > 2 ORDER BY COUNT(DISTINCT CASE WHEN results.position = 1 THEN races.raceId END) DESC LIMIT 15",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WITH driver, circuit, sum(CASE WHEN result.position = 1 THEN 1 ELSE 0 END) AS wins, sum(CASE WHEN result.points = 0 THEN 1 ELSE 0 END) AS noPointsRaces WHERE wins > 0 AND noPointsRaces > 2 RETURN driver.forename, driver.surname, circuit.name, wins, noPointsRaces ORDER BY wins DESC LIMIT 15"
  },
  {
    "question": "Find the seasons with the most competitive qualifying sessions based on small gaps between positions",
    "sql": "SELECT races.year, COUNT(DISTINCT qualifying.raceId), AVG(qualifying.position) FROM races JOIN qualifying ON races.raceId = qualifying.raceId JOIN drivers ON qualifying.driverId = drivers.driverId WHERE qualifying.position <= 10 GROUP BY races.year HAVING COUNT(DISTINCT qualifying.raceId) > 10 ORDER BY AVG(qualifying.position) LIMIT 10",
    "cypher": "MATCH (driver:drivers)-[:QUALIFIED_IN]->(qualifying:qualifying)-[:FOR_RACE]->(race:races) WHERE qualifying.position <= 10 WITH race.year AS season, count(DISTINCT race) AS raceCount, avg(qualifying.position) AS avgPosition WHERE raceCount > 10 RETURN season, raceCount, avgPosition ORDER BY avgPosition LIMIT 10"
  },
  {
    "question": "Which constructors had drivers who consistently improved throughout a season with better second-half performance?",
    "sql": "SELECT constructors.name, races.year, AVG(CASE WHEN races.round <= 8 THEN results.position END), AVG(CASE WHEN races.round > 8 THEN results.position END) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE results.position IS NOT NULL GROUP BY constructors.constructorId, constructors.name, races.year HAVING AVG(CASE WHEN races.round <= 8 THEN results.position END) > AVG(CASE WHEN races.round > 8 THEN results.position END) AND COUNT(results.resultId) > 10 ORDER BY AVG(CASE WHEN races.round <= 8 THEN results.position END) - AVG(CASE WHEN races.round > 8 THEN results.position END) DESC LIMIT 15",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position IS NOT NULL WITH constructor, race.year AS season, avg(CASE WHEN toInteger(race.round) <= 8 THEN result.position ELSE null END) AS earlyAvg, avg(CASE WHEN toInteger(race.round) > 8 THEN result.position ELSE null END) AS lateAvg, count(result) AS resultCount WHERE earlyAvg > lateAvg AND resultCount > 10 RETURN constructor.name, season, earlyAvg, lateAvg ORDER BY (earlyAvg - lateAvg) DESC LIMIT 15"
  },
  {
    "question": "Find drivers who dominated specific circuits with more than 3 wins and 5 podiums at the same venue",
    "sql": "SELECT drivers.forename, drivers.surname, circuits.name, COUNT(DISTINCT CASE WHEN results.position = 1 THEN results.resultId END), COUNT(DISTINCT CASE WHEN results.position <= 3 THEN results.resultId END) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId GROUP BY drivers.driverId, drivers.forename, drivers.surname, circuits.circuitId, circuits.name HAVING COUNT(DISTINCT CASE WHEN results.position = 1 THEN results.resultId END) > 3 AND COUNT(DISTINCT CASE WHEN results.position <= 3 THEN results.resultId END) >= 5 ORDER BY COUNT(DISTINCT CASE WHEN results.position = 1 THEN results.resultId END) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WITH driver, circuit, sum(CASE WHEN result.position = 1 THEN 1 ELSE 0 END) AS wins, sum(CASE WHEN result.position <= 3 THEN 1 ELSE 0 END) AS podiums WHERE wins > 3 AND podiums >= 5 RETURN driver.forename, driver.surname, circuit.name, wins, podiums ORDER BY wins DESC"
  },
  {
    "question": "Which nationalities produced drivers who collectively scored the most points per decade?",
    "sql": "SELECT drivers.nationality, (races.year / 10) * 10, SUM(results.points), COUNT(DISTINCT drivers.driverId) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId GROUP BY drivers.nationality, (races.year / 10) * 10 HAVING SUM(results.points) > 50 AND COUNT(DISTINCT drivers.driverId) >= 2 ORDER BY SUM(results.points) DESC LIMIT 20",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WITH driver.nationality AS nationality, substring(race.year, 0, 3) AS decade, sum(result.points) AS totalPoints, count(DISTINCT driver) AS driverCount WHERE totalPoints > 50 AND driverCount >= 2 RETURN nationality, decade, totalPoints, driverCount ORDER BY totalPoints DESC LIMIT 20"
  },
  {
    "question": "Find constructors that won races in more than 10 different countries",
    "sql": "SELECT constructors.name, COUNT(DISTINCT circuits.country) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE results.position = 1 GROUP BY constructors.constructorId, constructors.name HAVING COUNT(DISTINCT circuits.country) > 10 ORDER BY COUNT(DISTINCT circuits.country) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position = 1 WITH constructor, count(DISTINCT circuit.country) AS countryCount WHERE countryCount > 10 RETURN constructor.name, countryCount ORDER BY countryCount DESC"
  },
  {
    "question": "Which drivers scored fastest laps at circuits where they also won with at least 2 occurrences?",
    "sql": "SELECT drivers.forename, drivers.surname, circuits.name, COUNT(results.resultId) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE results.position = 1 AND results.rank = 1 GROUP BY drivers.driverId, drivers.forename, drivers.surname, circuits.circuitId, circuits.name HAVING COUNT(results.resultId) >= 2 ORDER BY COUNT(results.resultId) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position = 1 AND result.rank = 1 WITH driver, circuit, count(result) AS grandSlamCount WHERE grandSlamCount >= 2 RETURN driver.forename, driver.surname, circuit.name, grandSlamCount ORDER BY grandSlamCount DESC"
  },
  {
    "question": "Find the constructors with the best points-per-race ratio at Monaco with at least 10 races",
    "sql": "SELECT constructors.name, SUM(results.points), COUNT(results.resultId), SUM(results.points) * 1.0 / COUNT(results.resultId) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE races.name LIKE '%Monaco%' GROUP BY constructors.constructorId, constructors.name HAVING COUNT(results.resultId) >= 10 ORDER BY SUM(results.points) * 1.0 / COUNT(results.resultId) DESC LIMIT 10",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE race.name CONTAINS 'Monaco' WITH constructor, sum(result.points) AS totalPoints, count(result) AS raceCount WHERE raceCount >= 10 RETURN constructor.name, totalPoints, raceCount, toFloat(totalPoints) / raceCount ORDER BY toFloat(totalPoints) / raceCount DESC LIMIT 10"
  },
  {
    "question": "Which constructors have scored more than 100 podiums since 2004?",
    "sql": "SELECT constructors.name, COUNT(*), SUM(results.points) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE results.position <= 3 AND races.year >= 2004 GROUP BY constructors.constructorId, constructors.name HAVING COUNT(*) > 100 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position <= 3 AND toInteger(race.year) >= 2004 WITH constructor, count(*) AS podiums, sum(result.points) AS totalPoints WHERE podiums > 100 RETURN constructor.name, podiums, totalPoints ORDER BY podiums DESC"
  },
  {
    "question": "Find drivers who have won at Monaco more than 3 times",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(*) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE results.position = 1 AND circuits.name LIKE '%Monaco%' GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(*) > 3 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position = 1 AND circuit.name CONTAINS 'Monaco' WITH driver, count(*) AS wins WHERE wins > 3 RETURN driver.forename, driver.surname, wins ORDER BY wins DESC"
  },
  {
    "question": "Which races had the most classified finishers with more than 18 drivers completing the race?",
    "sql": "SELECT races.name, races.year, circuits.name, COUNT(*) FROM races JOIN circuits ON races.circuitId = circuits.circuitId JOIN results ON races.raceId = results.raceId WHERE results.position > 0 GROUP BY races.raceId, races.name, races.year, circuits.name HAVING COUNT(*) > 18 ORDER BY COUNT(*) DESC LIMIT 20",
    "cypher": "MATCH (result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position > 0 WITH race, circuit, count(*) AS finishers WHERE finishers > 18 RETURN race.name, race.year, circuit.name, finishers ORDER BY finishers DESC LIMIT 20"
  },
  {
    "question": "Find constructors that have achieved more than 200 podiums with drivers from at least 4 different nationalities",
    "sql": "SELECT constructors.name, COUNT(*), COUNT(DISTINCT drivers.nationality) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN drivers ON results.driverId = drivers.driverId JOIN races ON results.raceId = races.raceId WHERE results.position <= 3 GROUP BY constructors.constructorId, constructors.name HAVING COUNT(*) > 200 AND COUNT(DISTINCT drivers.nationality) >= 4 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)<-[:ACHIEVED]-(constructor:constructors) WHERE result.position <= 3 WITH constructor, count(*) AS podiums, count(DISTINCT driver.nationality) AS nationalities WHERE podiums > 200 AND nationalities >= 4 RETURN constructor.name, podiums, nationalities ORDER BY podiums DESC"
  }
]