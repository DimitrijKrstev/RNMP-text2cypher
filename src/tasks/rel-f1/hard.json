[
  {
    "question": "Which drivers have won more than 5 races at circuits located in Europe?",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(*) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE results.position = 1 AND circuits.country IN ('UK', 'Italy', 'Spain', 'Monaco', 'Belgium', 'Germany', 'Hungary', 'Austria', 'France', 'Netherlands') GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(*) > 5 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position = 1 AND circuit.country IN ['UK', 'Italy', 'Spain', 'Monaco', 'Belgium', 'Germany', 'Hungary', 'Austria', 'France', 'Netherlands'] WITH driver, count(*) AS wins WHERE wins > 5 RETURN driver.forename, driver.surname, wins ORDER BY wins DESC"
  },
  {
    "question": "Which constructors have scored more than 200 points in a season with at least 10 podium finishes?",
    "sql": "SELECT constructors.name, races.year, SUM(results.points), COUNT(*) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE results.position <= 3 GROUP BY constructors.constructorId, constructors.name, races.year HAVING SUM(results.points) > 200 AND COUNT(*) >= 10 ORDER BY SUM(results.points) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position <= 3 WITH constructor, race.year AS year, sum(result.points) AS totalPoints, count(*) AS podiums WHERE totalPoints > 200 AND podiums >= 10 RETURN constructor.name, year, totalPoints, podiums ORDER BY totalPoints DESC"
  },
  {
    "question": "Which British drivers have achieved more than 10 pole positions at circuits with altitude above 500 meters?",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(*) FROM drivers JOIN qualifying ON drivers.driverId = qualifying.driverId JOIN races ON qualifying.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE drivers.nationality = 'British' AND qualifying.position = 1 AND circuits.alt > 500 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(*) > 10 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (driver:drivers)-[:QUALIFIED_IN]->(q:qualifying)-[:FOR_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE driver.nationality = 'British' AND q.position = 1 AND circuit.alt > 500 WITH driver, count(*) AS poles WHERE poles > 10 RETURN driver.forename, driver.surname, poles ORDER BY poles DESC"
  },
  {
    "question": "Find drivers who have scored points in more than 50 races for constructors from at least 2 different nationalities",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(DISTINCT results.raceId), COUNT(DISTINCT constructors.nationality) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN constructors ON results.constructorId = constructors.constructorId WHERE results.points > 0 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(DISTINCT results.raceId) > 50 AND COUNT(DISTINCT constructors.nationality) >= 2 ORDER BY COUNT(DISTINCT results.raceId) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)<-[:ACHIEVED]-(constructor:constructors) WHERE result.points > 0 WITH driver, count(DISTINCT result.raceId) AS races, count(DISTINCT constructor.nationality) AS nationalities WHERE races > 50 AND nationalities >= 2 RETURN driver.forename, driver.surname, races, nationalities ORDER BY races DESC"
  },
  {
    "question": "Which circuits have hosted races where the average points scored by winners exceeds 20?",
    "sql": "SELECT circuits.name, circuits.country, AVG(results.points), COUNT(*) FROM circuits JOIN races ON circuits.circuitId = races.circuitId JOIN results ON races.raceId = results.raceId WHERE results.position = 1 GROUP BY circuits.circuitId, circuits.name, circuits.country HAVING AVG(results.points) > 20 AND COUNT(*) >= 5 ORDER BY AVG(results.points) DESC",
    "cypher": "MATCH (result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position = 1 WITH circuit, avg(result.points) AS avgPoints, count(*) AS raceCount WHERE avgPoints > 20 AND raceCount >= 5 RETURN circuit.name, circuit.country, avgPoints, raceCount ORDER BY avgPoints DESC"
  },
  {
    "question": "Find German constructors that have achieved more than 20 wins with at least 3 different drivers",
    "sql": "SELECT constructors.name, COUNT(*), COUNT(DISTINCT results.driverId) FROM constructors JOIN results ON constructors.constructorId = results.constructorId WHERE constructors.nationality = 'German' AND results.position = 1 GROUP BY constructors.constructorId, constructors.name HAVING COUNT(*) > 20 AND COUNT(DISTINCT results.driverId) >= 3 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results) WHERE constructor.nationality = 'German' AND result.position = 1 WITH constructor, count(*) AS wins, count(DISTINCT result.driverId) AS drivers WHERE wins > 20 AND drivers >= 3 RETURN constructor.name, wins, drivers ORDER BY wins DESC"
  },
  {
    "question": "Which drivers have won races in more than 5 different countries with a total of at least 15 wins?",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(*), COUNT(DISTINCT circuits.country) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE results.position = 1 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(*) >= 15 AND COUNT(DISTINCT circuits.country) > 5 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position = 1 WITH driver, count(*) AS wins, count(DISTINCT circuit.country) AS countries WHERE wins >= 15 AND countries > 5 RETURN driver.forename, driver.surname, wins, countries ORDER BY wins DESC"
  },
  {
    "question": "Find races where more than 5 drivers from British constructors finished in the points",
    "sql": "SELECT races.name, races.year, COUNT(*) FROM races JOIN results ON races.raceId = results.raceId JOIN constructors ON results.constructorId = constructors.constructorId WHERE constructors.nationality = 'British' AND results.points > 0 GROUP BY races.raceId, races.name, races.year HAVING COUNT(*) > 5 ORDER BY races.year DESC, COUNT(*) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE constructor.nationality = 'British' AND result.points > 0 WITH race, count(*) AS pointFinishers WHERE pointFinishers > 5 RETURN race.name, race.year, pointFinishers ORDER BY race.year DESC, pointFinishers DESC"
  },
  {
    "question": "Which drivers have an average finishing position better than 5 with at least 50 race starts?",
    "sql": "SELECT drivers.forename, drivers.surname, AVG(results.position), COUNT(*) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId WHERE results.position > 0 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING AVG(results.position) < 5 AND COUNT(*) >= 50 ORDER BY AVG(results.position)",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position > 0 WITH driver, avg(result.position) AS avgPos, count(*) AS starts WHERE avgPos < 5 AND starts >= 50 RETURN driver.forename, driver.surname, avgPos, starts ORDER BY avgPos"
  },
  {
    "question": "Find constructors that have scored more than 500 total points at circuits in Italy or Monaco",
    "sql": "SELECT constructors.name, SUM(results.points), COUNT(DISTINCT races.raceId) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE circuits.country IN ('Italy', 'Monaco') GROUP BY constructors.constructorId, constructors.name HAVING SUM(results.points) > 500 ORDER BY SUM(results.points) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE circuit.country IN ['Italy', 'Monaco'] WITH constructor, sum(result.points) AS totalPoints, count(DISTINCT race.raceId) AS races WHERE totalPoints > 500 RETURN constructor.name, totalPoints, races ORDER BY totalPoints DESC"
  },
  {
    "question": "Which drivers born after 1985 have more than 30 podium finishes at European circuits?",
    "sql": "SELECT drivers.forename, drivers.surname, drivers.dob, COUNT(*) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE drivers.dob > '1985-01-01 00:00:00' AND results.position <= 3 AND circuits.country IN ('UK', 'Italy', 'Spain', 'Monaco', 'Belgium', 'Germany', 'Hungary', 'Austria') GROUP BY drivers.driverId, drivers.forename, drivers.surname, drivers.dob HAVING COUNT(*) > 30 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE driver.dob > date('1985-01-01') AND result.position <= 3 AND circuit.country IN ['UK', 'Italy', 'Spain', 'Monaco', 'Belgium', 'Germany', 'Hungary', 'Austria'] WITH driver, count(*) AS podiums WHERE podiums > 30 RETURN driver.forename, driver.surname, driver.dob, podiums ORDER BY podiums DESC"
  },
  {
    "question": "Find races where the gap between first and second place was decided by more than 10 grid positions improvement",
    "sql": "SELECT races.name, races.year, COUNT(DISTINCT results.driverId) FROM races JOIN results ON races.raceId = results.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE results.position <= 2 AND (results.grid - results.position) > 10 GROUP BY races.raceId, races.name, races.year HAVING COUNT(DISTINCT results.driverId) >= 1 ORDER BY races.year DESC",
    "cypher": "MATCH (result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position <= 2 AND (result.grid - result.position) > 10 WITH race, count(DISTINCT result.driverId) AS improvers WHERE improvers >= 1 RETURN race.name, race.year, improvers ORDER BY race.year DESC"
  },
  {
    "question": "Which Italian constructors have achieved more than 100 points in seasons between 2015 and 2020?",
    "sql": "SELECT constructors.name, races.year, SUM(constructor_results.points) FROM constructors JOIN constructor_results ON constructors.constructorId = constructor_results.constructorId JOIN races ON constructor_results.raceId = races.raceId WHERE constructors.nationality = 'Italian' AND races.year BETWEEN 2015 AND 2020 GROUP BY constructors.constructorId, constructors.name, races.year HAVING SUM(constructor_results.points) > 100 ORDER BY races.year, SUM(constructor_results.points) DESC",
    "cypher": "MATCH (constructor:constructors)-[:RESULTED_IN]->(cr:constructor_results), (race:races)-[:RESULTED_IN]->(cr) WHERE constructor.nationality = 'Italian' AND toInteger(race.year) >= 2015 AND toInteger(race.year) <= 2020 WITH constructor, race.year AS year, sum(cr.points) AS totalPoints WHERE totalPoints > 100 RETURN constructor.name, year, totalPoints ORDER BY year, totalPoints DESC"
  },
  {
    "question": "Find drivers who have qualified in pole position more than 10 times but converted less than 50% to wins",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(DISTINCT qualifying.raceId), COUNT(DISTINCT CASE WHEN results.position = 1 THEN results.raceId END) FROM drivers JOIN qualifying ON drivers.driverId = qualifying.driverId JOIN results ON drivers.driverId = results.driverId AND qualifying.raceId = results.raceId JOIN races ON qualifying.raceId = races.raceId WHERE qualifying.position = 1 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(DISTINCT qualifying.raceId) > 10 ORDER BY COUNT(DISTINCT qualifying.raceId) DESC",
    "cypher": "MATCH (driver:drivers)-[:QUALIFIED_IN]->(q:qualifying)-[:FOR_RACE]->(race:races) WHERE q.position = 1 WITH driver, count(DISTINCT race) AS poles MATCH (driver)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race2:races) WHERE result.grid = 1 AND result.position = 1 WITH driver, poles, count(*) AS winsFromPole WHERE poles > 10 RETURN driver.forename, driver.surname, poles, winsFromPole ORDER BY poles DESC"
  },
  {
    "question": "Which circuits have had more than 3 different winners in the last 5 years they hosted races?",
    "sql": "SELECT circuits.name, circuits.country, COUNT(DISTINCT results.driverId), COUNT(DISTINCT races.raceId) FROM circuits JOIN races ON circuits.circuitId = races.circuitId JOIN results ON races.raceId = results.raceId WHERE results.position = 1 AND races.year >= 2018 GROUP BY circuits.circuitId, circuits.name, circuits.country HAVING COUNT(DISTINCT results.driverId) > 3 ORDER BY COUNT(DISTINCT results.driverId) DESC",
    "cypher": "MATCH (result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position = 1 AND toInteger(race.year) >= 2018 WITH circuit, count(DISTINCT result.driverId) AS winners, count(DISTINCT race) AS races WHERE winners > 3 RETURN circuit.name, circuit.country, winners, races ORDER BY winners DESC"
  },
  {
    "question": "Find constructors with more than 50 podiums where the average grid position of podium finishers was worse than 5",
    "sql": "SELECT constructors.name, COUNT(*), AVG(results.grid) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE results.position <= 3 GROUP BY constructors.constructorId, constructors.name HAVING COUNT(*) > 50 AND AVG(results.grid) > 5 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position <= 3 WITH constructor, count(*) AS podiums, avg(result.grid) AS avgGrid WHERE podiums > 50 AND avgGrid > 5 RETURN constructor.name, podiums, avgGrid ORDER BY podiums DESC"
  },
  {
    "question": "Which drivers have won races at both Monza and Silverstone with more than 3 wins at each?",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(*) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE results.position = 1 AND (circuits.name LIKE '%Monza%' OR circuits.name LIKE '%Silverstone%') GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(*) > 6 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position = 1 AND (circuit.name CONTAINS 'Monza' OR circuit.name CONTAINS 'Silverstone') WITH driver, count(*) AS wins WHERE wins > 6 RETURN driver.forename, driver.surname, wins ORDER BY wins DESC"
  },
  {
    "question": "Find seasons where more than 6 different drivers won races and the championship was decided by less than 20 points",
    "sql": "SELECT races.year, COUNT(DISTINCT results.driverId) FROM races JOIN results ON races.raceId = results.raceId WHERE results.position = 1 GROUP BY races.year HAVING COUNT(DISTINCT results.driverId) > 6 ORDER BY races.year DESC",
    "cypher": "MATCH (result:results)-[:IN_RACE]->(race:races) WHERE result.position = 1 WITH race.year AS year, count(DISTINCT result.driverId) AS winners WHERE winners > 6 RETURN year, winners ORDER BY year DESC"
  },
  {
    "question": "Which Finnish drivers have scored more than 500 career points with at least 20 podiums?",
    "sql": "SELECT drivers.forename, drivers.surname, SUM(results.points), COUNT(*) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId WHERE drivers.nationality = 'Finnish' AND results.position <= 3 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING SUM(results.points) > 500 AND COUNT(*) >= 20 ORDER BY SUM(results.points) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE driver.nationality = 'Finnish' AND result.position <= 3 WITH driver, sum(result.points) AS totalPoints, count(*) AS podiums WHERE totalPoints > 500 AND podiums >= 20 RETURN driver.forename, driver.surname, totalPoints, podiums ORDER BY totalPoints DESC"
  },
  {
    "question": "Find races at circuits above 1000m altitude where British drivers scored more than 50 total points",
    "sql": "SELECT races.name, races.year, SUM(results.points), COUNT(DISTINCT drivers.driverId) FROM races JOIN circuits ON races.circuitId = circuits.circuitId JOIN results ON races.raceId = results.raceId JOIN drivers ON results.driverId = drivers.driverId WHERE circuits.alt > 1000 AND drivers.nationality = 'British' GROUP BY races.raceId, races.name, races.year HAVING SUM(results.points) > 50 ORDER BY SUM(results.points) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE circuit.alt > 1000 AND driver.nationality = 'British' WITH race, sum(result.points) AS totalPoints, count(DISTINCT driver) AS drivers WHERE totalPoints > 50 RETURN race.name, race.year, totalPoints, drivers ORDER BY totalPoints DESC"
  },
  {
    "question": "Which constructors have had more than 100 race starts with drivers who achieved at least 10 fastest laps?",
    "sql": "SELECT constructors.name, COUNT(DISTINCT results.raceId), COUNT(DISTINCT CASE WHEN results.rank = 1 THEN results.resultId END) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN drivers ON results.driverId = drivers.driverId JOIN races ON results.raceId = races.raceId GROUP BY constructors.constructorId, constructors.name HAVING COUNT(DISTINCT results.raceId) > 100 AND COUNT(DISTINCT CASE WHEN results.rank = 1 THEN results.resultId END) >= 10 ORDER BY COUNT(DISTINCT results.raceId) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WITH constructor, count(DISTINCT race) AS races, sum(CASE WHEN result.rank = 1 THEN 1 ELSE 0 END) AS fastestLaps WHERE races > 100 AND fastestLaps >= 10 RETURN constructor.name, races, fastestLaps ORDER BY races DESC"
  },
  {
    "question": "Find drivers who have completed more than 80% of total laps in seasons where they scored at least 100 points",
    "sql": "SELECT drivers.forename, drivers.surname, races.year, SUM(results.points), SUM(results.laps) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId GROUP BY drivers.driverId, drivers.forename, drivers.surname, races.year HAVING SUM(results.points) >= 100 AND SUM(results.laps) > 1000 ORDER BY races.year DESC, SUM(results.points) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WITH driver, race.year AS year, sum(result.points) AS totalPoints, sum(result.laps) AS totalLaps WHERE totalPoints >= 100 AND totalLaps > 1000 RETURN driver.forename, driver.surname, year, totalPoints, totalLaps ORDER BY year DESC, totalPoints DESC"
  },
  {
    "question": "Which circuits in Asia have hosted more than 10 races with at least 5 different race winners?",
    "sql": "SELECT circuits.name, circuits.country, COUNT(DISTINCT races.raceId), COUNT(DISTINCT results.driverId) FROM circuits JOIN races ON circuits.circuitId = races.circuitId JOIN results ON races.raceId = results.raceId WHERE circuits.country IN ('Japan', 'China', 'Malaysia', 'Singapore', 'Bahrain', 'UAE', 'Qatar', 'Saudi Arabia') AND results.position = 1 GROUP BY circuits.circuitId, circuits.name, circuits.country HAVING COUNT(DISTINCT races.raceId) > 10 AND COUNT(DISTINCT results.driverId) >= 5 ORDER BY COUNT(DISTINCT races.raceId) DESC",
    "cypher": "MATCH (result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE circuit.country IN ['Japan', 'China', 'Malaysia', 'Singapore', 'Bahrain', 'UAE', 'Qatar', 'Saudi Arabia'] AND result.position = 1 WITH circuit, count(DISTINCT race) AS races, count(DISTINCT result.driverId) AS winners WHERE races > 10 AND winners >= 5 RETURN circuit.name, circuit.country, races, winners ORDER BY races DESC"
  },
  {
    "question": "Find the drivers who have won races for more than 2 different constructors with at least 5 wins per constructor",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(DISTINCT constructors.constructorId), COUNT(*) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN constructors ON results.constructorId = constructors.constructorId JOIN races ON results.raceId = races.raceId WHERE results.position = 1 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(DISTINCT constructors.constructorId) > 2 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)<-[:ACHIEVED]-(constructor:constructors) WHERE result.position = 1 WITH driver, count(DISTINCT constructor) AS teams, count(*) AS wins WHERE teams > 2 RETURN driver.forename, driver.surname, teams, wins ORDER BY wins DESC"
  },
  {
    "question": "Which races had more than 10 retirements and were held at circuits with altitude below 100 meters?",
    "sql": "SELECT races.name, races.year, circuits.name, COUNT(*) FROM races JOIN circuits ON races.circuitId = circuits.circuitId JOIN results ON races.raceId = results.raceId WHERE circuits.alt < 100 AND results.position = 0 GROUP BY races.raceId, races.name, races.year, circuits.name HAVING COUNT(*) > 10 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE circuit.alt < 100 AND result.position = 0 WITH race, circuit, count(*) AS retirements WHERE retirements > 10 RETURN race.name, race.year, circuit.name, retirements ORDER BY retirements DESC"
  },
  {
    "question": "Find constructors that have scored podiums in more than 15 consecutive seasons",
    "sql": "SELECT constructors.name, COUNT(DISTINCT races.year), MIN(races.year), MAX(races.year) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE results.position <= 3 GROUP BY constructors.constructorId, constructors.name HAVING COUNT(DISTINCT races.year) > 15 ORDER BY COUNT(DISTINCT races.year) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position <= 3 WITH constructor, count(DISTINCT race.year) AS seasons, min(toInteger(race.year)) AS firstYear, max(toInteger(race.year)) AS lastYear WHERE seasons > 15 RETURN constructor.name, seasons, firstYear, lastYear ORDER BY seasons DESC"
  },
  {
    "question": "Which drivers have an average qualifying position better than 5 but average race finish worse than 7?",
    "sql": "SELECT drivers.forename, drivers.surname, AVG(qualifying.position), AVG(results.position) FROM drivers JOIN qualifying ON drivers.driverId = qualifying.driverId JOIN results ON drivers.driverId = results.driverId AND qualifying.raceId = results.raceId JOIN races ON qualifying.raceId = races.raceId WHERE qualifying.position > 0 AND results.position > 0 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING AVG(qualifying.position) < 5 AND AVG(results.position) > 7 AND COUNT(*) > 20 ORDER BY AVG(qualifying.position)",
    "cypher": "MATCH (driver:drivers)-[:QUALIFIED_IN]->(q:qualifying)-[:FOR_RACE]->(race:races), (driver)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race) WHERE q.position > 0 AND result.position > 0 WITH driver, avg(q.position) AS avgQual, avg(result.position) AS avgRace, count(*) AS races WHERE avgQual < 5 AND avgRace > 7 AND races > 20 RETURN driver.forename, driver.surname, avgQual, avgRace ORDER BY avgQual"
  },
  {
    "question": "Find races where constructors scored more than 40 combined points but had at least one retirement",
    "sql": "SELECT races.name, races.year, constructors.name, SUM(results.points), COUNT(CASE WHEN results.position = 0 THEN 1 END) FROM races JOIN results ON races.raceId = results.raceId JOIN constructors ON results.constructorId = constructors.constructorId GROUP BY races.raceId, races.name, races.year, constructors.constructorId, constructors.name HAVING SUM(results.points) > 40 AND COUNT(CASE WHEN results.position = 0 THEN 1 END) >= 1 ORDER BY SUM(results.points) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WITH race, constructor, sum(result.points) AS totalPoints, sum(CASE WHEN result.position = 0 THEN 1 ELSE 0 END) AS retirements WHERE totalPoints > 40 AND retirements >= 1 RETURN race.name, race.year, constructor.name, totalPoints, retirements ORDER BY totalPoints DESC"
  },
  {
    "question": "Which drivers have achieved more than 50 points finishes at circuits located between latitude 40 and 55?",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(*), SUM(results.points) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE circuits.lat BETWEEN 40 AND 55 AND results.points > 0 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(*) > 50 ORDER BY SUM(results.points) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE circuit.lat >= 40 AND circuit.lat <= 55 AND result.points > 0 WITH driver, count(*) AS pointsFinishes, sum(result.points) AS totalPoints WHERE pointsFinishes > 50 RETURN driver.forename, driver.surname, pointsFinishes, totalPoints ORDER BY totalPoints DESC"
  },
  {
    "question": "Find constructors with more than 200 race entries where the average finishing position is better than 8",
    "sql": "SELECT constructors.name, constructors.nationality, COUNT(*), AVG(results.position) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE results.position > 0 GROUP BY constructors.constructorId, constructors.name, constructors.nationality HAVING COUNT(*) > 200 AND AVG(results.position) < 8 ORDER BY AVG(results.position)",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position > 0 WITH constructor, count(*) AS entries, avg(result.position) AS avgPos WHERE entries > 200 AND avgPos < 8 RETURN constructor.name, constructor.nationality, entries, avgPos ORDER BY avgPos"
  },
  {
    "question": "Which Spanish drivers have scored points in more than 100 races across their career?",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(*), SUM(results.points) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId WHERE drivers.nationality = 'Spanish' AND results.points > 0 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(*) > 100 ORDER BY SUM(results.points) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE driver.nationality = 'Spanish' AND result.points > 0 WITH driver, count(*) AS pointsRaces, sum(result.points) AS totalPoints WHERE pointsRaces > 100 RETURN driver.forename, driver.surname, pointsRaces, totalPoints ORDER BY totalPoints DESC"
  },
  {
    "question": "Find the races held at street circuits where more than 15 drivers finished the race",
    "sql": "SELECT races.name, races.year, circuits.name, COUNT(*) FROM races JOIN circuits ON races.circuitId = circuits.circuitId JOIN results ON races.raceId = results.raceId WHERE (circuits.name LIKE '%Street%' OR circuits.name LIKE '%Monaco%' OR circuits.name LIKE '%Singapore%') AND results.position > 0 GROUP BY races.raceId, races.name, races.year, circuits.name HAVING COUNT(*) > 15 ORDER BY races.year DESC",
    "cypher": "MATCH (result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE (circuit.name CONTAINS 'Street' OR circuit.name CONTAINS 'Monaco' OR circuit.name CONTAINS 'Singapore') AND result.position > 0 WITH race, circuit, count(*) AS finishers WHERE finishers > 15 RETURN race.name, race.year, circuit.name, finishers ORDER BY race.year DESC"
  },
  {
    "question": "Which constructors have more than 30 wins where the winning driver started outside the top 3?",
    "sql": "SELECT constructors.name, COUNT(*) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE results.position = 1 AND results.grid > 3 GROUP BY constructors.constructorId, constructors.name HAVING COUNT(*) > 30 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position = 1 AND result.grid > 3 WITH constructor, count(*) AS wins WHERE wins > 30 RETURN constructor.name, wins ORDER BY wins DESC"
  },
  {
    "question": "Find drivers who have led the championship at some point with more than 100 career points",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(DISTINCT standings.raceId), MAX(standings.points) FROM drivers JOIN standings ON drivers.driverId = standings.driverId JOIN races ON standings.raceId = races.raceId WHERE standings.position = 1 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING MAX(standings.points) > 100 ORDER BY MAX(standings.points) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED_STANDING]->(standing:standings) WHERE standing.position = 1 WITH driver, count(DISTINCT standing.raceId) AS timesLed, max(standing.points) AS maxPoints WHERE maxPoints > 100 RETURN driver.forename, driver.surname, timesLed, maxPoints ORDER BY maxPoints DESC"
  },
  {
    "question": "Which races had the closest finishes where the top 3 were separated by less than 5 seconds combined?",
    "sql": "SELECT races.name, races.year, circuits.name, COUNT(*) FROM races JOIN circuits ON races.circuitId = circuits.circuitId JOIN results ON races.raceId = results.raceId WHERE results.position <= 3 AND results.milliseconds > 0 GROUP BY races.raceId, races.name, races.year, circuits.name HAVING COUNT(*) = 3 ORDER BY races.year DESC LIMIT 50",
    "cypher": "MATCH (result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position <= 3 AND result.milliseconds <> '' WITH race, circuit, count(*) AS topThree WHERE topThree = 3 RETURN race.name, race.year, circuit.name, topThree ORDER BY race.year DESC LIMIT 50"
  },
  {
    "question": "Find constructors that have scored more points in qualifying rounds 1-5 than rounds 10-15 of a season",
    "sql": "SELECT constructors.name, races.year, SUM(CASE WHEN races.round <= 5 THEN constructor_results.points ELSE 0 END), SUM(CASE WHEN races.round >= 10 AND races.round <= 15 THEN constructor_results.points ELSE 0 END) FROM constructors JOIN constructor_results ON constructors.constructorId = constructor_results.constructorId JOIN races ON constructor_results.raceId = races.raceId GROUP BY constructors.constructorId, constructors.name, races.year HAVING SUM(CASE WHEN races.round <= 5 THEN constructor_results.points ELSE 0 END) > 100 ORDER BY races.year DESC",
    "cypher": "MATCH (constructor:constructors)-[:RESULTED_IN]->(cr:constructor_results), (race:races)-[:RESULTED_IN]->(cr) WITH constructor, race.year AS year, sum(CASE WHEN toInteger(race.round) <= 5 THEN cr.points ELSE 0 END) AS earlyPoints, sum(CASE WHEN toInteger(race.round) >= 10 AND toInteger(race.round) <= 15 THEN cr.points ELSE 0 END) AS latePoints WHERE earlyPoints > 100 RETURN constructor.name, year, earlyPoints, latePoints ORDER BY year DESC"
  },
  {
    "question": "Which drivers have more than 20 wins where they also set the fastest lap in the same race?",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(*) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId WHERE results.position = 1 AND results.rank = 1 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(*) > 20 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position = 1 AND result.rank = 1 WITH driver, count(*) AS grandSlams WHERE grandSlams > 20 RETURN driver.forename, driver.surname, grandSlams ORDER BY grandSlams DESC"
  },
  {
    "question": "Find circuits where the average number of laps completed per race exceeds 55 with at least 10 races hosted",
    "sql": "SELECT circuits.name, circuits.country, AVG(results.laps), COUNT(DISTINCT races.raceId) FROM circuits JOIN races ON circuits.circuitId = races.circuitId JOIN results ON races.raceId = results.raceId WHERE results.position = 1 GROUP BY circuits.circuitId, circuits.name, circuits.country HAVING AVG(results.laps) > 55 AND COUNT(DISTINCT races.raceId) >= 10 ORDER BY AVG(results.laps) DESC",
    "cypher": "MATCH (result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position = 1 WITH circuit, avg(result.laps) AS avgLaps, count(DISTINCT race) AS races WHERE avgLaps > 55 AND races >= 10 RETURN circuit.name, circuit.country, avgLaps, races ORDER BY avgLaps DESC"
  },
  {
    "question": "Which German drivers have scored more than 50 podiums for non-German constructors?",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(*), COUNT(DISTINCT constructors.constructorId) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN constructors ON results.constructorId = constructors.constructorId JOIN races ON results.raceId = races.raceId WHERE drivers.nationality = 'German' AND constructors.nationality != 'German' AND results.position <= 3 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(*) > 50 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)<-[:ACHIEVED]-(constructor:constructors) WHERE driver.nationality = 'German' AND constructor.nationality <> 'German' AND result.position <= 3 WITH driver, count(*) AS podiums, count(DISTINCT constructor) AS teams WHERE podiums > 50 RETURN driver.forename, driver.surname, podiums, teams ORDER BY podiums DESC"
  },
  {
    "question": "Find seasons where more than 4 constructors scored at least one win",
    "sql": "SELECT races.year, COUNT(DISTINCT constructors.constructorId), COUNT(DISTINCT results.driverId) FROM races JOIN results ON races.raceId = results.raceId JOIN constructors ON results.constructorId = constructors.constructorId WHERE results.position = 1 GROUP BY races.year HAVING COUNT(DISTINCT constructors.constructorId) > 4 ORDER BY races.year DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position = 1 WITH race.year AS year, count(DISTINCT constructor) AS winningTeams, count(DISTINCT result.driverId) AS winningDrivers WHERE winningTeams > 4 RETURN year, winningTeams, winningDrivers ORDER BY year DESC"
  },
  {
    "question": "Which drivers have the highest win rate with at least 50 race starts?",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(*), SUM(CASE WHEN results.position = 1 THEN 1 ELSE 0 END) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(*) >= 50 ORDER BY SUM(CASE WHEN results.position = 1 THEN 1 ELSE 0 END) * 1.0 / COUNT(*) DESC LIMIT 10",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WITH driver, count(*) AS starts, sum(CASE WHEN result.position = 1 THEN 1 ELSE 0 END) AS wins WHERE starts >= 50 RETURN driver.forename, driver.surname, starts, wins ORDER BY toFloat(wins) / starts DESC LIMIT 10"
  },
  {
    "question": "Find constructors that have won constructor championships in at least 3 different decades",
    "sql": "SELECT constructors.name, COUNT(DISTINCT races.year / 10) FROM constructors JOIN constructor_standings ON constructors.constructorId = constructor_standings.constructorId JOIN races ON constructor_standings.raceId = races.raceId WHERE constructor_standings.position = 1 GROUP BY constructors.constructorId, constructors.name HAVING COUNT(DISTINCT races.year / 10) >= 3 ORDER BY COUNT(DISTINCT races.year / 10) DESC",
    "cypher": "MATCH (constructor:constructors)-[:HAS_STANDING]->(cs:constructor_standings), (race:races)-[:HAS_STANDING]->(cs) WHERE cs.position = 1 WITH constructor, count(DISTINCT toInteger(race.year) / 10) AS decades WHERE decades >= 3 RETURN constructor.name, decades ORDER BY decades DESC"
  },
  {
    "question": "Which circuits have had the same driver win more than 5 times?",
    "sql": "SELECT circuits.name, drivers.forename, drivers.surname, COUNT(*) FROM circuits JOIN races ON circuits.circuitId = races.circuitId JOIN results ON races.raceId = results.raceId JOIN drivers ON results.driverId = drivers.driverId WHERE results.position = 1 GROUP BY circuits.circuitId, circuits.name, drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(*) > 5 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position = 1 WITH circuit, driver, count(*) AS wins WHERE wins > 5 RETURN circuit.name, driver.forename, driver.surname, wins ORDER BY wins DESC"
  },
  {
    "question": "Find drivers who have scored more points in the second half of seasons than the first half",
    "sql": "SELECT drivers.forename, drivers.surname, races.year, SUM(CASE WHEN races.round <= 10 THEN results.points ELSE 0 END), SUM(CASE WHEN races.round > 10 THEN results.points ELSE 0 END) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId GROUP BY drivers.driverId, drivers.forename, drivers.surname, races.year HAVING SUM(CASE WHEN races.round > 10 THEN results.points ELSE 0 END) > SUM(CASE WHEN races.round <= 10 THEN results.points ELSE 0 END) AND SUM(results.points) > 50 ORDER BY races.year DESC, SUM(results.points) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WITH driver, race.year AS year, sum(CASE WHEN toInteger(race.round) <= 10 THEN result.points ELSE 0 END) AS firstHalf, sum(CASE WHEN toInteger(race.round) > 10 THEN result.points ELSE 0 END) AS secondHalf, sum(result.points) AS total WHERE secondHalf > firstHalf AND total > 50 RETURN driver.forename, driver.surname, year, firstHalf, secondHalf ORDER BY year DESC, total DESC"
  },
  {
    "question": "Which constructors have the highest average points per race at Monaco?",
    "sql": "SELECT constructors.name, AVG(constructor_results.points), COUNT(*) FROM constructors JOIN constructor_results ON constructors.constructorId = constructor_results.constructorId JOIN races ON constructor_results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE circuits.name LIKE '%Monaco%' GROUP BY constructors.constructorId, constructors.name HAVING COUNT(*) >= 5 ORDER BY AVG(constructor_results.points) DESC LIMIT 10",
    "cypher": "MATCH (constructor:constructors)-[:RESULTED_IN]->(cr:constructor_results), (race:races)-[:RESULTED_IN]->(cr), (race)-[:HELD_AT]->(circuit:circuits) WHERE circuit.name CONTAINS 'Monaco' WITH constructor, avg(cr.points) AS avgPoints, count(*) AS races WHERE races >= 5 RETURN constructor.name, avgPoints, races ORDER BY avgPoints DESC LIMIT 10"
  },
  {
    "question": "Find drivers who have never won a race but have more than 30 podium finishes",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(*), SUM(results.points) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId WHERE results.position IN (2, 3) GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(*) > 30 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position IN [2, 3] WITH driver, count(*) AS podiums, sum(result.points) AS totalPoints WHERE podiums > 30 RETURN driver.forename, driver.surname, podiums, totalPoints ORDER BY podiums DESC"
  },
  {
    "question": "Which races had the highest combined points scored by all drivers?",
    "sql": "SELECT races.name, races.year, circuits.name, SUM(results.points), COUNT(DISTINCT results.driverId) FROM races JOIN circuits ON races.circuitId = circuits.circuitId JOIN results ON races.raceId = results.raceId GROUP BY races.raceId, races.name, races.year, circuits.name HAVING SUM(results.points) > 100 ORDER BY SUM(results.points) DESC LIMIT 20",
    "cypher": "MATCH (result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WITH race, circuit, sum(result.points) AS totalPoints, count(DISTINCT result.driverId) AS drivers WHERE totalPoints > 100 RETURN race.name, race.year, circuit.name, totalPoints, drivers ORDER BY totalPoints DESC LIMIT 20"
  },
  {
    "question": "Find constructors with more than 50 one-two finishes in their history",
    "sql": "SELECT constructors.name, COUNT(DISTINCT results.raceId) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE results.position IN (1, 2) GROUP BY constructors.constructorId, constructors.name, results.raceId HAVING COUNT(*) = 2",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position IN [1, 2] WITH constructor, race, count(*) AS topTwo WHERE topTwo = 2 WITH constructor, count(race) AS oneTwos WHERE oneTwos > 50 RETURN constructor.name, oneTwos ORDER BY oneTwos DESC"
  },
  {
    "question": "Which drivers have improved their championship position by more than 5 places between first and last race of a season?",
    "sql": "SELECT drivers.forename, drivers.surname, races.year, MIN(standings.position), MAX(standings.position) FROM drivers JOIN standings ON drivers.driverId = standings.driverId JOIN races ON standings.raceId = races.raceId GROUP BY drivers.driverId, drivers.forename, drivers.surname, races.year HAVING MAX(standings.position) - MIN(standings.position) > 5 AND MIN(standings.position) <= 5 ORDER BY races.year DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED_STANDING]->(standing:standings)<-[:IN_STANDING]-(race:races) WITH driver, race.year AS year, min(standing.position) AS bestPos, max(standing.position) AS worstPos WHERE worstPos - bestPos > 5 AND bestPos <= 5 RETURN driver.forename, driver.surname, year, bestPos, worstPos ORDER BY year DESC"
  },
  {
    "question": "Find circuits where British constructors have won more than 20 races",
    "sql": "SELECT circuits.name, circuits.country, COUNT(*) FROM circuits JOIN races ON circuits.circuitId = races.circuitId JOIN results ON races.raceId = results.raceId JOIN constructors ON results.constructorId = constructors.constructorId WHERE constructors.nationality = 'British' AND results.position = 1 GROUP BY circuits.circuitId, circuits.name, circuits.country HAVING COUNT(*) > 20 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE constructor.nationality = 'British' AND result.position = 1 WITH circuit, count(*) AS wins WHERE wins > 20 RETURN circuit.name, circuit.country, wins ORDER BY wins DESC"
  },
  {
    "question": "Which drivers have the most podiums without ever leading a championship?",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(*) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId WHERE results.position <= 3 AND drivers.driverId NOT IN (SELECT DISTINCT standings.driverId FROM standings WHERE standings.position = 1) GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(*) > 10 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position <= 3 WITH driver, count(*) AS podiums OPTIONAL MATCH (driver)-[:ACHIEVED_STANDING]->(standing:standings) WHERE standing.position = 1 WITH driver, podiums, collect(standing) AS leadingStandings WHERE size(leadingStandings) = 0 AND podiums > 10 RETURN driver.forename, driver.surname, podiums ORDER BY podiums DESC"
  },
  {
    "question": "Find races where more than 3 drivers from the same constructor finished in the points",
    "sql": "SELECT races.name, races.year, constructors.name, COUNT(*) FROM races JOIN results ON races.raceId = results.raceId JOIN constructors ON results.constructorId = constructors.constructorId WHERE results.points > 0 GROUP BY races.raceId, races.name, races.year, constructors.constructorId, constructors.name HAVING COUNT(*) > 3 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.points > 0 WITH race, constructor, count(*) AS pointsFinishers WHERE pointsFinishers > 3 RETURN race.name, race.year, constructor.name, pointsFinishers ORDER BY pointsFinishers DESC"
  },
  {
    "question": "Which constructors have had more than 5 different drivers score wins for them?",
    "sql": "SELECT constructors.name, COUNT(DISTINCT drivers.driverId), COUNT(*) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN drivers ON results.driverId = drivers.driverId JOIN races ON results.raceId = races.raceId WHERE results.position = 1 GROUP BY constructors.constructorId, constructors.name HAVING COUNT(DISTINCT drivers.driverId) > 5 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)<-[:ACHIEVED]-(constructor:constructors) WHERE result.position = 1 WITH constructor, count(DISTINCT driver) AS winningDrivers, count(*) AS totalWins WHERE winningDrivers > 5 RETURN constructor.name, winningDrivers, totalWins ORDER BY totalWins DESC"
  },
  {
    "question": "Find drivers who have achieved more than 10 fastest laps at circuits with altitude above 200m",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(*) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE results.rank = 1 AND circuits.alt > 200 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(*) > 10 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.rank = 1 AND circuit.alt > 200 WITH driver, count(*) AS fastestLaps WHERE fastestLaps > 10 RETURN driver.forename, driver.surname, fastestLaps ORDER BY fastestLaps DESC"
  },
  {
    "question": "Which seasons had more than 8 different pole sitters?",
    "sql": "SELECT races.year, COUNT(DISTINCT qualifying.driverId) FROM races JOIN qualifying ON races.raceId = qualifying.raceId WHERE qualifying.position = 1 GROUP BY races.year HAVING COUNT(DISTINCT qualifying.driverId) > 8 ORDER BY COUNT(DISTINCT qualifying.driverId) DESC",
    "cypher": "MATCH (q:qualifying)-[:FOR_RACE]->(race:races) WHERE q.position = 1 WITH race.year AS year, count(DISTINCT q.driverId) AS poleSitters WHERE poleSitters > 8 RETURN year, poleSitters ORDER BY poleSitters DESC"
  },
  {
    "question": "Find constructors with more podiums in wet races than dry races historically",
    "sql": "SELECT constructors.name, COUNT(*), SUM(results.points) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE results.position <= 3 GROUP BY constructors.constructorId, constructors.name HAVING COUNT(*) > 50 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position <= 3 WITH constructor, count(*) AS podiums, sum(result.points) AS totalPoints WHERE podiums > 50 RETURN constructor.name, podiums, totalPoints ORDER BY podiums DESC"
  },
  {
    "question": "Which drivers have the best qualifying to race position improvement average with at least 30 races?",
    "sql": "SELECT drivers.forename, drivers.surname, AVG(results.grid - results.position), COUNT(*) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId WHERE results.position > 0 AND results.grid > 0 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(*) >= 30 ORDER BY AVG(results.grid - results.position) DESC LIMIT 15",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position > 0 AND result.grid > 0 WITH driver, avg(result.grid - result.position) AS avgImprovement, count(*) AS races WHERE races >= 30 RETURN driver.forename, driver.surname, avgImprovement, races ORDER BY avgImprovement DESC LIMIT 15"
  },
  {
    "question": "Find races at circuits in the southern hemisphere with more than 10 classified finishers",
    "sql": "SELECT races.name, races.year, circuits.name, COUNT(*) FROM races JOIN circuits ON races.circuitId = circuits.circuitId JOIN results ON races.raceId = results.raceId WHERE circuits.lat < 0 AND results.position > 0 GROUP BY races.raceId, races.name, races.year, circuits.name HAVING COUNT(*) > 10 ORDER BY races.year DESC",
    "cypher": "MATCH (result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE circuit.lat < 0 AND result.position > 0 WITH race, circuit, count(*) AS finishers WHERE finishers > 10 RETURN race.name, race.year, circuit.name, finishers ORDER BY race.year DESC"
  },
  {
    "question": "Which constructors have won more than 100 races but never had a driver win the championship?",
    "sql": "SELECT constructors.name, COUNT(*) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE results.position = 1 GROUP BY constructors.constructorId, constructors.name HAVING COUNT(*) > 100 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position = 1 WITH constructor, count(*) AS wins WHERE wins > 100 RETURN constructor.name, wins ORDER BY wins DESC"
  },
  {
    "question": "Find drivers who have scored more than 1000 career points across at least 10 seasons",
    "sql": "SELECT drivers.forename, drivers.surname, SUM(results.points), COUNT(DISTINCT races.year) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING SUM(results.points) > 1000 AND COUNT(DISTINCT races.year) >= 10 ORDER BY SUM(results.points) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WITH driver, sum(result.points) AS totalPoints, count(DISTINCT race.year) AS seasons WHERE totalPoints > 1000 AND seasons >= 10 RETURN driver.forename, driver.surname, totalPoints, seasons ORDER BY totalPoints DESC"
  },
  {
    "question": "Which constructors have achieved more than 50 podiums in seasons where they won the championship?",
    "sql": "SELECT constructors.name, races.year, COUNT(*) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId JOIN constructor_standings ON constructors.constructorId = constructor_standings.constructorId AND races.raceId = constructor_standings.raceId WHERE results.position <= 3 AND constructor_standings.position = 1 GROUP BY constructors.constructorId, constructors.name, races.year HAVING COUNT(*) > 20 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races), (constructor)-[:HAS_STANDING]->(cs:constructor_standings) WHERE result.position <= 3 AND cs.position = 1 WITH constructor, race.year AS year, count(*) AS podiums WHERE podiums > 20 RETURN constructor.name, year, podiums ORDER BY podiums DESC"
  },
  {
    "question": "Find drivers with more wins from pole position than wins from other grid positions",
    "sql": "SELECT drivers.forename, drivers.surname, SUM(CASE WHEN results.grid = 1 THEN 1 ELSE 0 END), SUM(CASE WHEN results.grid > 1 THEN 1 ELSE 0 END) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId WHERE results.position = 1 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING SUM(CASE WHEN results.grid = 1 THEN 1 ELSE 0 END) > SUM(CASE WHEN results.grid > 1 THEN 1 ELSE 0 END) AND SUM(CASE WHEN results.grid = 1 THEN 1 ELSE 0 END) > 10 ORDER BY SUM(CASE WHEN results.grid = 1 THEN 1 ELSE 0 END) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position = 1 WITH driver, sum(CASE WHEN result.grid = 1 THEN 1 ELSE 0 END) AS poleWins, sum(CASE WHEN result.grid > 1 THEN 1 ELSE 0 END) AS otherWins WHERE poleWins > otherWins AND poleWins > 10 RETURN driver.forename, driver.surname, poleWins, otherWins ORDER BY poleWins DESC"
  },
  {
    "question": "Which circuits have hosted races in more than 20 different seasons?",
    "sql": "SELECT circuits.name, circuits.country, COUNT(DISTINCT races.year), MIN(races.year), MAX(races.year) FROM circuits JOIN races ON circuits.circuitId = races.circuitId GROUP BY circuits.circuitId, circuits.name, circuits.country HAVING COUNT(DISTINCT races.year) > 20 ORDER BY COUNT(DISTINCT races.year) DESC",
    "cypher": "MATCH (race:races)-[:HELD_AT]->(circuit:circuits) WITH circuit, count(DISTINCT race.year) AS seasons, min(toInteger(race.year)) AS firstYear, max(toInteger(race.year)) AS lastYear WHERE seasons > 20 RETURN circuit.name, circuit.country, seasons, firstYear, lastYear ORDER BY seasons DESC"
  },
  {
    "question": "Find races where the top 5 finishers all scored more than 15 points each",
    "sql": "SELECT races.name, races.year, SUM(results.points), COUNT(*) FROM races JOIN results ON races.raceId = results.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE results.position <= 5 AND results.points > 15 GROUP BY races.raceId, races.name, races.year HAVING COUNT(*) = 5 ORDER BY races.year DESC",
    "cypher": "MATCH (result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position <= 5 AND result.points > 15 WITH race, sum(result.points) AS totalPoints, count(*) AS count WHERE count = 5 RETURN race.name, race.year, totalPoints ORDER BY race.year DESC"
  },
  {
    "question": "Which drivers have scored podiums for more than 3 different nationalities of constructors?",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(DISTINCT constructors.nationality), COUNT(*) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN constructors ON results.constructorId = constructors.constructorId JOIN races ON results.raceId = races.raceId WHERE results.position <= 3 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(DISTINCT constructors.nationality) > 3 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)<-[:ACHIEVED]-(constructor:constructors) WHERE result.position <= 3 WITH driver, count(DISTINCT constructor.nationality) AS nationalities, count(*) AS podiums WHERE nationalities > 3 RETURN driver.forename, driver.surname, nationalities, podiums ORDER BY podiums DESC"
  },
  {
    "question": "Find constructors that have won races in at least 4 different continents based on circuit locations",
    "sql": "SELECT constructors.name, COUNT(DISTINCT circuits.country), COUNT(*) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE results.position = 1 GROUP BY constructors.constructorId, constructors.name HAVING COUNT(DISTINCT circuits.country) > 10 ORDER BY COUNT(DISTINCT circuits.country) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position = 1 WITH constructor, count(DISTINCT circuit.country) AS countries, count(*) AS wins WHERE countries > 10 RETURN constructor.name, countries, wins ORDER BY countries DESC"
  },
  {
    "question": "Which drivers have the highest average points per race in seasons where they won more than 5 races?",
    "sql": "SELECT drivers.forename, drivers.surname, races.year, AVG(results.points), SUM(CASE WHEN results.position = 1 THEN 1 ELSE 0 END) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId GROUP BY drivers.driverId, drivers.forename, drivers.surname, races.year HAVING SUM(CASE WHEN results.position = 1 THEN 1 ELSE 0 END) > 5 ORDER BY AVG(results.points) DESC LIMIT 20",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WITH driver, race.year AS year, avg(result.points) AS avgPoints, sum(CASE WHEN result.position = 1 THEN 1 ELSE 0 END) AS wins WHERE wins > 5 RETURN driver.forename, driver.surname, year, avgPoints, wins ORDER BY avgPoints DESC LIMIT 20"
  },
  {
    "question": "Find races where Austrian constructors scored more points than Italian constructors",
    "sql": "SELECT races.name, races.year, SUM(CASE WHEN constructors.nationality = 'Austrian' THEN results.points ELSE 0 END), SUM(CASE WHEN constructors.nationality = 'Italian' THEN results.points ELSE 0 END) FROM races JOIN results ON races.raceId = results.raceId JOIN constructors ON results.constructorId = constructors.constructorId WHERE constructors.nationality IN ('Austrian', 'Italian') GROUP BY races.raceId, races.name, races.year HAVING SUM(CASE WHEN constructors.nationality = 'Austrian' THEN results.points ELSE 0 END) > SUM(CASE WHEN constructors.nationality = 'Italian' THEN results.points ELSE 0 END) AND SUM(CASE WHEN constructors.nationality = 'Austrian' THEN results.points ELSE 0 END) > 20 ORDER BY races.year DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE constructor.nationality IN ['Austrian', 'Italian'] WITH race, sum(CASE WHEN constructor.nationality = 'Austrian' THEN result.points ELSE 0 END) AS austrianPoints, sum(CASE WHEN constructor.nationality = 'Italian' THEN result.points ELSE 0 END) AS italianPoints WHERE austrianPoints > italianPoints AND austrianPoints > 20 RETURN race.name, race.year, austrianPoints, italianPoints ORDER BY race.year DESC"
  },
  {
    "question": "Which drivers have started more than 200 races without ever winning the championship?",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(DISTINCT results.raceId), SUM(results.points) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(DISTINCT results.raceId) > 200 ORDER BY COUNT(DISTINCT results.raceId) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WITH driver, count(DISTINCT result.raceId) AS races, sum(result.points) AS totalPoints WHERE races > 200 RETURN driver.forename, driver.surname, races, totalPoints ORDER BY races DESC"
  },
  {
    "question": "Find constructors with more than 100 podiums where the average finishing position was better than 4",
    "sql": "SELECT constructors.name, COUNT(*), AVG(results.position) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE results.position <= 3 GROUP BY constructors.constructorId, constructors.name HAVING COUNT(*) > 100 AND AVG(results.position) < 4 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position <= 3 WITH constructor, count(*) AS podiums, avg(result.position) AS avgPos WHERE podiums > 100 AND avgPos < 4 RETURN constructor.name, podiums, avgPos ORDER BY podiums DESC"
  },
  {
    "question": "Which drivers have qualified in the top 3 more than 50 times but finished outside the top 10 more than 20 times?",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(DISTINCT qualifying.raceId), COUNT(DISTINCT CASE WHEN results.position > 10 THEN results.raceId END) FROM drivers JOIN qualifying ON drivers.driverId = qualifying.driverId JOIN results ON drivers.driverId = results.driverId AND qualifying.raceId = results.raceId JOIN races ON qualifying.raceId = races.raceId WHERE qualifying.position <= 3 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(DISTINCT qualifying.raceId) > 50 AND COUNT(DISTINCT CASE WHEN results.position > 10 OR results.position = 0 THEN results.raceId END) > 20 ORDER BY COUNT(DISTINCT qualifying.raceId) DESC",
    "cypher": "MATCH (driver:drivers)-[:QUALIFIED_IN]->(q:qualifying)-[:FOR_RACE]->(race:races), (driver)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race) WHERE q.position <= 3 WITH driver, count(DISTINCT race) AS topQualifying, sum(CASE WHEN result.position > 10 OR result.position = 0 THEN 1 ELSE 0 END) AS badFinishes WHERE topQualifying > 50 AND badFinishes > 20 RETURN driver.forename, driver.surname, topQualifying, badFinishes ORDER BY topQualifying DESC"
  },
  {
    "question": "Find circuits where German drivers have scored more points than any other nationality",
    "sql": "SELECT circuits.name, circuits.country, SUM(results.points), COUNT(*) FROM circuits JOIN races ON circuits.circuitId = races.circuitId JOIN results ON races.raceId = results.raceId JOIN drivers ON results.driverId = drivers.driverId WHERE drivers.nationality = 'German' GROUP BY circuits.circuitId, circuits.name, circuits.country HAVING SUM(results.points) > 500 ORDER BY SUM(results.points) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE driver.nationality = 'German' WITH circuit, sum(result.points) AS totalPoints, count(*) AS races WHERE totalPoints > 500 RETURN circuit.name, circuit.country, totalPoints, races ORDER BY totalPoints DESC"
  },
  {
    "question": "Which seasons had the closest championship battles with the top 3 separated by less than 50 points at season end?",
    "sql": "SELECT races.year, COUNT(DISTINCT drivers.driverId), MAX(standings.points), MIN(standings.points) FROM races JOIN standings ON races.raceId = standings.raceId JOIN drivers ON standings.driverId = drivers.driverId WHERE standings.position <= 3 GROUP BY races.year HAVING MAX(standings.points) - MIN(standings.points) < 50 AND MAX(races.round) > 15 ORDER BY races.year DESC",
    "cypher": "MATCH (race:races)-[:IN_STANDING]->(standing:standings), (driver:drivers)-[:ACHIEVED_STANDING]->(standing) WHERE standing.position <= 3 WITH race.year AS year, max(standing.points) AS maxPoints, min(standing.points) AS minPoints, count(DISTINCT driver) AS drivers WHERE maxPoints - minPoints < 50 RETURN year, drivers, maxPoints, minPoints ORDER BY year DESC"
  },
  {
    "question": "Find races where the starting grid had more than 5 drivers from the same constructor",
    "sql": "SELECT races.name, races.year, constructors.name, COUNT(*) FROM races JOIN qualifying ON races.raceId = qualifying.raceId JOIN constructors ON qualifying.constructorId = constructors.constructorId GROUP BY races.raceId, races.name, races.year, constructors.constructorId, constructors.name HAVING COUNT(*) > 5 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (constructor:constructors)-[:QUALIFIED_IN]->(q:qualifying)-[:FOR_RACE]->(race:races) WITH race, constructor, count(*) AS drivers WHERE drivers > 5 RETURN race.name, race.year, constructor.name, drivers ORDER BY drivers DESC"
  },
  {
    "question": "Which drivers have more than 25 wins at circuits located west of longitude 0?",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(*), COUNT(DISTINCT circuits.circuitId) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE results.position = 1 AND circuits.lng < 0 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(*) > 25 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position = 1 AND circuit.lng < 0 WITH driver, count(*) AS wins, count(DISTINCT circuit) AS circuits WHERE wins > 25 RETURN driver.forename, driver.surname, wins, circuits ORDER BY wins DESC"
  },
  {
    "question": "Find constructors that have scored more than 1000 points in a single season",
    "sql": "SELECT constructors.name, races.year, SUM(constructor_results.points) FROM constructors JOIN constructor_results ON constructors.constructorId = constructor_results.constructorId JOIN races ON constructor_results.raceId = races.raceId GROUP BY constructors.constructorId, constructors.name, races.year HAVING SUM(constructor_results.points) > 500 ORDER BY SUM(constructor_results.points) DESC",
    "cypher": "MATCH (constructor:constructors)-[:RESULTED_IN]->(cr:constructor_results), (race:races)-[:RESULTED_IN]->(cr) WITH constructor, race.year AS year, sum(cr.points) AS totalPoints WHERE totalPoints > 500 RETURN constructor.name, year, totalPoints ORDER BY totalPoints DESC"
  },
  {
    "question": "Which drivers have led the championship for more than 10 races in a single season?",
    "sql": "SELECT drivers.forename, drivers.surname, races.year, COUNT(*) FROM drivers JOIN standings ON drivers.driverId = standings.driverId JOIN races ON standings.raceId = races.raceId WHERE standings.position = 1 GROUP BY drivers.driverId, drivers.forename, drivers.surname, races.year HAVING COUNT(*) > 10 ORDER BY races.year DESC, COUNT(*) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED_STANDING]->(standing:standings)<-[:IN_STANDING]-(race:races) WHERE standing.position = 1 WITH driver, race.year AS year, count(*) AS racesLeading WHERE racesLeading > 10 RETURN driver.forename, driver.surname, year, racesLeading ORDER BY year DESC, racesLeading DESC"
  },
  {
    "question": "Find races at circuits with latitude between 35 and 45 where British constructors dominated the podium",
    "sql": "SELECT races.name, races.year, circuits.name, COUNT(*) FROM races JOIN circuits ON races.circuitId = circuits.circuitId JOIN results ON races.raceId = results.raceId JOIN constructors ON results.constructorId = constructors.constructorId WHERE circuits.lat BETWEEN 35 AND 45 AND results.position <= 3 AND constructors.nationality = 'British' GROUP BY races.raceId, races.name, races.year, circuits.name HAVING COUNT(*) >= 2 ORDER BY races.year DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE circuit.lat >= 35 AND circuit.lat <= 45 AND result.position <= 3 AND constructor.nationality = 'British' WITH race, circuit, count(*) AS britishPodiums WHERE britishPodiums >= 2 RETURN race.name, race.year, circuit.name, britishPodiums ORDER BY race.year DESC"
  },
  {
    "question": "Which drivers have completed more than 15000 laps across their career?",
    "sql": "SELECT drivers.forename, drivers.surname, SUM(results.laps), COUNT(DISTINCT results.raceId) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING SUM(results.laps) > 15000 ORDER BY SUM(results.laps) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WITH driver, sum(result.laps) AS totalLaps, count(DISTINCT result.raceId) AS races WHERE totalLaps > 15000 RETURN driver.forename, driver.surname, totalLaps, races ORDER BY totalLaps DESC"
  },
  {
    "question": "Find constructors with win rates above 20% in seasons with at least 15 race entries",
    "sql": "SELECT constructors.name, races.year, COUNT(*), SUM(CASE WHEN results.position = 1 THEN 1 ELSE 0 END) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId GROUP BY constructors.constructorId, constructors.name, races.year HAVING COUNT(*) >= 15 AND SUM(CASE WHEN results.position = 1 THEN 1 ELSE 0 END) * 1.0 / COUNT(*) > 0.2 ORDER BY races.year DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WITH constructor, race.year AS year, count(*) AS entries, sum(CASE WHEN result.position = 1 THEN 1 ELSE 0 END) AS wins WHERE entries >= 15 AND toFloat(wins) / entries > 0.2 RETURN constructor.name, year, entries, wins ORDER BY year DESC"
  },
  {
    "question": "Which drivers have more than 80 career podiums with at least 50 second-place finishes?",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(*), SUM(CASE WHEN results.position = 2 THEN 1 ELSE 0 END) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId WHERE results.position <= 3 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(*) > 80 AND SUM(CASE WHEN results.position = 2 THEN 1 ELSE 0 END) >= 50 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position <= 3 WITH driver, count(*) AS podiums, sum(CASE WHEN result.position = 2 THEN 1 ELSE 0 END) AS seconds WHERE podiums > 80 AND seconds >= 50 RETURN driver.forename, driver.surname, podiums, seconds ORDER BY podiums DESC"
  },
  {
    "question": "Find circuits that have hosted round 1 races more than 10 times",
    "sql": "SELECT circuits.name, circuits.country, COUNT(*), MIN(races.year), MAX(races.year) FROM circuits JOIN races ON circuits.circuitId = races.circuitId WHERE races.round = 1 GROUP BY circuits.circuitId, circuits.name, circuits.country HAVING COUNT(*) > 10 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (race:races)-[:HELD_AT]->(circuit:circuits) WHERE race.round = '1' WITH circuit, count(*) AS times, min(toInteger(race.year)) AS firstYear, max(toInteger(race.year)) AS lastYear WHERE times > 10 RETURN circuit.name, circuit.country, times, firstYear, lastYear ORDER BY times DESC"
  },
  {
    "question": "Which constructors have achieved more than 40 one-two finishes where both drivers finished ahead of all competitors?",
    "sql": "SELECT constructors.name, COUNT(*) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE results.position IN (1, 2) GROUP BY constructors.constructorId, constructors.name, results.raceId HAVING COUNT(*) = 2",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position IN [1, 2] WITH constructor, race, count(*) AS topTwo WHERE topTwo = 2 WITH constructor, count(race) AS oneTwos WHERE oneTwos > 40 RETURN constructor.name, oneTwos ORDER BY oneTwos DESC"
  },
  {
    "question": "Find drivers who have raced for Ferrari and scored more than 100 points in a single season with them",
    "sql": "SELECT drivers.forename, drivers.surname, races.year, SUM(results.points) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN constructors ON results.constructorId = constructors.constructorId JOIN races ON results.raceId = races.raceId WHERE constructors.name = 'Ferrari' GROUP BY drivers.driverId, drivers.forename, drivers.surname, races.year HAVING SUM(results.points) > 100 ORDER BY SUM(results.points) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)<-[:ACHIEVED]-(constructor:constructors), (result)-[:IN_RACE]->(race:races) WHERE constructor.name = 'Ferrari' WITH driver, race.year AS year, sum(result.points) AS totalPoints WHERE totalPoints > 100 RETURN driver.forename, driver.surname, year, totalPoints ORDER BY totalPoints DESC"
  },
  {
    "question": "Which races had more than 8 different nationalities of drivers scoring points?",
    "sql": "SELECT races.name, races.year, COUNT(DISTINCT drivers.nationality), SUM(results.points) FROM races JOIN results ON races.raceId = results.raceId JOIN drivers ON results.driverId = drivers.driverId WHERE results.points > 0 GROUP BY races.raceId, races.name, races.year HAVING COUNT(DISTINCT drivers.nationality) > 8 ORDER BY COUNT(DISTINCT drivers.nationality) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.points > 0 WITH race, count(DISTINCT driver.nationality) AS nationalities, sum(result.points) AS totalPoints WHERE nationalities > 8 RETURN race.name, race.year, nationalities, totalPoints ORDER BY nationalities DESC"
  },
  {
    "question": "Find constructors that have had drivers retire from more than 200 races",
    "sql": "SELECT constructors.name, COUNT(*), COUNT(DISTINCT results.driverId) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE results.position = 0 GROUP BY constructors.constructorId, constructors.name HAVING COUNT(*) > 200 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position = 0 WITH constructor, count(*) AS retirements, count(DISTINCT result.driverId) AS drivers WHERE retirements > 200 RETURN constructor.name, retirements, drivers ORDER BY retirements DESC"
  },
  {
    "question": "Which drivers have the highest ratio of wins to podiums with at least 30 podiums?",
    "sql": "SELECT drivers.forename, drivers.surname, SUM(CASE WHEN results.position = 1 THEN 1 ELSE 0 END), COUNT(*) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId WHERE results.position <= 3 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(*) >= 30 ORDER BY SUM(CASE WHEN results.position = 1 THEN 1 ELSE 0 END) * 1.0 / COUNT(*) DESC LIMIT 15",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position <= 3 WITH driver, sum(CASE WHEN result.position = 1 THEN 1 ELSE 0 END) AS wins, count(*) AS podiums WHERE podiums >= 30 RETURN driver.forename, driver.surname, wins, podiums, toFloat(wins) / podiums ORDER BY toFloat(wins) / podiums DESC LIMIT 15"
  },
  {
    "question": "Find races at circuits above 500m altitude where the winner started from grid position 5 or lower",
    "sql": "SELECT races.name, races.year, circuits.name, circuits.alt, results.grid FROM races JOIN circuits ON races.circuitId = circuits.circuitId JOIN results ON races.raceId = results.raceId WHERE circuits.alt > 500 AND results.position = 1 AND results.grid >= 5 ORDER BY results.grid DESC",
    "cypher": "MATCH (result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE circuit.alt > 500 AND result.position = 1 AND result.grid >= 5 RETURN race.name, race.year, circuit.name, circuit.alt, result.grid ORDER BY result.grid DESC"
  },
  {
    "question": "Which seasons had the most competitive fields with at least 5 different race winners?",
    "sql": "SELECT races.year, COUNT(DISTINCT results.driverId), COUNT(DISTINCT results.raceId) FROM races JOIN results ON races.raceId = results.raceId WHERE results.position = 1 GROUP BY races.year HAVING COUNT(DISTINCT results.driverId) >= 5 ORDER BY COUNT(DISTINCT results.driverId) DESC",
    "cypher": "MATCH (result:results)-[:IN_RACE]->(race:races) WHERE result.position = 1 WITH race.year AS year, count(DISTINCT result.driverId) AS winners, count(DISTINCT race) AS races WHERE winners >= 5 RETURN year, winners, races ORDER BY winners DESC"
  },
  {
    "question": "Find drivers who have scored points in more than 150 different races across multiple constructors",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(DISTINCT results.raceId), COUNT(DISTINCT results.constructorId), SUM(results.points) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN constructors ON results.constructorId = constructors.constructorId JOIN races ON results.raceId = races.raceId WHERE results.points > 0 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(DISTINCT results.raceId) > 150 AND COUNT(DISTINCT results.constructorId) >= 2 ORDER BY SUM(results.points) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)<-[:ACHIEVED]-(constructor:constructors) WHERE result.points > 0 WITH driver, count(DISTINCT result.raceId) AS races, count(DISTINCT constructor) AS teams, sum(result.points) AS totalPoints WHERE races > 150 AND teams >= 2 RETURN driver.forename, driver.surname, races, teams, totalPoints ORDER BY totalPoints DESC"
  },
  {
    "question": "Which constructors have the best average grid position for their winning races?",
    "sql": "SELECT constructors.name, AVG(results.grid), COUNT(*) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE results.position = 1 GROUP BY constructors.constructorId, constructors.name HAVING COUNT(*) >= 20 ORDER BY AVG(results.grid) LIMIT 10",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position = 1 WITH constructor, avg(result.grid) AS avgGrid, count(*) AS wins WHERE wins >= 20 RETURN constructor.name, avgGrid, wins ORDER BY avgGrid LIMIT 10"
  },
  {
    "question": "Find races where Japanese constructors outscored all European constructors combined",
    "sql": "SELECT races.name, races.year, SUM(CASE WHEN constructors.nationality = 'Japanese' THEN results.points ELSE 0 END), SUM(CASE WHEN constructors.nationality IN ('British', 'German', 'Italian', 'French', 'Austrian', 'Swiss') THEN results.points ELSE 0 END) FROM races JOIN results ON races.raceId = results.raceId JOIN constructors ON results.constructorId = constructors.constructorId GROUP BY races.raceId, races.name, races.year HAVING SUM(CASE WHEN constructors.nationality = 'Japanese' THEN results.points ELSE 0 END) > SUM(CASE WHEN constructors.nationality IN ('British', 'German', 'Italian', 'French', 'Austrian', 'Swiss') THEN results.points ELSE 0 END) AND SUM(CASE WHEN constructors.nationality = 'Japanese' THEN results.points ELSE 0 END) > 20 ORDER BY races.year DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WITH race, sum(CASE WHEN constructor.nationality = 'Japanese' THEN result.points ELSE 0 END) AS japanesePoints, sum(CASE WHEN constructor.nationality IN ['British', 'German', 'Italian', 'French', 'Austrian', 'Swiss'] THEN result.points ELSE 0 END) AS europeanPoints WHERE japanesePoints > europeanPoints AND japanesePoints > 20 RETURN race.name, race.year, japanesePoints, europeanPoints ORDER BY race.year DESC"
  },
  {
    "question": "Which drivers have qualified in pole position at more than 10 different circuits?",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(DISTINCT circuits.circuitId), COUNT(*) FROM drivers JOIN qualifying ON drivers.driverId = qualifying.driverId JOIN races ON qualifying.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE qualifying.position = 1 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(DISTINCT circuits.circuitId) > 10 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (driver:drivers)-[:QUALIFIED_IN]->(q:qualifying)-[:FOR_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE q.position = 1 WITH driver, count(DISTINCT circuit) AS circuits, count(*) AS poles WHERE circuits > 10 RETURN driver.forename, driver.surname, circuits, poles ORDER BY poles DESC"
  },
  {
    "question": "Find constructors with more than 500 points in races held at circuits below sea level",
    "sql": "SELECT constructors.name, SUM(results.points), COUNT(DISTINCT races.raceId) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE circuits.alt < 0 GROUP BY constructors.constructorId, constructors.name HAVING SUM(results.points) > 500 ORDER BY SUM(results.points) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE circuit.alt < 0 WITH constructor, sum(result.points) AS totalPoints, count(DISTINCT race) AS races WHERE totalPoints > 500 RETURN constructor.name, totalPoints, races ORDER BY totalPoints DESC"
  },
  {
    "question": "Which drivers have the most consecutive point-scoring finishes?",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(*), SUM(results.points) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId WHERE results.points > 0 GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(*) > 50 ORDER BY COUNT(*) DESC LIMIT 15",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.points > 0 WITH driver, count(*) AS pointsFinishes, sum(result.points) AS totalPoints WHERE pointsFinishes > 50 RETURN driver.forename, driver.surname, pointsFinishes, totalPoints ORDER BY pointsFinishes DESC LIMIT 15"
  },
  {
    "question": "Find races where the top 3 finishers all came from different constructors and scored more than 50 points combined",
    "sql": "SELECT races.name, races.year, COUNT(DISTINCT constructors.constructorId), SUM(results.points) FROM races JOIN results ON races.raceId = results.raceId JOIN constructors ON results.constructorId = constructors.constructorId WHERE results.position <= 3 GROUP BY races.raceId, races.name, races.year HAVING COUNT(DISTINCT constructors.constructorId) = 3 AND SUM(results.points) > 50 ORDER BY races.year DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position <= 3 WITH race, count(DISTINCT constructor) AS teams, sum(result.points) AS totalPoints WHERE teams = 3 AND totalPoints > 50 RETURN race.name, race.year, teams, totalPoints ORDER BY race.year DESC"
  },
  {
    "question": "Which constructors have scored more than 100 podiums in the last decade?",
    "sql": "SELECT constructors.name, COUNT(*), SUM(results.points) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON results.raceId = races.raceId WHERE results.position <= 3 AND races.year >= 2014 GROUP BY constructors.constructorId, constructors.name HAVING COUNT(*) > 100 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (constructor:constructors)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races) WHERE result.position <= 3 AND toInteger(race.year) >= 2014 WITH constructor, count(*) AS podiums, sum(result.points) AS totalPoints WHERE podiums > 100 RETURN constructor.name, podiums, totalPoints ORDER BY podiums DESC"
  },
  {
    "question": "Find drivers who have won at Monaco more than 3 times",
    "sql": "SELECT drivers.forename, drivers.surname, COUNT(*) FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId JOIN circuits ON races.circuitId = circuits.circuitId WHERE results.position = 1 AND circuits.name LIKE '%Monaco%' GROUP BY drivers.driverId, drivers.forename, drivers.surname HAVING COUNT(*) > 3 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position = 1 AND circuit.name CONTAINS 'Monaco' WITH driver, count(*) AS wins WHERE wins > 3 RETURN driver.forename, driver.surname, wins ORDER BY wins DESC"
  },
  {
    "question": "Which races had the most classified finishers with more than 18 drivers completing the race?",
    "sql": "SELECT races.name, races.year, circuits.name, COUNT(*) FROM races JOIN circuits ON races.circuitId = circuits.circuitId JOIN results ON races.raceId = results.raceId WHERE results.position > 0 GROUP BY races.raceId, races.name, races.year, circuits.name HAVING COUNT(*) > 18 ORDER BY COUNT(*) DESC LIMIT 20",
    "cypher": "MATCH (result:results)-[:IN_RACE]->(race:races)-[:HELD_AT]->(circuit:circuits) WHERE result.position > 0 WITH race, circuit, count(*) AS finishers WHERE finishers > 18 RETURN race.name, race.year, circuit.name, finishers ORDER BY finishers DESC LIMIT 20"
  },
  {
    "question": "Find constructors that have achieved more than 200 podiums with drivers from at least 4 different nationalities",
    "sql": "SELECT constructors.name, COUNT(*), COUNT(DISTINCT drivers.nationality) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN drivers ON results.driverId = drivers.driverId JOIN races ON results.raceId = races.raceId WHERE results.position <= 3 GROUP BY constructors.constructorId, constructors.name HAVING COUNT(*) > 200 AND COUNT(DISTINCT drivers.nationality) >= 4 ORDER BY COUNT(*) DESC",
    "cypher": "MATCH (driver:drivers)-[:ACHIEVED]->(result:results)<-[:ACHIEVED]-(constructor:constructors) WHERE result.position <= 3 WITH constructor, count(*) AS podiums, count(DISTINCT driver.nationality) AS nationalities WHERE podiums > 200 AND nationalities >= 4 RETURN constructor.name, podiums, nationalities ORDER BY podiums DESC"
  }
]