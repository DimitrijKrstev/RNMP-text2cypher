[
  {
    "question": "Which sponsors have more than 10 Phase 3 studies with enrollment over 100?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id WHERE studies.phase = 'Phase 3' AND studies.enrollment > 100 GROUP BY sponsors.sponsor_id, sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 10 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies) WHERE study.phase = 'Phase 3' AND toInteger(study.enrollment) > 100 WITH sponsor, count(DISTINCT study) AS studyCount WHERE studyCount > 10 RETURN sponsor.name, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which conditions are studied in more than 5 randomized double-blind trials?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE designs.allocation = 'Randomized' AND designs.masking = 'Double' GROUP BY conditions.condition_id, conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 5 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies)<-[:HAS_CONDITION_RECORD]-(study:studies)-[:HAS_DESIGN]->(design:designs) WHERE design.allocation = 'Randomized' AND design.masking = 'Double' WITH condition, count(DISTINCT study) AS studyCount WHERE studyCount > 5 RETURN condition.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which industry sponsors fund more than 3 FDA regulated drug studies in Phase 2 or Phase 3?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id WHERE sponsors.agency_class = 'INDUSTRY' AND studies.is_fda_regulated_drug = 'Yes' AND (studies.phase = 'Phase 2' OR studies.phase = 'Phase 3') GROUP BY sponsors.sponsor_id, sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 3 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies) WHERE sponsor.agency_class = 'INDUSTRY' AND study.is_fda_regulated_drug = 'Yes' AND (study.phase = 'Phase 2' OR study.phase = 'Phase 3') WITH sponsor, count(DISTINCT study) AS studyCount WHERE studyCount > 3 RETURN sponsor.name, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which interventions are used in more than 8 treatment studies with enrollment between 50 and 500?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE designs.primary_purpose = 'Treatment' AND studies.enrollment BETWEEN 50 AND 500 GROUP BY interventions.intervention_id, interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 8 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (intervention:interventions)<-[:FOR_INTERVENTION]-(is:interventions_studies)<-[:HAS_INTERVENTION_RECORD]-(study:studies)-[:HAS_DESIGN]->(design:designs) WHERE design.primary_purpose = 'Treatment' AND toInteger(study.enrollment) >= 50 AND toInteger(study.enrollment) <= 500 WITH intervention, count(DISTINCT study) AS studyCount WHERE studyCount > 8 RETURN intervention.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which countries have more than 20 facilities conducting Phase 3 interventional studies?",
    "sql": "SELECT facilities.country, COUNT(DISTINCT facilities.facility_id) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id WHERE studies.phase = 'Phase 3' AND studies.study_type = 'Interventional' GROUP BY facilities.country HAVING COUNT(DISTINCT facilities.facility_id) > 20 ORDER BY COUNT(DISTINCT facilities.facility_id) DESC",
    "cypher": "MATCH (facility:facilities)<-[:AT_FACILITY]-(fs:facilities_studies)<-[:HAS_FACILITY_RECORD]-(study:studies) WHERE study.phase = 'Phase 3' AND study.study_type = 'Interventional' WITH facility.country AS country, count(DISTINCT facility) AS facilityCount WHERE facilityCount > 20 RETURN country, facilityCount ORDER BY facilityCount DESC"
  },
  {
    "question": "Which sponsors have an average enrollment greater than 200 across their Phase 2 and Phase 3 studies?",
    "sql": "SELECT sponsors.name, AVG(studies.enrollment) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id WHERE studies.phase IN ('Phase 2', 'Phase 3') GROUP BY sponsors.sponsor_id, sponsors.name HAVING AVG(studies.enrollment) > 200 ORDER BY AVG(studies.enrollment) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies) WHERE study.phase IN ['Phase 2', 'Phase 3'] WITH sponsor, avg(toInteger(study.enrollment)) AS avgEnrollment WHERE avgEnrollment > 200 RETURN sponsor.name, avgEnrollment ORDER BY avgEnrollment DESC"
  },
  {
    "question": "Which conditions have more than 3 studies with both randomized allocation and triple masking?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE designs.allocation = 'Randomized' AND designs.masking = 'Triple' GROUP BY conditions.condition_id, conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 3 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies)<-[:HAS_CONDITION_RECORD]-(study:studies)-[:HAS_DESIGN]->(design:designs) WHERE design.allocation = 'Randomized' AND design.masking = 'Triple' WITH condition, count(DISTINCT study) AS studyCount WHERE studyCount > 3 RETURN condition.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which US states have more than 15 facilities running studies that accept healthy volunteers?",
    "sql": "SELECT facilities.state, COUNT(DISTINCT facilities.facility_id) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id JOIN eligibilities ON studies.nct_id = eligibilities.nct_id WHERE facilities.country = 'United States' AND eligibilities.healthy_volunteers = 'Yes' GROUP BY facilities.state HAVING COUNT(DISTINCT facilities.facility_id) > 15 ORDER BY COUNT(DISTINCT facilities.facility_id) DESC",
    "cypher": "MATCH (facility:facilities)<-[:AT_FACILITY]-(fs:facilities_studies)<-[:HAS_FACILITY_RECORD]-(study:studies)-[:HAS_ELIGIBILITY]->(elig:eligibilities) WHERE facility.country = 'United States' AND elig.healthy_volunteers = 'Yes' WITH facility.state AS state, count(DISTINCT facility) AS facilityCount WHERE facilityCount > 15 RETURN state, facilityCount ORDER BY facilityCount DESC"
  },
  {
    "question": "Which interventions have a total enrollment exceeding 5000 across all Phase 3 studies?",
    "sql": "SELECT interventions.mesh_term, SUM(studies.enrollment) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id WHERE studies.phase = 'Phase 3' GROUP BY interventions.intervention_id, interventions.mesh_term HAVING SUM(studies.enrollment) > 5000 ORDER BY SUM(studies.enrollment) DESC",
    "cypher": "MATCH (intervention:interventions)<-[:FOR_INTERVENTION]-(is:interventions_studies)<-[:HAS_INTERVENTION_RECORD]-(study:studies) WHERE study.phase = 'Phase 3' WITH intervention, sum(toInteger(study.enrollment)) AS totalEnrollment WHERE totalEnrollment > 5000 RETURN intervention.mesh_term, totalEnrollment ORDER BY totalEnrollment DESC"
  },
  {
    "question": "Which sponsors have more than 5 studies with parallel assignment design and more than 2 arms?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE designs.intervention_model = 'Parallel Assignment' AND studies.number_of_arms > 2 GROUP BY sponsors.sponsor_id, sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 5 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies)-[:HAS_DESIGN]->(design:designs) WHERE design.intervention_model = 'Parallel Assignment' AND toInteger(study.number_of_arms) > 2 WITH sponsor, count(DISTINCT study) AS studyCount WHERE studyCount > 5 RETURN sponsor.name, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which conditions have more than 10 studies sponsored by industry with enrollment over 75?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN sponsors_studies ON studies.nct_id = sponsors_studies.nct_id JOIN sponsors ON sponsors_studies.sponsor_id = sponsors.sponsor_id WHERE sponsors.agency_class = 'INDUSTRY' AND studies.enrollment > 75 GROUP BY conditions.condition_id, conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 10 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies)<-[:HAS_CONDITION_RECORD]-(study:studies)-[:HAS_SPONSOR_RECORD]->(ss:sponsors_studies)-[:BY_SPONSOR]->(sponsor:sponsors) WHERE sponsor.agency_class = 'INDUSTRY' AND toInteger(study.enrollment) > 75 WITH condition, count(DISTINCT study) AS studyCount WHERE studyCount > 10 RETURN condition.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which facilities have hosted more than 8 studies with treatment purpose that started after 2018?",
    "sql": "SELECT facilities.name, facilities.city, facilities.country, COUNT(DISTINCT studies.nct_id) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE designs.primary_purpose = 'Treatment' AND studies.start_date > '2018-01-01 00:00:00' GROUP BY facilities.facility_id, facilities.name, facilities.city, facilities.country HAVING COUNT(DISTINCT studies.nct_id) > 8 ORDER BY COUNT(DISTINCT studies.nct_id) DESC LIMIT 50",
    "cypher": "MATCH (facility:facilities)<-[:AT_FACILITY]-(fs:facilities_studies)<-[:HAS_FACILITY_RECORD]-(study:studies)-[:HAS_DESIGN]->(design:designs) WHERE design.primary_purpose = 'Treatment' AND study.start_date > '2018-01-01' WITH facility, count(DISTINCT study) AS studyCount WHERE studyCount > 8 RETURN facility.name, facility.city, facility.country, studyCount ORDER BY studyCount DESC LIMIT 50"
  },
  {
    "question": "Which interventions have more than 4 studies with crossover design accepting healthy volunteers?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id JOIN eligibilities ON studies.nct_id = eligibilities.nct_id WHERE designs.intervention_model = 'Crossover Assignment' AND eligibilities.healthy_volunteers = 'Yes' GROUP BY interventions.intervention_id, interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 4 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (intervention:interventions)<-[:FOR_INTERVENTION]-(is:interventions_studies)<-[:HAS_INTERVENTION_RECORD]-(study:studies)-[:HAS_DESIGN]->(design:designs), (study)-[:HAS_ELIGIBILITY]->(elig:eligibilities) WHERE design.intervention_model = 'Crossover Assignment' AND elig.healthy_volunteers = 'Yes' WITH intervention, count(DISTINCT study) AS studyCount WHERE studyCount > 4 RETURN intervention.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which sponsors have more than 3 studies in Phase 1, Phase 2, and Phase 3 combined with a data monitoring committee?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id WHERE studies.phase IN ('Phase 1', 'Phase 2', 'Phase 3') AND studies.has_dmc = 't' GROUP BY sponsors.sponsor_id, sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 3 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies) WHERE study.phase IN ['Phase 1', 'Phase 2', 'Phase 3'] AND study.has_dmc = 't' WITH sponsor, count(DISTINCT study) AS studyCount WHERE studyCount > 3 RETURN sponsor.name, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which conditions have average enrollment greater than 150 in studies with quadruple masking?",
    "sql": "SELECT conditions.mesh_term, AVG(studies.enrollment) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE designs.masking = 'Quadruple' GROUP BY conditions.condition_id, conditions.mesh_term HAVING AVG(studies.enrollment) > 150 ORDER BY AVG(studies.enrollment) DESC",
    "cypher": "MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies)<-[:HAS_CONDITION_RECORD]-(study:studies)-[:HAS_DESIGN]->(design:designs) WHERE design.masking = 'Quadruple' WITH condition, avg(toInteger(study.enrollment)) AS avgEnrollment WHERE avgEnrollment > 150 RETURN condition.mesh_term, avgEnrollment ORDER BY avgEnrollment DESC"
  },
  {
    "question": "Which countries have more than 50 studies with facilities conducting FDA regulated drug trials?",
    "sql": "SELECT facilities.country, COUNT(DISTINCT studies.nct_id) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id WHERE studies.is_fda_regulated_drug = 'Yes' GROUP BY facilities.country HAVING COUNT(DISTINCT studies.nct_id) > 50 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (facility:facilities)<-[:AT_FACILITY]-(fs:facilities_studies)<-[:HAS_FACILITY_RECORD]-(study:studies) WHERE study.is_fda_regulated_drug = 'Yes' WITH facility.country AS country, count(DISTINCT study) AS studyCount WHERE studyCount > 50 RETURN country, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which sponsors have more than 6 studies enrolling only adults with prevention purpose?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN eligibilities ON studies.nct_id = eligibilities.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE eligibilities.adult = 'Yes' AND eligibilities.child = 'No' AND designs.primary_purpose = 'Prevention' GROUP BY sponsors.sponsor_id, sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 6 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies)-[:HAS_ELIGIBILITY]->(elig:eligibilities), (study)-[:HAS_DESIGN]->(design:designs) WHERE elig.adult = 'Yes' AND elig.child = 'No' AND design.primary_purpose = 'Prevention' WITH sponsor, count(DISTINCT study) AS studyCount WHERE studyCount > 6 RETURN sponsor.name, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which interventions have more than 3 studies at facilities in Germany or France?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN facilities_studies ON studies.nct_id = facilities_studies.nct_id JOIN facilities ON facilities_studies.facility_id = facilities.facility_id WHERE facilities.country IN ('Germany', 'France') GROUP BY interventions.intervention_id, interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 3 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (intervention:interventions)<-[:FOR_INTERVENTION]-(is:interventions_studies)<-[:HAS_INTERVENTION_RECORD]-(study:studies)-[:HAS_FACILITY_RECORD]->(fs:facilities_studies)-[:AT_FACILITY]->(facility:facilities) WHERE facility.country IN ['Germany', 'France'] WITH intervention, count(DISTINCT study) AS studyCount WHERE studyCount > 3 RETURN intervention.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which conditions have more than 5 observational cohort studies with prospective time perspective?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE studies.study_type = 'Observational' AND designs.observational_model = 'Cohort' AND designs.time_perspective = 'Prospective' GROUP BY conditions.condition_id, conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 5 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies)<-[:HAS_CONDITION_RECORD]-(study:studies)-[:HAS_DESIGN]->(design:designs) WHERE study.study_type = 'Observational' AND design.observational_model = 'Cohort' AND design.time_perspective = 'Prospective' WITH condition, count(DISTINCT study) AS studyCount WHERE studyCount > 5 RETURN condition.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which sponsors have total enrollment exceeding 10000 across all their interventional studies?",
    "sql": "SELECT sponsors.name, SUM(studies.enrollment) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id WHERE studies.study_type = 'Interventional' GROUP BY sponsors.sponsor_id, sponsors.name HAVING SUM(studies.enrollment) > 10000 ORDER BY SUM(studies.enrollment) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies) WHERE study.study_type = 'Interventional' WITH sponsor, sum(toInteger(study.enrollment)) AS totalEnrollment WHERE totalEnrollment > 10000 RETURN sponsor.name, totalEnrollment ORDER BY totalEnrollment DESC"
  },
  {
    "question": "Which conditions are studied in more than 4 Phase 3 studies with open label design and enrollment over 100?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE studies.phase = 'Phase 3' AND designs.masking = 'None (Open Label)' AND studies.enrollment > 100 GROUP BY conditions.condition_id, conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 4 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies)<-[:HAS_CONDITION_RECORD]-(study:studies)-[:HAS_DESIGN]->(design:designs) WHERE study.phase = 'Phase 3' AND design.masking = 'None (Open Label)' AND toInteger(study.enrollment) > 100 WITH condition, count(DISTINCT study) AS studyCount WHERE studyCount > 4 RETURN condition.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which interventions have more than 6 studies with subject and investigator masking?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE designs.subject_masked = 'Yes' AND designs.investigator_masked = 'Yes' GROUP BY interventions.intervention_id, interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 6 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (intervention:interventions)<-[:FOR_INTERVENTION]-(is:interventions_studies)<-[:HAS_INTERVENTION_RECORD]-(study:studies)-[:HAS_DESIGN]->(design:designs) WHERE design.subject_masked = 'Yes' AND design.investigator_masked = 'Yes' WITH intervention, count(DISTINCT study) AS studyCount WHERE studyCount > 6 RETURN intervention.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which US states have more than 10 facilities hosting Phase 2 or Phase 3 studies for industry sponsors?",
    "sql": "SELECT facilities.state, COUNT(DISTINCT facilities.facility_id) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id JOIN sponsors_studies ON studies.nct_id = sponsors_studies.nct_id JOIN sponsors ON sponsors_studies.sponsor_id = sponsors.sponsor_id WHERE facilities.country = 'United States' AND (studies.phase = 'Phase 2' OR studies.phase = 'Phase 3') AND sponsors.agency_class = 'INDUSTRY' GROUP BY facilities.state HAVING COUNT(DISTINCT facilities.facility_id) > 10 ORDER BY COUNT(DISTINCT facilities.facility_id) DESC",
    "cypher": "MATCH (facility:facilities)<-[:AT_FACILITY]-(fs:facilities_studies)<-[:HAS_FACILITY_RECORD]-(study:studies)-[:HAS_SPONSOR_RECORD]->(ss:sponsors_studies)-[:BY_SPONSOR]->(sponsor:sponsors) WHERE facility.country = 'United States' AND (study.phase = 'Phase 2' OR study.phase = 'Phase 3') AND sponsor.agency_class = 'INDUSTRY' WITH facility.state AS state, count(DISTINCT facility) AS facilityCount WHERE facilityCount > 10 RETURN state, facilityCount ORDER BY facilityCount DESC"
  },
  {
    "question": "Which sponsors have more than 2 studies with diagnostic purpose and single group assignment?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE designs.primary_purpose = 'Diagnostic' AND designs.intervention_model = 'Single Group Assignment' GROUP BY sponsors.sponsor_id, sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 2 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies)-[:HAS_DESIGN]->(design:designs) WHERE design.primary_purpose = 'Diagnostic' AND design.intervention_model = 'Single Group Assignment' WITH sponsor, count(DISTINCT study) AS studyCount WHERE studyCount > 2 RETURN sponsor.name, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which conditions have average enrollment greater than 100 in Phase 1 or Early Phase 1 studies?",
    "sql": "SELECT conditions.mesh_term, AVG(studies.enrollment) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id WHERE studies.phase IN ('Phase 1', 'Early Phase 1') GROUP BY conditions.condition_id, conditions.mesh_term HAVING AVG(studies.enrollment) > 100 ORDER BY AVG(studies.enrollment) DESC",
    "cypher": "MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies)<-[:HAS_CONDITION_RECORD]-(study:studies) WHERE study.phase IN ['Phase 1', 'Early Phase 1'] WITH condition, avg(toInteger(study.enrollment)) AS avgEnrollment WHERE avgEnrollment > 100 RETURN condition.mesh_term, avgEnrollment ORDER BY avgEnrollment DESC"
  },
  {
    "question": "Which sponsors have more than 5 studies with reported serious adverse events affecting more than 10 subjects?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN reported_event_totals ON studies.nct_id = reported_event_totals.nct_id WHERE reported_event_totals.event_type = 'Serious' AND reported_event_totals.subjects_affected > 10 GROUP BY sponsors.sponsor_id, sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 5 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies)-[:HAS_EVENT_TOTAL]->(event:reported_event_totals) WHERE event.event_type = 'Serious' AND toInteger(event.subjects_affected) > 10 WITH sponsor, count(DISTINCT study) AS studyCount WHERE studyCount > 5 RETURN sponsor.name, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which conditions have more than 3 studies with statistically significant outcome analyses (p-value < 0.05)?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN outcomes ON studies.nct_id = outcomes.nct_id JOIN outcome_analyses ON outcomes.id = outcome_analyses.outcome_id WHERE outcome_analyses.p_value < 0.05 GROUP BY conditions.condition_id, conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 3 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies)<-[:HAS_CONDITION_RECORD]-(study:studies)-[:HAS_OUTCOME]->(outcome:outcomes)-[:HAS_ANALYSIS]->(analysis:outcome_analyses) WHERE toFloat(analysis.p_value) < 0.05 WITH condition, count(DISTINCT study) AS studyCount WHERE studyCount > 3 RETURN condition.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which interventions have more than 4 studies with withdrawals due to adverse events exceeding 5 participants?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN drop_withdrawals ON studies.nct_id = drop_withdrawals.nct_id WHERE drop_withdrawals.reason = 'Adverse Event' AND drop_withdrawals.count > 5 GROUP BY interventions.intervention_id, interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 4 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (intervention:interventions)<-[:FOR_INTERVENTION]-(is:interventions_studies)<-[:HAS_INTERVENTION_RECORD]-(study:studies)-[:HAS_WITHDRAWAL]->(withdrawal:drop_withdrawals) WHERE withdrawal.reason = 'Adverse Event' AND toInteger(withdrawal.count) > 5 WITH intervention, count(DISTINCT study) AS studyCount WHERE studyCount > 4 RETURN intervention.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which sponsors have more than 10 primary outcomes recorded across their Phase 3 studies?",
    "sql": "SELECT sponsors.name, COUNT(outcomes.id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN outcomes ON studies.nct_id = outcomes.nct_id WHERE studies.phase = 'Phase 3' AND outcomes.outcome_type = 'Primary' GROUP BY sponsors.sponsor_id, sponsors.name HAVING COUNT(outcomes.id) > 10 ORDER BY COUNT(outcomes.id) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies)-[:HAS_OUTCOME]->(outcome:outcomes) WHERE study.phase = 'Phase 3' AND outcome.outcome_type = 'Primary' WITH sponsor, count(outcome) AS outcomeCount WHERE outcomeCount > 10 RETURN sponsor.name, outcomeCount ORDER BY outcomeCount DESC"
  },
  {
    "question": "Which conditions have total withdrawal count exceeding 100 across all their studies?",
    "sql": "SELECT conditions.mesh_term, SUM(drop_withdrawals.count) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN drop_withdrawals ON studies.nct_id = drop_withdrawals.nct_id GROUP BY conditions.condition_id, conditions.mesh_term HAVING SUM(drop_withdrawals.count) > 100 ORDER BY SUM(drop_withdrawals.count) DESC",
    "cypher": "MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies)<-[:HAS_CONDITION_RECORD]-(study:studies)-[:HAS_WITHDRAWAL]->(withdrawal:drop_withdrawals) WITH condition, sum(toInteger(withdrawal.count)) AS totalWithdrawals WHERE totalWithdrawals > 100 RETURN condition.mesh_term, totalWithdrawals ORDER BY totalWithdrawals DESC"
  },
  {
    "question": "Which interventions have more than 6 studies using ANCOVA or t-test for outcome analysis?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN outcomes ON studies.nct_id = outcomes.nct_id JOIN outcome_analyses ON outcomes.id = outcome_analyses.outcome_id WHERE outcome_analyses.method IN ('ANCOVA', 't-test') OR outcome_analyses.method LIKE '%t-test%' GROUP BY interventions.intervention_id, interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 6 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (intervention:interventions)<-[:FOR_INTERVENTION]-(is:interventions_studies)<-[:HAS_INTERVENTION_RECORD]-(study:studies)-[:HAS_OUTCOME]->(outcome:outcomes)-[:HAS_ANALYSIS]->(analysis:outcome_analyses) WHERE analysis.method = 'ANCOVA' OR analysis.method CONTAINS 't-test' WITH intervention, count(DISTINCT study) AS studyCount WHERE studyCount > 6 RETURN intervention.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which sponsors have average subjects at risk greater than 50 across their studies with reported events?",
    "sql": "SELECT sponsors.name, AVG(reported_event_totals.subjects_at_risk) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN reported_event_totals ON studies.nct_id = reported_event_totals.nct_id GROUP BY sponsors.sponsor_id, sponsors.name HAVING AVG(reported_event_totals.subjects_at_risk) > 50 ORDER BY AVG(reported_event_totals.subjects_at_risk) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies)-[:HAS_EVENT_TOTAL]->(event:reported_event_totals) WITH sponsor, avg(toInteger(event.subjects_at_risk)) AS avgSubjectsAtRisk WHERE avgSubjectsAtRisk > 50 RETURN sponsor.name, avgSubjectsAtRisk ORDER BY avgSubjectsAtRisk DESC"
  },
  {
    "question": "Which conditions have more than 5 studies with both primary and secondary outcomes?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN outcomes ON studies.nct_id = outcomes.nct_id WHERE outcomes.outcome_type IN ('Primary', 'Secondary') GROUP BY conditions.condition_id, conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 5 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies)<-[:HAS_CONDITION_RECORD]-(study:studies)-[:HAS_OUTCOME]->(outcome:outcomes) WHERE outcome.outcome_type IN ['Primary', 'Secondary'] WITH condition, count(DISTINCT study) AS studyCount WHERE studyCount > 5 RETURN condition.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which interventions have more than 3 Phase 2 or Phase 3 studies with death as a withdrawal reason?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN drop_withdrawals ON studies.nct_id = drop_withdrawals.nct_id WHERE (studies.phase = 'Phase 2' OR studies.phase = 'Phase 3') AND drop_withdrawals.reason = 'Death' GROUP BY interventions.intervention_id, interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 3 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (intervention:interventions)<-[:FOR_INTERVENTION]-(is:interventions_studies)<-[:HAS_INTERVENTION_RECORD]-(study:studies)-[:HAS_WITHDRAWAL]->(withdrawal:drop_withdrawals) WHERE (study.phase = 'Phase 2' OR study.phase = 'Phase 3') AND withdrawal.reason = 'Death' WITH intervention, count(DISTINCT study) AS studyCount WHERE studyCount > 3 RETURN intervention.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which sponsors have more than 8 studies with outcomes measured in weeks or months?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN outcomes ON studies.nct_id = outcomes.nct_id WHERE outcomes.time_frame LIKE '%week%' OR outcomes.time_frame LIKE '%month%' GROUP BY sponsors.sponsor_id, sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 8 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies)-[:HAS_OUTCOME]->(outcome:outcomes) WHERE outcome.time_frame CONTAINS 'week' OR outcome.time_frame CONTAINS 'month' WITH sponsor, count(DISTINCT study) AS studyCount WHERE studyCount > 8 RETURN sponsor.name, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which conditions have more than 4 studies with lost to follow-up withdrawals exceeding 3 participants?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN drop_withdrawals ON studies.nct_id = drop_withdrawals.nct_id WHERE drop_withdrawals.reason = 'Lost to Follow-up' AND drop_withdrawals.count > 3 GROUP BY conditions.condition_id, conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 4 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies)<-[:HAS_CONDITION_RECORD]-(study:studies)-[:HAS_WITHDRAWAL]->(withdrawal:drop_withdrawals) WHERE withdrawal.reason = 'Lost to Follow-up' AND toInteger(withdrawal.count) > 3 WITH condition, count(DISTINCT study) AS studyCount WHERE studyCount > 4 RETURN condition.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which interventions have average confidence interval percent greater than 95 in outcome analyses?",
    "sql": "SELECT interventions.mesh_term, AVG(outcome_analyses.ci_percent) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN outcomes ON studies.nct_id = outcomes.nct_id JOIN outcome_analyses ON outcomes.id = outcome_analyses.outcome_id GROUP BY interventions.intervention_id, interventions.mesh_term HAVING AVG(outcome_analyses.ci_percent) > 95 ORDER BY AVG(outcome_analyses.ci_percent) DESC",
    "cypher": "MATCH (intervention:interventions)<-[:FOR_INTERVENTION]-(is:interventions_studies)<-[:HAS_INTERVENTION_RECORD]-(study:studies)-[:HAS_OUTCOME]->(outcome:outcomes)-[:HAS_ANALYSIS]->(analysis:outcome_analyses) WITH intervention, avg(toFloat(analysis.ci_percent)) AS avgCiPercent WHERE avgCiPercent > 95 RETURN intervention.mesh_term, avgCiPercent ORDER BY avgCiPercent DESC"
  },
  {
    "question": "Which sponsors have more than 6 FDA regulated studies with serious adverse events reported?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN reported_event_totals ON studies.nct_id = reported_event_totals.nct_id WHERE studies.is_fda_regulated_drug = 'Yes' AND reported_event_totals.event_type = 'Serious' GROUP BY sponsors.sponsor_id, sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 6 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies)-[:HAS_EVENT_TOTAL]->(event:reported_event_totals) WHERE study.is_fda_regulated_drug = 'Yes' AND event.event_type = 'Serious' WITH sponsor, count(DISTINCT study) AS studyCount WHERE studyCount > 6 RETURN sponsor.name, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which conditions have more than 10 outcome analyses using Chi-squared or Fisher's exact test?",
    "sql": "SELECT conditions.mesh_term, COUNT(outcome_analyses.id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN outcomes ON studies.nct_id = outcomes.nct_id JOIN outcome_analyses ON outcomes.id = outcome_analyses.outcome_id WHERE outcome_analyses.method LIKE '%Chi%' OR outcome_analyses.method LIKE '%Fisher%' GROUP BY conditions.condition_id, conditions.mesh_term HAVING COUNT(outcome_analyses.id) > 10 ORDER BY COUNT(outcome_analyses.id) DESC",
    "cypher": "MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies)<-[:HAS_CONDITION_RECORD]-(study:studies)-[:HAS_OUTCOME]->(outcome:outcomes)-[:HAS_ANALYSIS]->(analysis:outcome_analyses) WHERE analysis.method CONTAINS 'Chi' OR analysis.method CONTAINS 'Fisher' WITH condition, count(analysis) AS analysisCount WHERE analysisCount > 10 RETURN condition.mesh_term, analysisCount ORDER BY analysisCount DESC"
  },
  {
    "question": "Which interventions have total subjects affected by events exceeding 500 across Phase 3 studies?",
    "sql": "SELECT interventions.mesh_term, SUM(reported_event_totals.subjects_affected) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN reported_event_totals ON studies.nct_id = reported_event_totals.nct_id WHERE studies.phase = 'Phase 3' GROUP BY interventions.intervention_id, interventions.mesh_term HAVING SUM(reported_event_totals.subjects_affected) > 500 ORDER BY SUM(reported_event_totals.subjects_affected) DESC",
    "cypher": "MATCH (intervention:interventions)<-[:FOR_INTERVENTION]-(is:interventions_studies)<-[:HAS_INTERVENTION_RECORD]-(study:studies)-[:HAS_EVENT_TOTAL]->(event:reported_event_totals) WHERE study.phase = 'Phase 3' WITH intervention, sum(toInteger(event.subjects_affected)) AS totalAffected WHERE totalAffected > 500 RETURN intervention.mesh_term, totalAffected ORDER BY totalAffected DESC"
  },
  {
    "question": "Which sponsors have more than 4 studies with outcomes using mean as parameter type and enrollment over 100?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN outcomes ON studies.nct_id = outcomes.nct_id WHERE outcomes.param_type = 'Mean' AND studies.enrollment > 100 GROUP BY sponsors.sponsor_id, sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 4 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies)-[:HAS_OUTCOME]->(outcome:outcomes) WHERE outcome.param_type = 'Mean' AND toInteger(study.enrollment) > 100 WITH sponsor, count(DISTINCT study) AS studyCount WHERE studyCount > 4 RETURN sponsor.name, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which conditions have maximum withdrawal count greater than 50 in any single study?",
    "sql": "SELECT conditions.mesh_term, MAX(drop_withdrawals.count) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN drop_withdrawals ON studies.nct_id = drop_withdrawals.nct_id GROUP BY conditions.condition_id, conditions.mesh_term HAVING MAX(drop_withdrawals.count) > 50 ORDER BY MAX(drop_withdrawals.count) DESC",
    "cypher": "MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies)<-[:HAS_CONDITION_RECORD]-(study:studies)-[:HAS_WITHDRAWAL]->(withdrawal:drop_withdrawals) WITH condition, max(toInteger(withdrawal.count)) AS maxWithdrawal WHERE maxWithdrawal > 50 RETURN condition.mesh_term, maxWithdrawal ORDER BY maxWithdrawal DESC"
  },
  {
    "question": "Which interventions have more than 5 studies with protocol violation withdrawals?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN drop_withdrawals ON studies.nct_id = drop_withdrawals.nct_id WHERE drop_withdrawals.reason LIKE '%Protocol%' OR drop_withdrawals.reason LIKE '%protocol%' GROUP BY interventions.intervention_id, interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 5 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (intervention:interventions)<-[:FOR_INTERVENTION]-(is:interventions_studies)<-[:HAS_INTERVENTION_RECORD]-(study:studies)-[:HAS_WITHDRAWAL]->(withdrawal:drop_withdrawals) WHERE withdrawal.reason CONTAINS 'Protocol' OR withdrawal.reason CONTAINS 'protocol' WITH intervention, count(DISTINCT study) AS studyCount WHERE studyCount > 5 RETURN intervention.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which sponsors have more than 3 studies with both serious and other adverse events reported?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN reported_event_totals ON studies.nct_id = reported_event_totals.nct_id WHERE reported_event_totals.event_type IN ('Serious', 'Other') GROUP BY sponsors.sponsor_id, sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 3 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies)-[:HAS_EVENT_TOTAL]->(event:reported_event_totals) WHERE event.event_type IN ['Serious', 'Other'] WITH sponsor, count(DISTINCT study) AS studyCount WHERE studyCount > 3 RETURN sponsor.name, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which conditions have minimum p-value less than 0.01 in outcome analyses from Phase 3 studies?",
    "sql": "SELECT conditions.mesh_term, MIN(outcome_analyses.p_value) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN outcomes ON studies.nct_id = outcomes.nct_id JOIN outcome_analyses ON outcomes.id = outcome_analyses.outcome_id WHERE studies.phase = 'Phase 3' AND outcome_analyses.p_value > 0 GROUP BY conditions.condition_id, conditions.mesh_term HAVING MIN(outcome_analyses.p_value) < 0.01 ORDER BY MIN(outcome_analyses.p_value)",
    "cypher": "MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies)<-[:HAS_CONDITION_RECORD]-(study:studies)-[:HAS_OUTCOME]->(outcome:outcomes)-[:HAS_ANALYSIS]->(analysis:outcome_analyses) WHERE study.phase = 'Phase 3' AND toFloat(analysis.p_value) > 0 WITH condition, min(toFloat(analysis.p_value)) AS minPValue WHERE minPValue < 0.01 RETURN condition.mesh_term, minPValue ORDER BY minPValue"
  },
  {
    "question": "Which interventions have more than 7 studies with outcomes measured in percentage units?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN outcomes ON studies.nct_id = outcomes.nct_id WHERE outcomes.units LIKE '%percent%' OR outcomes.units = '%' GROUP BY interventions.intervention_id, interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 7 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (intervention:interventions)<-[:FOR_INTERVENTION]-(is:interventions_studies)<-[:HAS_INTERVENTION_RECORD]-(study:studies)-[:HAS_OUTCOME]->(outcome:outcomes) WHERE outcome.units CONTAINS 'percent' OR outcome.units = '%' WITH intervention, count(DISTINCT study) AS studyCount WHERE studyCount > 7 RETURN intervention.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which sponsors have total subjects at risk exceeding 1000 in their Phase 2 and Phase 3 studies?",
    "sql": "SELECT sponsors.name, SUM(reported_event_totals.subjects_at_risk) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN reported_event_totals ON studies.nct_id = reported_event_totals.nct_id WHERE studies.phase IN ('Phase 2', 'Phase 3') GROUP BY sponsors.sponsor_id, sponsors.name HAVING SUM(reported_event_totals.subjects_at_risk) > 1000 ORDER BY SUM(reported_event_totals.subjects_at_risk) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies)-[:HAS_EVENT_TOTAL]->(event:reported_event_totals) WHERE study.phase IN ['Phase 2', 'Phase 3'] WITH sponsor, sum(toInteger(event.subjects_at_risk)) AS totalSubjectsAtRisk WHERE totalSubjectsAtRisk > 1000 RETURN sponsor.name, totalSubjectsAtRisk ORDER BY totalSubjectsAtRisk DESC"
  },
  {
    "question": "Which conditions have more than 6 studies with withdrawals due to lack of efficacy in treatment trials?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id JOIN drop_withdrawals ON studies.nct_id = drop_withdrawals.nct_id WHERE designs.primary_purpose = 'Treatment' AND drop_withdrawals.reason = 'Lack of Efficacy' GROUP BY conditions.condition_id, conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 6 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies)<-[:HAS_CONDITION_RECORD]-(study:studies)-[:HAS_DESIGN]->(design:designs), (study)-[:HAS_WITHDRAWAL]->(withdrawal:drop_withdrawals) WHERE design.primary_purpose = 'Treatment' AND withdrawal.reason = 'Lack of Efficacy' WITH condition, count(DISTINCT study) AS studyCount WHERE studyCount > 6 RETURN condition.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which interventions have average number of outcomes greater than 5 per study?",
    "sql": "SELECT interventions.mesh_term, COUNT(outcomes.id), COUNT(DISTINCT studies.nct_id) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN outcomes ON studies.nct_id = outcomes.nct_id GROUP BY interventions.intervention_id, interventions.mesh_term HAVING COUNT(outcomes.id) / COUNT(DISTINCT studies.nct_id) > 5 ORDER BY COUNT(outcomes.id) DESC",
    "cypher": "MATCH (intervention:interventions)<-[:FOR_INTERVENTION]-(is:interventions_studies)<-[:HAS_INTERVENTION_RECORD]-(study:studies)-[:HAS_OUTCOME]->(outcome:outcomes) WITH intervention, count(outcome) AS outcomeCount, count(DISTINCT study) AS studyCount WHERE outcomeCount / studyCount > 5 RETURN intervention.mesh_term, outcomeCount, studyCount ORDER BY outcomeCount DESC"
  },
  {
    "question": "Which sponsors have more than 5 studies with outcomes assessor masked in Phase 3 trials?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE studies.phase = 'Phase 3' AND designs.outcomes_assessor_masked = 'Yes' GROUP BY sponsors.sponsor_id, sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 5 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies)-[:HAS_DESIGN]->(design:designs) WHERE study.phase = 'Phase 3' AND design.outcomes_assessor_masked = 'Yes' WITH sponsor, count(DISTINCT study) AS studyCount WHERE studyCount > 5 RETURN sponsor.name, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which facilities have hosted more than 5 studies with conditions related to diabetes and enrollment over 50?",
    "sql": "SELECT facilities.name, facilities.city, facilities.country, COUNT(DISTINCT studies.nct_id) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id JOIN conditions_studies ON studies.nct_id = conditions_studies.nct_id JOIN conditions ON conditions_studies.condition_id = conditions.condition_id WHERE conditions.mesh_term LIKE '%Diabetes%' AND studies.enrollment > 50 GROUP BY facilities.facility_id, facilities.name, facilities.city, facilities.country HAVING COUNT(DISTINCT studies.nct_id) > 5 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (facility:facilities)<-[:AT_FACILITY]-(fs:facilities_studies)<-[:HAS_FACILITY_RECORD]-(study:studies)-[:HAS_CONDITION_RECORD]->(cs:conditions_studies)-[:FOR_CONDITION]->(condition:conditions) WHERE condition.mesh_term CONTAINS 'Diabetes' AND toInteger(study.enrollment) > 50 WITH facility, count(DISTINCT study) AS studyCount WHERE studyCount > 5 RETURN facility.name, facility.city, facility.country, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which sponsors fund more than 3 studies at facilities in California with treatment purpose?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN facilities_studies ON studies.nct_id = facilities_studies.nct_id JOIN facilities ON facilities_studies.facility_id = facilities.facility_id JOIN designs ON studies.nct_id = designs.nct_id WHERE facilities.state = 'California' AND designs.primary_purpose = 'Treatment' GROUP BY sponsors.sponsor_id, sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 3 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies)-[:HAS_FACILITY_RECORD]->(fs:facilities_studies)-[:AT_FACILITY]->(facility:facilities), (study)-[:HAS_DESIGN]->(design:designs) WHERE facility.state = 'California' AND design.primary_purpose = 'Treatment' WITH sponsor, count(DISTINCT study) AS studyCount WHERE studyCount > 3 RETURN sponsor.name, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which interventions are used in more than 4 studies at facilities in Europe (Germany, France, UK, Italy, Spain)?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN facilities_studies ON studies.nct_id = facilities_studies.nct_id JOIN facilities ON facilities_studies.facility_id = facilities.facility_id WHERE facilities.country IN ('Germany', 'France', 'United Kingdom', 'Italy', 'Spain') GROUP BY interventions.intervention_id, interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 4 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (intervention:interventions)<-[:FOR_INTERVENTION]-(is:interventions_studies)<-[:HAS_INTERVENTION_RECORD]-(study:studies)-[:HAS_FACILITY_RECORD]->(fs:facilities_studies)-[:AT_FACILITY]->(facility:facilities) WHERE facility.country IN ['Germany', 'France', 'United Kingdom', 'Italy', 'Spain'] WITH intervention, count(DISTINCT study) AS studyCount WHERE studyCount > 4 RETURN intervention.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which conditions have more than 3 studies with facilities in both US and Europe?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN facilities_studies ON studies.nct_id = facilities_studies.nct_id JOIN facilities ON facilities_studies.facility_id = facilities.facility_id WHERE facilities.country = 'United States' OR facilities.country IN ('Germany', 'France', 'United Kingdom', 'Italy', 'Spain') GROUP BY conditions.condition_id, conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 3 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies)<-[:HAS_CONDITION_RECORD]-(study:studies)-[:HAS_FACILITY_RECORD]->(fs:facilities_studies)-[:AT_FACILITY]->(facility:facilities) WHERE facility.country = 'United States' OR facility.country IN ['Germany', 'France', 'United Kingdom', 'Italy', 'Spain'] WITH condition, count(DISTINCT study) AS studyCount WHERE studyCount > 3 RETURN condition.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which sponsors have average enrollment greater than 150 for studies with interventions containing 'vaccine'?",
    "sql": "SELECT sponsors.name, AVG(studies.enrollment) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN interventions_studies ON studies.nct_id = interventions_studies.nct_id JOIN interventions ON interventions_studies.intervention_id = interventions.intervention_id WHERE interventions.mesh_term LIKE '%Vaccine%' OR interventions.mesh_term LIKE '%vaccine%' GROUP BY sponsors.sponsor_id, sponsors.name HAVING AVG(studies.enrollment) > 150 ORDER BY AVG(studies.enrollment) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies)-[:HAS_INTERVENTION_RECORD]->(is:interventions_studies)-[:FOR_INTERVENTION]->(intervention:interventions) WHERE intervention.mesh_term CONTAINS 'Vaccine' OR intervention.mesh_term CONTAINS 'vaccine' WITH sponsor, avg(toInteger(study.enrollment)) AS avgEnrollment WHERE avgEnrollment > 150 RETURN sponsor.name, avgEnrollment ORDER BY avgEnrollment DESC"
  },
  {
    "question": "Which facilities have hosted more than 6 Phase 3 studies sponsored by industry?",
    "sql": "SELECT facilities.name, facilities.city, facilities.country, COUNT(DISTINCT studies.nct_id) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id JOIN sponsors_studies ON studies.nct_id = sponsors_studies.nct_id JOIN sponsors ON sponsors_studies.sponsor_id = sponsors.sponsor_id WHERE studies.phase = 'Phase 3' AND sponsors.agency_class = 'INDUSTRY' GROUP BY facilities.facility_id, facilities.name, facilities.city, facilities.country HAVING COUNT(DISTINCT studies.nct_id) > 6 ORDER BY COUNT(DISTINCT studies.nct_id) DESC LIMIT 50",
    "cypher": "MATCH (facility:facilities)<-[:AT_FACILITY]-(fs:facilities_studies)<-[:HAS_FACILITY_RECORD]-(study:studies)-[:HAS_SPONSOR_RECORD]->(ss:sponsors_studies)-[:BY_SPONSOR]->(sponsor:sponsors) WHERE study.phase = 'Phase 3' AND sponsor.agency_class = 'INDUSTRY' WITH facility, count(DISTINCT study) AS studyCount WHERE studyCount > 6 RETURN facility.name, facility.city, facility.country, studyCount ORDER BY studyCount DESC LIMIT 50"
  },
  {
    "question": "Which interventions have more than 5 studies with double-blind masking and randomized allocation in Phase 2?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE studies.phase = 'Phase 2' AND designs.masking = 'Double' AND designs.allocation = 'Randomized' GROUP BY interventions.intervention_id, interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 5 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (intervention:interventions)<-[:FOR_INTERVENTION]-(is:interventions_studies)<-[:HAS_INTERVENTION_RECORD]-(study:studies)-[:HAS_DESIGN]->(design:designs) WHERE study.phase = 'Phase 2' AND design.masking = 'Double' AND design.allocation = 'Randomized' WITH intervention, count(DISTINCT study) AS studyCount WHERE studyCount > 5 RETURN intervention.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which conditions have more than 4 studies at facilities in Texas with enrollment between 100 and 500?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN facilities_studies ON studies.nct_id = facilities_studies.nct_id JOIN facilities ON facilities_studies.facility_id = facilities.facility_id WHERE facilities.state = 'Texas' AND studies.enrollment BETWEEN 100 AND 500 GROUP BY conditions.condition_id, conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 4 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies)<-[:HAS_CONDITION_RECORD]-(study:studies)-[:HAS_FACILITY_RECORD]->(fs:facilities_studies)-[:AT_FACILITY]->(facility:facilities) WHERE facility.state = 'Texas' AND toInteger(study.enrollment) >= 100 AND toInteger(study.enrollment) <= 500 WITH condition, count(DISTINCT study) AS studyCount WHERE studyCount > 4 RETURN condition.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which sponsors have more than 8 studies with female-only eligibility and treatment purpose?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN eligibilities ON studies.nct_id = eligibilities.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE eligibilities.gender = 'Female' AND designs.primary_purpose = 'Treatment' GROUP BY sponsors.sponsor_id, sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 8 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies)-[:HAS_ELIGIBILITY]->(elig:eligibilities), (study)-[:HAS_DESIGN]->(design:designs) WHERE elig.gender = 'Female' AND design.primary_purpose = 'Treatment' WITH sponsor, count(DISTINCT study) AS studyCount WHERE studyCount > 8 RETURN sponsor.name, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which interventions have total enrollment exceeding 3000 in studies at US facilities?",
    "sql": "SELECT interventions.mesh_term, SUM(studies.enrollment) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN facilities_studies ON studies.nct_id = facilities_studies.nct_id JOIN facilities ON facilities_studies.facility_id = facilities.facility_id WHERE facilities.country = 'United States' GROUP BY interventions.intervention_id, interventions.mesh_term HAVING SUM(studies.enrollment) > 3000 ORDER BY SUM(studies.enrollment) DESC",
    "cypher": "MATCH (intervention:interventions)<-[:FOR_INTERVENTION]-(is:interventions_studies)<-[:HAS_INTERVENTION_RECORD]-(study:studies)-[:HAS_FACILITY_RECORD]->(fs:facilities_studies)-[:AT_FACILITY]->(facility:facilities) WHERE facility.country = 'United States' WITH intervention, sum(toInteger(study.enrollment)) AS totalEnrollment WHERE totalEnrollment > 3000 RETURN intervention.mesh_term, totalEnrollment ORDER BY totalEnrollment DESC"
  },
  {
    "question": "Which conditions have more than 3 studies with both adult and child eligibility sponsored by NIH?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN eligibilities ON studies.nct_id = eligibilities.nct_id JOIN sponsors_studies ON studies.nct_id = sponsors_studies.nct_id JOIN sponsors ON sponsors_studies.sponsor_id = sponsors.sponsor_id WHERE eligibilities.adult = 'Yes' AND eligibilities.child = 'Yes' AND sponsors.agency_class = 'NIH' GROUP BY conditions.condition_id, conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 3 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies)<-[:HAS_CONDITION_RECORD]-(study:studies)-[:HAS_ELIGIBILITY]->(elig:eligibilities), (study)-[:HAS_SPONSOR_RECORD]->(ss:sponsors_studies)-[:BY_SPONSOR]->(sponsor:sponsors) WHERE elig.adult = 'Yes' AND elig.child = 'Yes' AND sponsor.agency_class = 'NIH' WITH condition, count(DISTINCT study) AS studyCount WHERE studyCount > 3 RETURN condition.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which facilities have hosted studies with more than 3 different interventions and enrollment over 75?",
    "sql": "SELECT facilities.name, facilities.city, COUNT(DISTINCT interventions.intervention_id) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id JOIN interventions_studies ON studies.nct_id = interventions_studies.nct_id JOIN interventions ON interventions_studies.intervention_id = interventions.intervention_id WHERE studies.enrollment > 75 GROUP BY facilities.facility_id, facilities.name, facilities.city HAVING COUNT(DISTINCT interventions.intervention_id) > 3 ORDER BY COUNT(DISTINCT interventions.intervention_id) DESC LIMIT 50",
    "cypher": "MATCH (facility:facilities)<-[:AT_FACILITY]-(fs:facilities_studies)<-[:HAS_FACILITY_RECORD]-(study:studies)-[:HAS_INTERVENTION_RECORD]->(is:interventions_studies)-[:FOR_INTERVENTION]->(intervention:interventions) WHERE toInteger(study.enrollment) > 75 WITH facility, count(DISTINCT intervention) AS interventionCount WHERE interventionCount > 3 RETURN facility.name, facility.city, interventionCount ORDER BY interventionCount DESC LIMIT 50"
  },
  {
    "question": "Which sponsors fund more than 5 studies with primary outcomes measured in survival-related time frames?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN outcomes ON studies.nct_id = outcomes.nct_id WHERE outcomes.outcome_type = 'Primary' AND (outcomes.title LIKE '%survival%' OR outcomes.title LIKE '%Survival%') GROUP BY sponsors.sponsor_id, sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 5 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies)-[:HAS_OUTCOME]->(outcome:outcomes) WHERE outcome.outcome_type = 'Primary' AND (outcome.title CONTAINS 'survival' OR outcome.title CONTAINS 'Survival') WITH sponsor, count(DISTINCT study) AS studyCount WHERE studyCount > 5 RETURN sponsor.name, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which interventions have more than 4 studies in Japan or China with Phase 3 designation?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN facilities_studies ON studies.nct_id = facilities_studies.nct_id JOIN facilities ON facilities_studies.facility_id = facilities.facility_id WHERE facilities.country IN ('Japan', 'China') AND studies.phase = 'Phase 3' GROUP BY interventions.intervention_id, interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 4 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (intervention:interventions)<-[:FOR_INTERVENTION]-(is:interventions_studies)<-[:HAS_INTERVENTION_RECORD]-(study:studies)-[:HAS_FACILITY_RECORD]->(fs:facilities_studies)-[:AT_FACILITY]->(facility:facilities) WHERE facility.country IN ['Japan', 'China'] AND study.phase = 'Phase 3' WITH intervention, count(DISTINCT study) AS studyCount WHERE studyCount > 4 RETURN intervention.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which conditions have average number of arms greater than 2.5 in their treatment studies?",
    "sql": "SELECT conditions.mesh_term, AVG(studies.number_of_arms) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE designs.primary_purpose = 'Treatment' AND studies.number_of_arms IS NOT NULL GROUP BY conditions.condition_id, conditions.mesh_term HAVING AVG(studies.number_of_arms) > 2.5 ORDER BY AVG(studies.number_of_arms) DESC",
    "cypher": "MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies)<-[:HAS_CONDITION_RECORD]-(study:studies)-[:HAS_DESIGN]->(design:designs) WHERE design.primary_purpose = 'Treatment' AND study.number_of_arms <> '' WITH condition, avg(toFloat(study.number_of_arms)) AS avgArms WHERE avgArms > 2.5 RETURN condition.mesh_term, avgArms ORDER BY avgArms DESC"
  },
  {
    "question": "Which sponsors have more than 4 studies with caregiver masking in Phase 2 or Phase 3?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE (studies.phase = 'Phase 2' OR studies.phase = 'Phase 3') AND designs.caregiver_masked = 'Yes' GROUP BY sponsors.sponsor_id, sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 4 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies)-[:HAS_DESIGN]->(design:designs) WHERE (study.phase = 'Phase 2' OR study.phase = 'Phase 3') AND design.caregiver_masked = 'Yes' WITH sponsor, count(DISTINCT study) AS studyCount WHERE studyCount > 4 RETURN sponsor.name, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which facilities have more than 10 studies with conditions related to cancer or tumor?",
    "sql": "SELECT facilities.name, facilities.city, facilities.country, COUNT(DISTINCT studies.nct_id) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id JOIN conditions_studies ON studies.nct_id = conditions_studies.nct_id JOIN conditions ON conditions_studies.condition_id = conditions.condition_id WHERE conditions.mesh_term LIKE '%Cancer%' OR conditions.mesh_term LIKE '%Tumor%' OR conditions.mesh_term LIKE '%Neoplasm%' GROUP BY facilities.facility_id, facilities.name, facilities.city, facilities.country HAVING COUNT(DISTINCT studies.nct_id) > 10 ORDER BY COUNT(DISTINCT studies.nct_id) DESC LIMIT 50",
    "cypher": "MATCH (facility:facilities)<-[:AT_FACILITY]-(fs:facilities_studies)<-[:HAS_FACILITY_RECORD]-(study:studies)-[:HAS_CONDITION_RECORD]->(cs:conditions_studies)-[:FOR_CONDITION]->(condition:conditions) WHERE condition.mesh_term CONTAINS 'Cancer' OR condition.mesh_term CONTAINS 'Tumor' OR condition.mesh_term CONTAINS 'Neoplasm' WITH facility, count(DISTINCT study) AS studyCount WHERE studyCount > 10 RETURN facility.name, facility.city, facility.country, studyCount ORDER BY studyCount DESC LIMIT 50"
  },
  {
    "question": "Which interventions have more than 3 studies with both serious adverse events and death-related withdrawals?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN reported_event_totals ON studies.nct_id = reported_event_totals.nct_id JOIN drop_withdrawals ON studies.nct_id = drop_withdrawals.nct_id WHERE reported_event_totals.event_type = 'Serious' AND drop_withdrawals.reason = 'Death' GROUP BY interventions.intervention_id, interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 3 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (intervention:interventions)<-[:FOR_INTERVENTION]-(is:interventions_studies)<-[:HAS_INTERVENTION_RECORD]-(study:studies)-[:HAS_EVENT_TOTAL]->(event:reported_event_totals), (study)-[:HAS_WITHDRAWAL]->(withdrawal:drop_withdrawals) WHERE event.event_type = 'Serious' AND withdrawal.reason = 'Death' WITH intervention, count(DISTINCT study) AS studyCount WHERE studyCount > 3 RETURN intervention.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which sponsors have more than 6 studies at facilities with 'University' or 'Medical Center' in the name?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN facilities_studies ON studies.nct_id = facilities_studies.nct_id JOIN facilities ON facilities_studies.facility_id = facilities.facility_id WHERE facilities.name LIKE '%University%' OR facilities.name LIKE '%Medical Center%' GROUP BY sponsors.sponsor_id, sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 6 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies)-[:HAS_FACILITY_RECORD]->(fs:facilities_studies)-[:AT_FACILITY]->(facility:facilities) WHERE facility.name CONTAINS 'University' OR facility.name CONTAINS 'Medical Center' WITH sponsor, count(DISTINCT study) AS studyCount WHERE studyCount > 6 RETURN sponsor.name, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which conditions have more than 5 studies with crossover design and healthy volunteer acceptance?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id JOIN eligibilities ON studies.nct_id = eligibilities.nct_id WHERE designs.intervention_model = 'Crossover Assignment' AND eligibilities.healthy_volunteers = 'Yes' GROUP BY conditions.condition_id, conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 5 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies)<-[:HAS_CONDITION_RECORD]-(study:studies)-[:HAS_DESIGN]->(design:designs), (study)-[:HAS_ELIGIBILITY]->(elig:eligibilities) WHERE design.intervention_model = 'Crossover Assignment' AND elig.healthy_volunteers = 'Yes' WITH condition, count(DISTINCT study) AS studyCount WHERE studyCount > 5 RETURN condition.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which interventions have maximum enrollment greater than 1000 across all Phase 3 randomized studies?",
    "sql": "SELECT interventions.mesh_term, MAX(studies.enrollment) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE studies.phase = 'Phase 3' AND designs.allocation = 'Randomized' GROUP BY interventions.intervention_id, interventions.mesh_term HAVING MAX(studies.enrollment) > 1000 ORDER BY MAX(studies.enrollment) DESC",
    "cypher": "MATCH (intervention:interventions)<-[:FOR_INTERVENTION]-(is:interventions_studies)<-[:HAS_INTERVENTION_RECORD]-(study:studies)-[:HAS_DESIGN]->(design:designs) WHERE study.phase = 'Phase 3' AND design.allocation = 'Randomized' WITH intervention, max(toInteger(study.enrollment)) AS maxEnrollment WHERE maxEnrollment > 1000 RETURN intervention.mesh_term, maxEnrollment ORDER BY maxEnrollment DESC"
  },
  {
    "question": "Which sponsors have more than 7 studies with FDA regulated device designation and single group design?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE studies.is_fda_regulated_device = 'Yes' AND designs.intervention_model = 'Single Group Assignment' GROUP BY sponsors.sponsor_id, sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 7 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies)-[:HAS_DESIGN]->(design:designs) WHERE study.is_fda_regulated_device = 'Yes' AND design.intervention_model = 'Single Group Assignment' WITH sponsor, count(DISTINCT study) AS studyCount WHERE studyCount > 7 RETURN sponsor.name, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which conditions have total subjects at risk exceeding 2000 across all their Phase 2 and Phase 3 studies?",
    "sql": "SELECT conditions.mesh_term, SUM(reported_event_totals.subjects_at_risk) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN reported_event_totals ON studies.nct_id = reported_event_totals.nct_id WHERE studies.phase IN ('Phase 2', 'Phase 3') GROUP BY conditions.condition_id, conditions.mesh_term HAVING SUM(reported_event_totals.subjects_at_risk) > 2000 ORDER BY SUM(reported_event_totals.subjects_at_risk) DESC",
    "cypher": "MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies)<-[:HAS_CONDITION_RECORD]-(study:studies)-[:HAS_EVENT_TOTAL]->(event:reported_event_totals) WHERE study.phase IN ['Phase 2', 'Phase 3'] WITH condition, sum(toInteger(event.subjects_at_risk)) AS totalSubjectsAtRisk WHERE totalSubjectsAtRisk > 2000 RETURN condition.mesh_term, totalSubjectsAtRisk ORDER BY totalSubjectsAtRisk DESC"
  },
  {
    "question": "Which facilities have more than 8 studies with lead sponsors from industry and randomized allocation?",
    "sql": "SELECT facilities.name, facilities.city, facilities.country, COUNT(DISTINCT studies.nct_id) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id JOIN sponsors_studies ON studies.nct_id = sponsors_studies.nct_id JOIN sponsors ON sponsors_studies.sponsor_id = sponsors.sponsor_id JOIN designs ON studies.nct_id = designs.nct_id WHERE sponsors.agency_class = 'INDUSTRY' AND sponsors_studies.lead_or_collaborator = 'Lead' AND designs.allocation = 'Randomized' GROUP BY facilities.facility_id, facilities.name, facilities.city, facilities.country HAVING COUNT(DISTINCT studies.nct_id) > 8 ORDER BY COUNT(DISTINCT studies.nct_id) DESC LIMIT 50",
    "cypher": "MATCH (facility:facilities)<-[:AT_FACILITY]-(fs:facilities_studies)<-[:HAS_FACILITY_RECORD]-(study:studies)-[:HAS_SPONSOR_RECORD]->(ss:sponsors_studies)-[:BY_SPONSOR]->(sponsor:sponsors), (study)-[:HAS_DESIGN]->(design:designs) WHERE sponsor.agency_class = 'INDUSTRY' AND ss.lead_or_collaborator = 'Lead' AND design.allocation = 'Randomized' WITH facility, count(DISTINCT study) AS studyCount WHERE studyCount > 8 RETURN facility.name, facility.city, facility.country, studyCount ORDER BY studyCount DESC LIMIT 50"
  },
  {
    "question": "Which interventions have more than 5 studies with retrospective time perspective in observational designs?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE studies.study_type = 'Observational' AND designs.time_perspective = 'Retrospective' GROUP BY interventions.intervention_id, interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 5 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (intervention:interventions)<-[:FOR_INTERVENTION]-(is:interventions_studies)<-[:HAS_INTERVENTION_RECORD]-(study:studies)-[:HAS_DESIGN]->(design:designs) WHERE study.study_type = 'Observational' AND design.time_perspective = 'Retrospective' WITH intervention, count(DISTINCT study) AS studyCount WHERE studyCount > 5 RETURN intervention.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which sponsors have more studies than the average number of studies per sponsor for Phase 3 trials?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id WHERE studies.phase = 'Phase 3' GROUP BY sponsors.sponsor_id, sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > (SELECT AVG(study_count) FROM (SELECT COUNT(DISTINCT studies.nct_id) AS study_count FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id WHERE studies.phase = 'Phase 3' GROUP BY sponsors.sponsor_id)) ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies) WHERE study.phase = 'Phase 3' WITH sponsor, count(DISTINCT study) AS studyCount WITH collect({sponsor: sponsor, count: studyCount}) AS sponsorData, avg(studyCount) AS avgCount UNWIND sponsorData AS item WITH item.sponsor AS sponsor, item.count AS studyCount, avgCount WHERE studyCount > avgCount RETURN sponsor.name, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which conditions have enrollment greater than the median enrollment across all interventional studies?",
    "sql": "SELECT conditions.mesh_term, AVG(studies.enrollment) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id WHERE studies.study_type = 'Interventional' AND studies.enrollment > (SELECT AVG(studies.enrollment) FROM studies WHERE studies.study_type = 'Interventional') GROUP BY conditions.condition_id, conditions.mesh_term HAVING AVG(studies.enrollment) > 100 ORDER BY AVG(studies.enrollment) DESC",
    "cypher": "MATCH (study:studies) WHERE study.study_type = 'Interventional' WITH avg(toInteger(study.enrollment)) AS avgEnrollment MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies)<-[:HAS_CONDITION_RECORD]-(study:studies) WHERE study.study_type = 'Interventional' AND toInteger(study.enrollment) > avgEnrollment WITH condition, avg(toInteger(study.enrollment)) AS condAvgEnrollment WHERE condAvgEnrollment > 100 RETURN condition.mesh_term, condAvgEnrollment ORDER BY condAvgEnrollment DESC"
  },
  {
    "question": "Which interventions are used in more studies than the average intervention across Phase 2 trials?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id WHERE studies.phase = 'Phase 2' GROUP BY interventions.intervention_id, interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > (SELECT AVG(int_count) FROM (SELECT COUNT(DISTINCT studies.nct_id) AS int_count FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id WHERE studies.phase = 'Phase 2' GROUP BY interventions.intervention_id)) ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (intervention:interventions)<-[:FOR_INTERVENTION]-(is:interventions_studies)<-[:HAS_INTERVENTION_RECORD]-(study:studies) WHERE study.phase = 'Phase 2' WITH intervention, count(DISTINCT study) AS studyCount WITH collect({intervention: intervention, count: studyCount}) AS intData, avg(studyCount) AS avgCount UNWIND intData AS item WITH item.intervention AS intervention, item.count AS studyCount, avgCount WHERE studyCount > avgCount RETURN intervention.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which sponsors have more than 5 studies with conditions that have at least 10 total studies in the database?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN conditions_studies ON studies.nct_id = conditions_studies.nct_id JOIN conditions ON conditions_studies.condition_id = conditions.condition_id WHERE conditions.condition_id IN (SELECT conditions_studies.condition_id FROM conditions_studies GROUP BY conditions_studies.condition_id HAVING COUNT(DISTINCT conditions_studies.nct_id) >= 10) GROUP BY sponsors.sponsor_id, sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 5 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies) WITH condition, count(DISTINCT cs.nct_id) AS condStudyCount WHERE condStudyCount >= 10 WITH collect(condition) AS popularConditions MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies)-[:HAS_CONDITION_RECORD]->(cs2:conditions_studies)-[:FOR_CONDITION]->(cond:conditions) WHERE cond IN popularConditions WITH sponsor, count(DISTINCT study) AS studyCount WHERE studyCount > 5 RETURN sponsor.name, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which facilities host more studies than the average facility in their respective country?",
    "sql": "SELECT facilities.name, facilities.city, facilities.country, COUNT(DISTINCT facilities_studies.nct_id) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id GROUP BY facilities.facility_id, facilities.name, facilities.city, facilities.country HAVING COUNT(DISTINCT facilities_studies.nct_id) > (SELECT AVG(fac_count) FROM (SELECT COUNT(DISTINCT facilities_studies.nct_id) AS fac_count FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id GROUP BY facilities.facility_id)) ORDER BY COUNT(DISTINCT facilities_studies.nct_id) DESC LIMIT 50",
    "cypher": "MATCH (facility:facilities)<-[:AT_FACILITY]-(fs:facilities_studies) WITH facility, count(DISTINCT fs.nct_id) AS studyCount WITH collect({facility: facility, count: studyCount}) AS facData, avg(studyCount) AS avgCount UNWIND facData AS item WITH item.facility AS facility, item.count AS studyCount, avgCount WHERE studyCount > avgCount RETURN facility.name, facility.city, facility.country, studyCount ORDER BY studyCount DESC LIMIT 50"
  },
  {
    "question": "Which conditions have more primary outcomes than the average number of primary outcomes per condition?",
    "sql": "SELECT conditions.mesh_term, COUNT(outcomes.id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN outcomes ON studies.nct_id = outcomes.nct_id WHERE outcomes.outcome_type = 'Primary' GROUP BY conditions.condition_id, conditions.mesh_term HAVING COUNT(outcomes.id) > (SELECT AVG(outcome_count) FROM (SELECT COUNT(outcomes.id) AS outcome_count FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN outcomes ON studies.nct_id = outcomes.nct_id WHERE outcomes.outcome_type = 'Primary' GROUP BY conditions.condition_id)) ORDER BY COUNT(outcomes.id) DESC",
    "cypher": "MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies)<-[:HAS_CONDITION_RECORD]-(study:studies)-[:HAS_OUTCOME]->(outcome:outcomes) WHERE outcome.outcome_type = 'Primary' WITH condition, count(outcome) AS outcomeCount WITH collect({condition: condition, count: outcomeCount}) AS condData, avg(outcomeCount) AS avgCount UNWIND condData AS item WITH item.condition AS condition, item.count AS outcomeCount, avgCount WHERE outcomeCount > avgCount RETURN condition.mesh_term, outcomeCount ORDER BY outcomeCount DESC"
  },
  {
    "question": "Which sponsors fund studies at facilities in more than 5 different countries with Phase 3 trials?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT facilities.country) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN facilities_studies ON studies.nct_id = facilities_studies.nct_id JOIN facilities ON facilities_studies.facility_id = facilities.facility_id WHERE studies.phase = 'Phase 3' GROUP BY sponsors.sponsor_id, sponsors.name HAVING COUNT(DISTINCT facilities.country) > 5 ORDER BY COUNT(DISTINCT facilities.country) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies)-[:HAS_FACILITY_RECORD]->(fs:facilities_studies)-[:AT_FACILITY]->(facility:facilities) WHERE study.phase = 'Phase 3' WITH sponsor, count(DISTINCT facility.country) AS countryCount WHERE countryCount > 5 RETURN sponsor.name, countryCount ORDER BY countryCount DESC"
  },
  {
    "question": "Which interventions have withdrawal rates higher than the overall average withdrawal rate?",
    "sql": "SELECT interventions.mesh_term, SUM(drop_withdrawals.count), SUM(studies.enrollment) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN drop_withdrawals ON studies.nct_id = drop_withdrawals.nct_id GROUP BY interventions.intervention_id, interventions.mesh_term HAVING SUM(drop_withdrawals.count) / SUM(studies.enrollment) > (SELECT SUM(drop_withdrawals.count) / SUM(studies.enrollment) FROM studies JOIN drop_withdrawals ON studies.nct_id = drop_withdrawals.nct_id) ORDER BY SUM(drop_withdrawals.count) DESC LIMIT 50",
    "cypher": "MATCH (study:studies)-[:HAS_WITHDRAWAL]->(withdrawal:drop_withdrawals) WITH sum(toInteger(withdrawal.count)) AS totalWithdrawals, sum(toInteger(study.enrollment)) AS totalEnrollment WITH toFloat(totalWithdrawals) / totalEnrollment AS overallRate MATCH (intervention:interventions)<-[:FOR_INTERVENTION]-(is:interventions_studies)<-[:HAS_INTERVENTION_RECORD]-(study:studies)-[:HAS_WITHDRAWAL]->(withdrawal:drop_withdrawals) WITH intervention, sum(toInteger(withdrawal.count)) AS intWithdrawals, sum(toInteger(study.enrollment)) AS intEnrollment, overallRate WITH intervention, intWithdrawals, intEnrollment, toFloat(intWithdrawals) / intEnrollment AS intRate, overallRate WHERE intRate > overallRate RETURN intervention.mesh_term, intWithdrawals, intEnrollment ORDER BY intWithdrawals DESC LIMIT 50"
  },
  {
    "question": "Which conditions are studied at more facilities than the average condition?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT facilities.facility_id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN facilities_studies ON studies.nct_id = facilities_studies.nct_id JOIN facilities ON facilities_studies.facility_id = facilities.facility_id GROUP BY conditions.condition_id, conditions.mesh_term HAVING COUNT(DISTINCT facilities.facility_id) > (SELECT AVG(fac_count) FROM (SELECT COUNT(DISTINCT facilities.facility_id) AS fac_count FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN facilities_studies ON studies.nct_id = facilities_studies.nct_id JOIN facilities ON facilities_studies.facility_id = facilities.facility_id GROUP BY conditions.condition_id)) ORDER BY COUNT(DISTINCT facilities.facility_id) DESC",
    "cypher": "MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies)<-[:HAS_CONDITION_RECORD]-(study:studies)-[:HAS_FACILITY_RECORD]->(fs:facilities_studies)-[:AT_FACILITY]->(facility:facilities) WITH condition, count(DISTINCT facility) AS facilityCount WITH collect({condition: condition, count: facilityCount}) AS condData, avg(facilityCount) AS avgCount UNWIND condData AS item WITH item.condition AS condition, item.count AS facilityCount, avgCount WHERE facilityCount > avgCount RETURN condition.mesh_term, facilityCount ORDER BY facilityCount DESC"
  },
  {
    "question": "Which sponsors have more than 4 studies with outcomes having statistically significant results and treatment purpose?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id JOIN outcomes ON studies.nct_id = outcomes.nct_id JOIN outcome_analyses ON outcomes.id = outcome_analyses.outcome_id WHERE designs.primary_purpose = 'Treatment' AND outcome_analyses.p_value < 0.05 AND outcome_analyses.p_value > 0 GROUP BY sponsors.sponsor_id, sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 4 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies)-[:HAS_DESIGN]->(design:designs), (study)-[:HAS_OUTCOME]->(outcome:outcomes)-[:HAS_ANALYSIS]->(analysis:outcome_analyses) WHERE design.primary_purpose = 'Treatment' AND toFloat(analysis.p_value) < 0.05 AND toFloat(analysis.p_value) > 0 WITH sponsor, count(DISTINCT study) AS studyCount WHERE studyCount > 4 RETURN sponsor.name, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which conditions have more adverse events reported than the average across all conditions in Phase 3?",
    "sql": "SELECT conditions.mesh_term, COUNT(reported_event_totals.id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN reported_event_totals ON studies.nct_id = reported_event_totals.nct_id WHERE studies.phase = 'Phase 3' GROUP BY conditions.condition_id, conditions.mesh_term HAVING COUNT(reported_event_totals.id) > (SELECT AVG(event_count) FROM (SELECT COUNT(reported_event_totals.id) AS event_count FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN reported_event_totals ON studies.nct_id = reported_event_totals.nct_id WHERE studies.phase = 'Phase 3' GROUP BY conditions.condition_id)) ORDER BY COUNT(reported_event_totals.id) DESC",
    "cypher": "MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies)<-[:HAS_CONDITION_RECORD]-(study:studies)-[:HAS_EVENT_TOTAL]->(event:reported_event_totals) WHERE study.phase = 'Phase 3' WITH condition, count(event) AS eventCount WITH collect({condition: condition, count: eventCount}) AS condData, avg(eventCount) AS avgCount UNWIND condData AS item WITH item.condition AS condition, item.count AS eventCount, avgCount WHERE eventCount > avgCount RETURN condition.mesh_term, eventCount ORDER BY eventCount DESC"
  },
  {
    "question": "Which interventions have more than 6 studies with both investigator and outcomes assessor masking?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE designs.investigator_masked = 'Yes' AND designs.outcomes_assessor_masked = 'Yes' GROUP BY interventions.intervention_id, interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 6 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (intervention:interventions)<-[:FOR_INTERVENTION]-(is:interventions_studies)<-[:HAS_INTERVENTION_RECORD]-(study:studies)-[:HAS_DESIGN]->(design:designs) WHERE design.investigator_masked = 'Yes' AND design.outcomes_assessor_masked = 'Yes' WITH intervention, count(DISTINCT study) AS studyCount WHERE studyCount > 6 RETURN intervention.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which sponsors have studies at more than 10 unique facilities across multiple countries with enrollment over 100?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT facilities.facility_id), COUNT(DISTINCT facilities.country) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN facilities_studies ON studies.nct_id = facilities_studies.nct_id JOIN facilities ON facilities_studies.facility_id = facilities.facility_id WHERE studies.enrollment > 100 GROUP BY sponsors.sponsor_id, sponsors.name HAVING COUNT(DISTINCT facilities.facility_id) > 10 AND COUNT(DISTINCT facilities.country) > 1 ORDER BY COUNT(DISTINCT facilities.facility_id) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies)-[:HAS_FACILITY_RECORD]->(fs:facilities_studies)-[:AT_FACILITY]->(facility:facilities) WHERE toInteger(study.enrollment) > 100 WITH sponsor, count(DISTINCT facility) AS facilityCount, count(DISTINCT facility.country) AS countryCount WHERE facilityCount > 10 AND countryCount > 1 RETURN sponsor.name, facilityCount, countryCount ORDER BY facilityCount DESC"
  },
  {
    "question": "Which conditions have more than 3 studies with interventions tested at facilities in Asia (Japan, China, South Korea, India)?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN interventions_studies ON studies.nct_id = interventions_studies.nct_id JOIN facilities_studies ON studies.nct_id = facilities_studies.nct_id JOIN facilities ON facilities_studies.facility_id = facilities.facility_id WHERE facilities.country IN ('Japan', 'China', 'South Korea', 'India') GROUP BY conditions.condition_id, conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 3 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies)<-[:HAS_CONDITION_RECORD]-(study:studies)-[:HAS_INTERVENTION_RECORD]->(is:interventions_studies), (study)-[:HAS_FACILITY_RECORD]->(fs:facilities_studies)-[:AT_FACILITY]->(facility:facilities) WHERE facility.country IN ['Japan', 'China', 'South Korea', 'India'] WITH condition, count(DISTINCT study) AS studyCount WHERE studyCount > 3 RETURN condition.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which interventions have total enrollment exceeding the average total enrollment per intervention in FDA regulated studies?",
    "sql": "SELECT interventions.mesh_term, SUM(studies.enrollment) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id WHERE studies.is_fda_regulated_drug = 'Yes' GROUP BY interventions.intervention_id, interventions.mesh_term HAVING SUM(studies.enrollment) > (SELECT AVG(total_enroll) FROM (SELECT SUM(studies.enrollment) AS total_enroll FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id WHERE studies.is_fda_regulated_drug = 'Yes' GROUP BY interventions.intervention_id)) ORDER BY SUM(studies.enrollment) DESC",
    "cypher": "MATCH (intervention:interventions)<-[:FOR_INTERVENTION]-(is:interventions_studies)<-[:HAS_INTERVENTION_RECORD]-(study:studies) WHERE study.is_fda_regulated_drug = 'Yes' WITH intervention, sum(toInteger(study.enrollment)) AS totalEnrollment WITH collect({intervention: intervention, enrollment: totalEnrollment}) AS intData, avg(totalEnrollment) AS avgEnrollment UNWIND intData AS item WITH item.intervention AS intervention, item.enrollment AS totalEnrollment, avgEnrollment WHERE totalEnrollment > avgEnrollment RETURN intervention.mesh_term, totalEnrollment ORDER BY totalEnrollment DESC"
  },
  {
    "question": "Which sponsors have more than 5 studies with quadruple masking and enrollment between 100 and 1000?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE designs.masking = 'Quadruple' AND studies.enrollment BETWEEN 100 AND 1000 GROUP BY sponsors.sponsor_id, sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 5 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies)-[:HAS_DESIGN]->(design:designs) WHERE design.masking = 'Quadruple' AND toInteger(study.enrollment) >= 100 AND toInteger(study.enrollment) <= 1000 WITH sponsor, count(DISTINCT study) AS studyCount WHERE studyCount > 5 RETURN sponsor.name, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which conditions have studies at facilities in more than 3 US states with randomized treatment trials?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT facilities.state) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id JOIN facilities_studies ON studies.nct_id = facilities_studies.nct_id JOIN facilities ON facilities_studies.facility_id = facilities.facility_id WHERE facilities.country = 'United States' AND designs.allocation = 'Randomized' AND designs.primary_purpose = 'Treatment' GROUP BY conditions.condition_id, conditions.mesh_term HAVING COUNT(DISTINCT facilities.state) > 3 ORDER BY COUNT(DISTINCT facilities.state) DESC",
    "cypher": "MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies)<-[:HAS_CONDITION_RECORD]-(study:studies)-[:HAS_DESIGN]->(design:designs), (study)-[:HAS_FACILITY_RECORD]->(fs:facilities_studies)-[:AT_FACILITY]->(facility:facilities) WHERE facility.country = 'United States' AND design.allocation = 'Randomized' AND design.primary_purpose = 'Treatment' WITH condition, count(DISTINCT facility.state) AS stateCount WHERE stateCount > 3 RETURN condition.mesh_term, stateCount ORDER BY stateCount DESC"
  },
  {
    "question": "Which interventions have more than 4 studies with withdrawals greater than the average withdrawal count per study?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN drop_withdrawals ON studies.nct_id = drop_withdrawals.nct_id WHERE drop_withdrawals.count > (SELECT AVG(drop_withdrawals.count) FROM drop_withdrawals) GROUP BY interventions.intervention_id, interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 4 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (withdrawal:drop_withdrawals) WITH avg(toInteger(withdrawal.count)) AS avgWithdrawal MATCH (intervention:interventions)<-[:FOR_INTERVENTION]-(is:interventions_studies)<-[:HAS_INTERVENTION_RECORD]-(study:studies)-[:HAS_WITHDRAWAL]->(w:drop_withdrawals) WHERE toInteger(w.count) > avgWithdrawal WITH intervention, count(DISTINCT study) AS studyCount WHERE studyCount > 4 RETURN intervention.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which sponsors have more studies with primary outcomes than secondary outcomes across their portfolio?",
    "sql": "SELECT sponsors.name, SUM(CASE WHEN outcomes.outcome_type = 'Primary' THEN 1 ELSE 0 END), SUM(CASE WHEN outcomes.outcome_type = 'Secondary' THEN 1 ELSE 0 END) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN outcomes ON studies.nct_id = outcomes.nct_id GROUP BY sponsors.sponsor_id, sponsors.name HAVING SUM(CASE WHEN outcomes.outcome_type = 'Primary' THEN 1 ELSE 0 END) > SUM(CASE WHEN outcomes.outcome_type = 'Secondary' THEN 1 ELSE 0 END) AND SUM(CASE WHEN outcomes.outcome_type = 'Primary' THEN 1 ELSE 0 END) > 5 ORDER BY SUM(CASE WHEN outcomes.outcome_type = 'Primary' THEN 1 ELSE 0 END) DESC",
    "cypher": "MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies)-[:HAS_OUTCOME]->(outcome:outcomes) WITH sponsor, sum(CASE WHEN outcome.outcome_type = 'Primary' THEN 1 ELSE 0 END) AS primaryCount, sum(CASE WHEN outcome.outcome_type = 'Secondary' THEN 1 ELSE 0 END) AS secondaryCount WHERE primaryCount > secondaryCount AND primaryCount > 5 RETURN sponsor.name, primaryCount, secondaryCount ORDER BY primaryCount DESC"
  },
  {
    "question": "Which conditions have more than 6 studies with both open label design and FDA regulated drug designation?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE designs.masking = 'None (Open Label)' AND studies.is_fda_regulated_drug = 'Yes' GROUP BY conditions.condition_id, conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 6 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies)<-[:HAS_CONDITION_RECORD]-(study:studies)-[:HAS_DESIGN]->(design:designs) WHERE design.masking = 'None (Open Label)' AND study.is_fda_regulated_drug = 'Yes' WITH condition, count(DISTINCT study) AS studyCount WHERE studyCount > 6 RETURN condition.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which facilities have hosted more than 5 studies sponsored by pharmaceutical companies with Phase 3 designation?",
    "sql": "SELECT facilities.name, facilities.city, facilities.country, COUNT(DISTINCT studies.nct_id) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id JOIN sponsors_studies ON studies.nct_id = sponsors_studies.nct_id JOIN sponsors ON sponsors_studies.sponsor_id = sponsors.sponsor_id WHERE studies.phase = 'Phase 3' AND sponsors.name LIKE '%Pharma%' GROUP BY facilities.facility_id, facilities.name, facilities.city, facilities.country HAVING COUNT(DISTINCT studies.nct_id) > 5 ORDER BY COUNT(DISTINCT studies.nct_id) DESC LIMIT 50",
    "cypher": "MATCH (facility:facilities)<-[:AT_FACILITY]-(fs:facilities_studies)<-[:HAS_FACILITY_RECORD]-(study:studies)-[:HAS_SPONSOR_RECORD]->(ss:sponsors_studies)-[:BY_SPONSOR]->(sponsor:sponsors) WHERE study.phase = 'Phase 3' AND sponsor.name CONTAINS 'Pharma' WITH facility, count(DISTINCT study) AS studyCount WHERE studyCount > 5 RETURN facility.name, facility.city, facility.country, studyCount ORDER BY studyCount DESC LIMIT 50"
  },
  {
    "question": "Which interventions have more than 3 studies with both serious adverse events and p-value less than 0.05?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN reported_event_totals ON studies.nct_id = reported_event_totals.nct_id JOIN outcomes ON studies.nct_id = outcomes.nct_id JOIN outcome_analyses ON outcomes.id = outcome_analyses.outcome_id WHERE reported_event_totals.event_type = 'Serious' AND outcome_analyses.p_value < 0.05 AND outcome_analyses.p_value > 0 GROUP BY interventions.intervention_id, interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 3 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (intervention:interventions)<-[:FOR_INTERVENTION]-(is:interventions_studies)<-[:HAS_INTERVENTION_RECORD]-(study:studies)-[:HAS_EVENT_TOTAL]->(event:reported_event_totals), (study)-[:HAS_OUTCOME]->(outcome:outcomes)-[:HAS_ANALYSIS]->(analysis:outcome_analyses) WHERE event.event_type = 'Serious' AND toFloat(analysis.p_value) < 0.05 AND toFloat(analysis.p_value) > 0 WITH intervention, count(DISTINCT study) AS studyCount WHERE studyCount > 3 RETURN intervention.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which sponsors have average subjects at risk greater than the overall average across all their Phase 2 and Phase 3 studies?",
    "sql": "SELECT sponsors.name, AVG(reported_event_totals.subjects_at_risk) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN reported_event_totals ON studies.nct_id = reported_event_totals.nct_id WHERE studies.phase IN ('Phase 2', 'Phase 3') GROUP BY sponsors.sponsor_id, sponsors.name HAVING AVG(reported_event_totals.subjects_at_risk) > (SELECT AVG(reported_event_totals.subjects_at_risk) FROM studies JOIN reported_event_totals ON studies.nct_id = reported_event_totals.nct_id WHERE studies.phase IN ('Phase 2', 'Phase 3')) ORDER BY AVG(reported_event_totals.subjects_at_risk) DESC",
    "cypher": "MATCH (study:studies)-[:HAS_EVENT_TOTAL]->(event:reported_event_totals) WHERE study.phase IN ['Phase 2', 'Phase 3'] WITH avg(toInteger(event.subjects_at_risk)) AS overallAvg MATCH (sponsor:sponsors)<-[:BY_SPONSOR]-(ss:sponsors_studies)<-[:HAS_SPONSOR_RECORD]-(study:studies)-[:HAS_EVENT_TOTAL]->(event:reported_event_totals) WHERE study.phase IN ['Phase 2', 'Phase 3'] WITH sponsor, avg(toInteger(event.subjects_at_risk)) AS sponsorAvg, overallAvg WHERE sponsorAvg > overallAvg RETURN sponsor.name, sponsorAvg ORDER BY sponsorAvg DESC"
  },
  {
    "question": "Which conditions have more than 8 studies with sequential intervention model and open label masking in treatment trials?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE designs.intervention_model = 'Sequential Assignment' AND designs.masking = 'None (Open Label)' AND designs.primary_purpose = 'Treatment' GROUP BY conditions.condition_id, conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 8 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (condition:conditions)<-[:FOR_CONDITION]-(cs:conditions_studies)<-[:HAS_CONDITION_RECORD]-(study:studies)-[:HAS_DESIGN]->(design:designs) WHERE design.intervention_model = 'Sequential Assignment' AND design.masking = 'None (Open Label)' AND design.primary_purpose = 'Treatment' WITH condition, count(DISTINCT study) AS studyCount WHERE studyCount > 8 RETURN condition.mesh_term, studyCount ORDER BY studyCount DESC"
  },
  {
    "question": "Which interventions have more than 5 studies with facilities in both North America and Europe?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN facilities_studies ON studies.nct_id = facilities_studies.nct_id JOIN facilities ON facilities_studies.facility_id = facilities.facility_id WHERE facilities.country IN ('United States', 'Canada', 'Germany', 'France', 'United Kingdom', 'Italy', 'Spain', 'Netherlands') GROUP BY interventions.intervention_id, interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 5 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (intervention:interventions)<-[:FOR_INTERVENTION]-(is:interventions_studies)<-[:HAS_INTERVENTION_RECORD]-(study:studies)-[:HAS_FACILITY_RECORD]->(fs:facilities_studies)-[:AT_FACILITY]->(facility:facilities) WHERE facility.country IN ['United States', 'Canada', 'Germany', 'France', 'United Kingdom', 'Italy', 'Spain', 'Netherlands'] WITH intervention, count(DISTINCT study) AS studyCount WHERE studyCount > 5 RETURN intervention.mesh_term, studyCount ORDER BY studyCount DESC"
  }
]