[
  {
    "question": "Which sponsors fund more than 10 Phase 3 studies about cancer?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN conditions_studies ON studies.nct_id = conditions_studies.nct_id JOIN conditions ON conditions_studies.condition_id = conditions.condition_id WHERE studies.phase = 'Phase 3' AND conditions.mesh_term LIKE '%Cancer%' GROUP BY sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 10 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsors)<-[BY_SPONSOR]-(sponsors_studies)<-[HAS_SPONSOR_RECORD]-(studies)-[HAS_CONDITION_RECORD]->(conditions_studies)-[FOR_CONDITION]->(conditions) WHERE studies.phase = 'Phase 3' AND conditions.mesh_term CONTAINS 'Cancer' WITH sponsors.name AS sponsor_name, COUNT(DISTINCT studies) AS study_count WHERE study_count > 10 RETURN sponsor_name, study_count ORDER BY study_count DESC"
  },
  {
    "question": "What are the top 5 conditions with the highest average enrollment in randomized controlled trials?",
    "sql": "SELECT conditions.mesh_term, AVG(studies.enrollment), COUNT(DISTINCT studies.nct_id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE designs.allocation = 'Randomized' AND studies.enrollment IS NOT NULL GROUP BY conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) >= 5 ORDER BY AVG(studies.enrollment) DESC LIMIT 5",
    "cypher": "MATCH (conditions)<-[FOR_CONDITION]-(conditions_studies)<-[HAS_CONDITION_RECORD]-(studies)-[HAS_DESIGN]->(designs) WHERE designs.allocation = 'Randomized' AND studies.enrollment IS NOT NULL WITH conditions.mesh_term AS condition, AVG(studies.enrollment) AS avg_enrollment, COUNT(DISTINCT studies) AS study_count WHERE study_count >= 5 RETURN condition, avg_enrollment, study_count ORDER BY avg_enrollment DESC LIMIT 5"
  },
  {
    "question": "Which facilities in the United States conduct more than 20 interventional studies with at least 100 participants each?",
    "sql": "SELECT facilities.name, facilities.state, COUNT(DISTINCT studies.nct_id) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id WHERE facilities.country = 'United States' AND studies.study_type = 'Interventional' AND studies.enrollment >= 100 GROUP BY facilities.name, facilities.state HAVING COUNT(DISTINCT studies.nct_id) > 20 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (facilities)<-[AT_FACILITY]-(facilities_studies)<-[HAS_FACILITY_RECORD]-(studies) WHERE facilities.country = 'United States' AND studies.study_type = 'Interventional' AND studies.enrollment >= 100 WITH facilities.name AS facility_name, facilities.state AS state, COUNT(DISTINCT studies) AS study_count WHERE study_count > 20 RETURN facility_name, state, study_count ORDER BY study_count DESC"
  },
  {
    "question": "What interventions are tested in more than 15 Phase 2 or Phase 3 studies for diabetes?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id), SUM(studies.enrollment) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN conditions_studies ON studies.nct_id = conditions_studies.nct_id JOIN conditions ON conditions_studies.condition_id = conditions.condition_id WHERE conditions.mesh_term = 'Diabetes Mellitus' AND studies.phase IN ('Phase 2', 'Phase 3') GROUP BY interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 15 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (interventions)<-[FOR_INTERVENTION]-(interventions_studies)<-[HAS_INTERVENTION_RECORD]-(studies)-[HAS_CONDITION_RECORD]->(conditions_studies)-[FOR_CONDITION]->(conditions) WHERE conditions.mesh_term = 'Diabetes Mellitus' AND studies.phase IN ['Phase 2', 'Phase 3'] WITH interventions.mesh_term AS intervention, COUNT(DISTINCT studies) AS study_count, SUM(studies.enrollment) AS total_enrollment WHERE study_count > 15 RETURN intervention, study_count, total_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "Which industry sponsors have funded more than 50 studies with double or triple masking?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id), AVG(studies.enrollment) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE sponsors.agency_class = 'INDUSTRY' AND designs.masking IN ('Double', 'Triple') GROUP BY sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 50 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsors)<-[BY_SPONSOR]-(sponsors_studies)<-[HAS_SPONSOR_RECORD]-(studies)-[HAS_DESIGN]->(designs) WHERE sponsors.agency_class = 'INDUSTRY' AND designs.masking IN ['Double', 'Triple'] WITH sponsors.name AS sponsor_name, COUNT(DISTINCT studies) AS study_count, AVG(studies.enrollment) AS avg_enrollment WHERE study_count > 50 RETURN sponsor_name, study_count, avg_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "What are the top 10 states by total enrollment in cancer studies, and how many studies does each have?",
    "sql": "SELECT facilities.state, COUNT(DISTINCT studies.nct_id), SUM(studies.enrollment) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id JOIN conditions_studies ON studies.nct_id = conditions_studies.nct_id JOIN conditions ON conditions_studies.condition_id = conditions.condition_id WHERE conditions.mesh_term LIKE '%Cancer%' AND facilities.country = 'United States' AND studies.enrollment IS NOT NULL GROUP BY facilities.state HAVING COUNT(DISTINCT studies.nct_id) >= 10 ORDER BY SUM(studies.enrollment) DESC LIMIT 10",
    "cypher": "MATCH (facilities)<-[AT_FACILITY]-(facilities_studies)<-[HAS_FACILITY_RECORD]-(studies)-[HAS_CONDITION_RECORD]->(conditions_studies)-[FOR_CONDITION]->(conditions) WHERE conditions.mesh_term CONTAINS 'Cancer' AND facilities.country = 'United States' AND studies.enrollment IS NOT NULL WITH facilities.state AS state, COUNT(DISTINCT studies) AS study_count, SUM(studies.enrollment) AS total_enrollment WHERE study_count >= 10 RETURN state, study_count, total_enrollment ORDER BY total_enrollment DESC LIMIT 10"
  },
  {
    "question": "Which conditions have more than 30 Phase 3 studies with average enrollment exceeding 200 participants?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id), AVG(studies.enrollment) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id WHERE studies.phase = 'Phase 3' AND studies.enrollment IS NOT NULL GROUP BY conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 30 AND AVG(studies.enrollment) > 200 ORDER BY AVG(studies.enrollment) DESC",
    "cypher": "MATCH (conditions)<-[FOR_CONDITION]-(conditions_studies)<-[HAS_CONDITION_RECORD]-(studies) WHERE studies.phase = 'Phase 3' AND studies.enrollment IS NOT NULL WITH conditions.mesh_term AS condition, COUNT(DISTINCT studies) AS study_count, AVG(studies.enrollment) AS avg_enrollment WHERE study_count > 30 AND avg_enrollment > 200 RETURN condition, study_count, avg_enrollment ORDER BY avg_enrollment DESC"
  },
  {
    "question": "What are the most common interventions in studies that accept healthy volunteers and have more than 5 such studies?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id), AVG(studies.enrollment) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN eligibilities ON studies.nct_id = eligibilities.nct_id WHERE eligibilities.healthy_volunteers = 'Accepts Healthy Volunteers' GROUP BY interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 5 ORDER BY COUNT(DISTINCT studies.nct_id) DESC LIMIT 20",
    "cypher": "MATCH (interventions)<-[FOR_INTERVENTION]-(interventions_studies)<-[HAS_INTERVENTION_RECORD]-(studies)-[HAS_ELIGIBILITY]->(eligibilities) WHERE eligibilities.healthy_volunteers = 'Accepts Healthy Volunteers' WITH interventions.mesh_term AS intervention, COUNT(DISTINCT studies) AS study_count, AVG(studies.enrollment) AS avg_enrollment WHERE study_count > 5 RETURN intervention, study_count, avg_enrollment ORDER BY study_count DESC LIMIT 20"
  },
  {
    "question": "Which facilities conduct studies for more than 10 different conditions with total enrollment exceeding 5000?",
    "sql": "SELECT facilities.name, facilities.city, facilities.state, COUNT(DISTINCT conditions.condition_id), SUM(studies.enrollment) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id JOIN conditions_studies ON studies.nct_id = conditions_studies.nct_id JOIN conditions ON conditions_studies.condition_id = conditions.condition_id WHERE studies.enrollment IS NOT NULL GROUP BY facilities.name, facilities.city, facilities.state HAVING COUNT(DISTINCT conditions.condition_id) > 10 AND SUM(studies.enrollment) > 5000 ORDER BY COUNT(DISTINCT conditions.condition_id) DESC",
    "cypher": "MATCH (facilities)<-[AT_FACILITY]-(facilities_studies)<-[HAS_FACILITY_RECORD]-(studies)-[HAS_CONDITION_RECORD]->(conditions_studies)-[FOR_CONDITION]->(conditions) WHERE studies.enrollment IS NOT NULL WITH facilities.name AS facility_name, facilities.city AS city, facilities.state AS state, COUNT(DISTINCT conditions) AS condition_count, SUM(studies.enrollment) AS total_enrollment WHERE condition_count > 10 AND total_enrollment > 5000 RETURN facility_name, city, state, condition_count, total_enrollment ORDER BY condition_count DESC"
  },
  {
    "question": "What sponsors fund studies in more than 15 different states with at least 3 studies per state on average?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT facilities.state), COUNT(DISTINCT studies.nct_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN facilities_studies ON studies.nct_id = facilities_studies.nct_id JOIN facilities ON facilities_studies.facility_id = facilities.facility_id WHERE facilities.country = 'United States' GROUP BY sponsors.name HAVING COUNT(DISTINCT facilities.state) > 15 AND COUNT(DISTINCT studies.nct_id) / COUNT(DISTINCT facilities.state) >= 3 ORDER BY COUNT(DISTINCT facilities.state) DESC",
    "cypher": "MATCH (sponsors)<-[BY_SPONSOR]-(sponsors_studies)<-[HAS_SPONSOR_RECORD]-(studies)-[HAS_FACILITY_RECORD]->(facilities_studies)-[AT_FACILITY]->(facilities) WHERE facilities.country = 'United States' WITH sponsors.name AS sponsor_name, COUNT(DISTINCT facilities.state) AS state_count, COUNT(DISTINCT studies) AS study_count WHERE state_count > 15 AND study_count / state_count >= 3 RETURN sponsor_name, state_count, study_count ORDER BY state_count DESC"
  },
  {
    "question": "Which conditions are studied in more than 20 randomized parallel assignment trials with average enrollment over 150?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id), AVG(studies.enrollment), MAX(studies.enrollment) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE designs.allocation = 'Randomized' AND designs.intervention_model = 'Parallel Assignment' AND studies.enrollment IS NOT NULL GROUP BY conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 20 AND AVG(studies.enrollment) > 150 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (conditions)<-[FOR_CONDITION]-(conditions_studies)<-[HAS_CONDITION_RECORD]-(studies)-[HAS_DESIGN]->(designs) WHERE designs.allocation = 'Randomized' AND designs.intervention_model = 'Parallel Assignment' AND studies.enrollment IS NOT NULL WITH conditions.mesh_term AS condition, COUNT(DISTINCT studies) AS study_count, AVG(studies.enrollment) AS avg_enrollment, MAX(studies.enrollment) AS max_enrollment WHERE study_count > 20 AND avg_enrollment > 150 RETURN condition, study_count, avg_enrollment, max_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "What are the top 5 interventions tested in pediatric studies with more than 10 studies and average enrollment over 100?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id), AVG(studies.enrollment) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN eligibilities ON studies.nct_id = eligibilities.nct_id WHERE eligibilities.child = 'true' AND studies.enrollment IS NOT NULL GROUP BY interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 10 AND AVG(studies.enrollment) > 100 ORDER BY COUNT(DISTINCT studies.nct_id) DESC LIMIT 5",
    "cypher": "MATCH (interventions)<-[FOR_INTERVENTION]-(interventions_studies)<-[HAS_INTERVENTION_RECORD]-(studies)-[HAS_ELIGIBILITY]->(eligibilities) WHERE eligibilities.child = 'true' AND studies.enrollment IS NOT NULL WITH interventions.mesh_term AS intervention, COUNT(DISTINCT studies) AS study_count, AVG(studies.enrollment) AS avg_enrollment WHERE study_count > 10 AND avg_enrollment > 100 RETURN intervention, study_count, avg_enrollment ORDER BY study_count DESC LIMIT 5"
  },
  {
    "question": "Which cities have facilities conducting more than 30 Phase 2 or Phase 3 studies with total enrollment exceeding 10000?",
    "sql": "SELECT facilities.city, facilities.state, COUNT(DISTINCT studies.nct_id), SUM(studies.enrollment) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id WHERE studies.phase IN ('Phase 2', 'Phase 3') AND studies.enrollment IS NOT NULL GROUP BY facilities.city, facilities.state HAVING COUNT(DISTINCT studies.nct_id) > 30 AND SUM(studies.enrollment) > 10000 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (facilities)<-[AT_FACILITY]-(facilities_studies)<-[HAS_FACILITY_RECORD]-(studies) WHERE studies.phase IN ['Phase 2', 'Phase 3'] AND studies.enrollment IS NOT NULL WITH facilities.city AS city, facilities.state AS state, COUNT(DISTINCT studies) AS study_count, SUM(studies.enrollment) AS total_enrollment WHERE study_count > 30 AND total_enrollment > 10000 RETURN city, state, study_count, total_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "What conditions are studied by more than 20 different industry sponsors with at least 50 total studies?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT sponsors.sponsor_id), COUNT(DISTINCT studies.nct_id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN sponsors_studies ON studies.nct_id = sponsors_studies.nct_id JOIN sponsors ON sponsors_studies.sponsor_id = sponsors.sponsor_id WHERE sponsors.agency_class = 'INDUSTRY' GROUP BY conditions.mesh_term HAVING COUNT(DISTINCT sponsors.sponsor_id) > 20 AND COUNT(DISTINCT studies.nct_id) >= 50 ORDER BY COUNT(DISTINCT sponsors.sponsor_id) DESC",
    "cypher": "MATCH (conditions)<-[FOR_CONDITION]-(conditions_studies)<-[HAS_CONDITION_RECORD]-(studies)-[HAS_SPONSOR_RECORD]->(sponsors_studies)-[BY_SPONSOR]->(sponsors) WHERE sponsors.agency_class = 'INDUSTRY' WITH conditions.mesh_term AS condition, COUNT(DISTINCT sponsors) AS sponsor_count, COUNT(DISTINCT studies) AS study_count WHERE sponsor_count > 20 AND study_count >= 50 RETURN condition, sponsor_count, study_count ORDER BY sponsor_count DESC"
  },
  {
    "question": "Which interventions are used in more than 25 studies that have reported adverse events with at least 10 subjects affected?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id), AVG(reported_event_totals.subjects_affected) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN reported_event_totals ON studies.nct_id = reported_event_totals.nct_id WHERE reported_event_totals.subjects_affected >= 10 GROUP BY interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 25 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (interventions)<-[FOR_INTERVENTION]-(interventions_studies)<-[HAS_INTERVENTION_RECORD]-(studies)-[HAS_EVENT_TOTAL]->(reported_event_totals) WHERE reported_event_totals.subjects_affected >= 10 WITH interventions.mesh_term AS intervention, COUNT(DISTINCT studies) AS study_count, AVG(reported_event_totals.subjects_affected) AS avg_affected WHERE study_count > 25 RETURN intervention, study_count, avg_affected ORDER BY study_count DESC"
  },
  {
    "question": "What are the top 10 sponsors by number of studies in California, where each sponsor has more than 15 studies?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id), AVG(studies.enrollment) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN facilities_studies ON studies.nct_id = facilities_studies.nct_id JOIN facilities ON facilities_studies.facility_id = facilities.facility_id WHERE facilities.state = 'California' GROUP BY sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 15 ORDER BY COUNT(DISTINCT studies.nct_id) DESC LIMIT 10",
    "cypher": "MATCH (sponsors)<-[BY_SPONSOR]-(sponsors_studies)<-[HAS_SPONSOR_RECORD]-(studies)-[HAS_FACILITY_RECORD]->(facilities_studies)-[AT_FACILITY]->(facilities) WHERE facilities.state = 'California' WITH sponsors.name AS sponsor_name, COUNT(DISTINCT studies) AS study_count, AVG(studies.enrollment) AS avg_enrollment WHERE study_count > 15 RETURN sponsor_name, study_count, avg_enrollment ORDER BY study_count DESC LIMIT 10"
  },
  {
    "question": "Which conditions have more than 100 studies with outcomes, and what is the average number of outcomes per study?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id), COUNT(outcomes.id), COUNT(outcomes.id) * 1.0 / COUNT(DISTINCT studies.nct_id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN outcomes ON studies.nct_id = outcomes.nct_id GROUP BY conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 100 ORDER BY COUNT(DISTINCT studies.nct_id) DESC LIMIT 15",
    "cypher": "MATCH (conditions)<-[FOR_CONDITION]-(conditions_studies)<-[HAS_CONDITION_RECORD]-(studies)-[HAS_OUTCOME]->(outcomes) WITH conditions.mesh_term AS condition, COUNT(DISTINCT studies) AS study_count, COUNT(outcomes) AS outcome_count WHERE study_count > 100 RETURN condition, study_count, outcome_count, outcome_count * 1.0 / study_count ORDER BY study_count DESC LIMIT 15"
  },
  {
    "question": "What interventions are tested in more than 10 triple-masked studies with enrollment between 50 and 500?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id), AVG(studies.enrollment) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE designs.masking = 'Triple' AND studies.enrollment BETWEEN 50 AND 500 GROUP BY interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 10 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (interventions)<-[FOR_INTERVENTION]-(interventions_studies)<-[HAS_INTERVENTION_RECORD]-(studies)-[HAS_DESIGN]->(designs) WHERE designs.masking = 'Triple' AND studies.enrollment >= 50 AND studies.enrollment <= 500 WITH interventions.mesh_term AS intervention, COUNT(DISTINCT studies) AS study_count, AVG(studies.enrollment) AS avg_enrollment WHERE study_count > 10 RETURN intervention, study_count, avg_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "Which facilities in Massachusetts conduct more than 25 studies for conditions with at least 3 different interventions?",
    "sql": "SELECT facilities.name, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT conditions.condition_id), COUNT(DISTINCT interventions.intervention_id) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id JOIN conditions_studies ON studies.nct_id = conditions_studies.nct_id JOIN conditions ON conditions_studies.condition_id = conditions.condition_id JOIN interventions_studies ON studies.nct_id = interventions_studies.nct_id JOIN interventions ON interventions_studies.intervention_id = interventions.intervention_id WHERE facilities.state = 'Massachusetts' GROUP BY facilities.name HAVING COUNT(DISTINCT studies.nct_id) > 25 AND COUNT(DISTINCT interventions.intervention_id) >= 3 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (facilities)<-[AT_FACILITY]-(facilities_studies)<-[HAS_FACILITY_RECORD]-(studies)-[HAS_CONDITION_RECORD]->(conditions_studies)-[FOR_CONDITION]->(conditions), (studies)-[HAS_INTERVENTION_RECORD]->(interventions_studies)-[FOR_INTERVENTION]->(interventions) WHERE facilities.state = 'Massachusetts' WITH facilities.name AS facility_name, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT conditions) AS condition_count, COUNT(DISTINCT interventions) AS intervention_count WHERE study_count > 25 AND intervention_count >= 3 RETURN facility_name, study_count, condition_count, intervention_count ORDER BY study_count DESC"
  },
  {
    "question": "What are the top 5 conditions with the most studies that include older adults and have average enrollment over 200?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id), AVG(studies.enrollment) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN eligibilities ON studies.nct_id = eligibilities.nct_id WHERE eligibilities.older_adult = 'true' AND studies.enrollment IS NOT NULL GROUP BY conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) >= 5 AND AVG(studies.enrollment) > 200 ORDER BY COUNT(DISTINCT studies.nct_id) DESC LIMIT 5",
    "cypher": "MATCH (conditions)<-[FOR_CONDITION]-(conditions_studies)<-[HAS_CONDITION_RECORD]-(studies)-[HAS_ELIGIBILITY]->(eligibilities) WHERE eligibilities.older_adult = 'true' AND studies.enrollment IS NOT NULL WITH conditions.mesh_term AS condition, COUNT(DISTINCT studies) AS study_count, AVG(studies.enrollment) AS avg_enrollment WHERE study_count >= 5 AND avg_enrollment > 200 RETURN condition, study_count, avg_enrollment ORDER BY study_count DESC LIMIT 5"
  },
  {
    "question": "Which sponsors fund more than 40 observational studies across at least 10 different facilities?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT facilities.facility_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN facilities_studies ON studies.nct_id = facilities_studies.nct_id JOIN facilities ON facilities_studies.facility_id = facilities.facility_id WHERE studies.study_type = 'Observational' GROUP BY sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 40 AND COUNT(DISTINCT facilities.facility_id) >= 10 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsors)<-[BY_SPONSOR]-(sponsors_studies)<-[HAS_SPONSOR_RECORD]-(studies)-[HAS_FACILITY_RECORD]->(facilities_studies)-[AT_FACILITY]->(facilities) WHERE studies.study_type = 'Observational' WITH sponsors.name AS sponsor_name, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT facilities) AS facility_count WHERE study_count > 40 AND facility_count >= 10 RETURN sponsor_name, study_count, facility_count ORDER BY study_count DESC"
  },
  {
    "question": "What conditions are studied in more than 50 treatment studies with primary outcomes and average enrollment exceeding 100?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id), AVG(studies.enrollment), COUNT(outcomes.id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id JOIN outcomes ON studies.nct_id = outcomes.nct_id WHERE designs.primary_purpose = 'Treatment' AND outcomes.outcome_type = 'Primary' AND studies.enrollment IS NOT NULL GROUP BY conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 50 AND AVG(studies.enrollment) > 100 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (conditions)<-[FOR_CONDITION]-(conditions_studies)<-[HAS_CONDITION_RECORD]-(studies)-[HAS_DESIGN]->(designs), (studies)-[HAS_OUTCOME]->(outcomes) WHERE designs.primary_purpose = 'Treatment' AND outcomes.outcome_type = 'Primary' AND studies.enrollment IS NOT NULL WITH conditions.mesh_term AS condition, COUNT(DISTINCT studies) AS study_count, AVG(studies.enrollment) AS avg_enrollment, COUNT(outcomes) AS outcome_count WHERE study_count > 50 AND avg_enrollment > 100 RETURN condition, study_count, avg_enrollment, outcome_count ORDER BY study_count DESC"
  },
  {
    "question": "Which interventions are tested in more than 20 FDA regulated drug studies across at least 15 different states?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT facilities.state) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN facilities_studies ON studies.nct_id = facilities_studies.nct_id JOIN facilities ON facilities_studies.facility_id = facilities.facility_id WHERE studies.is_fda_regulated_drug = 'true' AND facilities.country = 'United States' GROUP BY interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 20 AND COUNT(DISTINCT facilities.state) >= 15 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (interventions)<-[FOR_INTERVENTION]-(interventions_studies)<-[HAS_INTERVENTION_RECORD]-(studies)-[HAS_FACILITY_RECORD]->(facilities_studies)-[AT_FACILITY]->(facilities) WHERE studies.is_fda_regulated_drug = 'true' AND facilities.country = 'United States' WITH interventions.mesh_term AS intervention, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT facilities.state) AS state_count WHERE study_count > 20 AND state_count >= 15 RETURN intervention, study_count, state_count ORDER BY study_count DESC"
  },
  {
    "question": "What are the top 10 facilities by number of Phase 3 cancer studies with total enrollment over 3000?",
    "sql": "SELECT facilities.name, facilities.city, facilities.state, COUNT(DISTINCT studies.nct_id), SUM(studies.enrollment) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id JOIN conditions_studies ON studies.nct_id = conditions_studies.nct_id JOIN conditions ON conditions_studies.condition_id = conditions.condition_id WHERE studies.phase = 'Phase 3' AND conditions.mesh_term LIKE '%Cancer%' AND studies.enrollment IS NOT NULL GROUP BY facilities.name, facilities.city, facilities.state HAVING SUM(studies.enrollment) > 3000 ORDER BY COUNT(DISTINCT studies.nct_id) DESC LIMIT 10",
    "cypher": "MATCH (facilities)<-[AT_FACILITY]-(facilities_studies)<-[HAS_FACILITY_RECORD]-(studies)-[HAS_CONDITION_RECORD]->(conditions_studies)-[FOR_CONDITION]->(conditions) WHERE studies.phase = 'Phase 3' AND conditions.mesh_term CONTAINS 'Cancer' AND studies.enrollment IS NOT NULL WITH facilities.name AS facility_name, facilities.city AS city, facilities.state AS state, COUNT(DISTINCT studies) AS study_count, SUM(studies.enrollment) AS total_enrollment WHERE total_enrollment > 3000 RETURN facility_name, city, state, study_count, total_enrollment ORDER BY study_count DESC LIMIT 10"
  },
  {
    "question": "Which conditions are studied by NIH sponsors in more than 30 studies with crossover or factorial designs?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id), AVG(studies.enrollment) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN sponsors_studies ON studies.nct_id = sponsors_studies.nct_id JOIN sponsors ON sponsors_studies.sponsor_id = sponsors.sponsor_id JOIN designs ON studies.nct_id = designs.nct_id WHERE sponsors.agency_class = 'NIH' AND designs.intervention_model IN ('Crossover Assignment', 'Factorial Assignment') GROUP BY conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 30 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (conditions)<-[FOR_CONDITION]-(conditions_studies)<-[HAS_CONDITION_RECORD]-(studies)-[HAS_SPONSOR_RECORD]->(sponsors_studies)-[BY_SPONSOR]->(sponsors), (studies)-[HAS_DESIGN]->(designs) WHERE sponsors.agency_class = 'NIH' AND designs.intervention_model IN ['Crossover Assignment', 'Factorial Assignment'] WITH conditions.mesh_term AS condition, COUNT(DISTINCT studies) AS study_count, AVG(studies.enrollment) AS avg_enrollment WHERE study_count > 30 RETURN condition, study_count, avg_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "What are the most common withdrawal reasons in Phase 2 studies with more than 10 recorded withdrawals?",
    "sql": "SELECT drop_withdrawals.reason, COUNT(DISTINCT studies.nct_id), AVG(drop_withdrawals.count) FROM drop_withdrawals JOIN studies ON drop_withdrawals.nct_id = studies.nct_id WHERE studies.phase = 'Phase 2' GROUP BY drop_withdrawals.reason HAVING COUNT(DISTINCT studies.nct_id) > 10 ORDER BY COUNT(DISTINCT studies.nct_id) DESC LIMIT 15",
    "cypher": "MATCH (drop_withdrawals)<-[HAS_WITHDRAWAL]-(studies) WHERE studies.phase = 'Phase 2' WITH drop_withdrawals.reason AS reason, COUNT(DISTINCT studies) AS study_count, AVG(drop_withdrawals.count) AS avg_count WHERE study_count > 10 RETURN reason, study_count, avg_count ORDER BY study_count DESC LIMIT 15"
  },
  {
    "question": "Which sponsors fund studies testing more than 15 different interventions in cardiovascular conditions?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT interventions.intervention_id), COUNT(DISTINCT studies.nct_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN interventions_studies ON studies.nct_id = interventions_studies.nct_id JOIN interventions ON interventions_studies.intervention_id = interventions.intervention_id JOIN conditions_studies ON studies.nct_id = conditions_studies.nct_id JOIN conditions ON conditions_studies.condition_id = conditions.condition_id WHERE conditions.mesh_term LIKE '%Cardiovascular%' GROUP BY sponsors.name HAVING COUNT(DISTINCT interventions.intervention_id) > 15 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsors)<-[BY_SPONSOR]-(sponsors_studies)<-[HAS_SPONSOR_RECORD]-(studies)-[HAS_INTERVENTION_RECORD]->(interventions_studies)-[FOR_INTERVENTION]->(interventions), (studies)-[HAS_CONDITION_RECORD]->(conditions_studies)-[FOR_CONDITION]->(conditions) WHERE conditions.mesh_term CONTAINS 'Cardiovascular' WITH sponsors.name AS sponsor_name, COUNT(DISTINCT interventions) AS intervention_count, COUNT(DISTINCT studies) AS study_count WHERE intervention_count > 15 RETURN sponsor_name, intervention_count, study_count ORDER BY study_count DESC"
  },
  {
    "question": "What cities have facilities conducting more than 50 studies for at least 20 different conditions?",
    "sql": "SELECT facilities.city, facilities.state, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT conditions.condition_id) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id JOIN conditions_studies ON studies.nct_id = conditions_studies.nct_id JOIN conditions ON conditions_studies.condition_id = conditions.condition_id GROUP BY facilities.city, facilities.state HAVING COUNT(DISTINCT studies.nct_id) > 50 AND COUNT(DISTINCT conditions.condition_id) >= 20 ORDER BY COUNT(DISTINCT studies.nct_id) DESC LIMIT 10",
    "cypher": "MATCH (facilities)<-[AT_FACILITY]-(facilities_studies)<-[HAS_FACILITY_RECORD]-(studies)-[HAS_CONDITION_RECORD]->(conditions_studies)-[FOR_CONDITION]->(conditions) WITH facilities.city AS city, facilities.state AS state, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT conditions) AS condition_count WHERE study_count > 50 AND condition_count >= 20 RETURN city, state, study_count, condition_count ORDER BY study_count DESC LIMIT 10"
  },
  {
    "question": "Which interventions have been tested in more than 100 studies with outcomes that include p-values?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT outcome_analyses.id) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN outcomes ON studies.nct_id = outcomes.nct_id JOIN outcome_analyses ON outcomes.id = outcome_analyses.outcome_id WHERE outcome_analyses.p_value IS NOT NULL GROUP BY interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 100 ORDER BY COUNT(DISTINCT studies.nct_id) DESC LIMIT 10",
    "cypher": "MATCH (interventions)<-[FOR_INTERVENTION]-(interventions_studies)<-[HAS_INTERVENTION_RECORD]-(studies)-[HAS_OUTCOME]->(outcomes)-[HAS_ANALYSIS]->(outcome_analyses) WHERE outcome_analyses.p_value IS NOT NULL WITH interventions.mesh_term AS intervention, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT outcome_analyses) AS analysis_count WHERE study_count > 100 RETURN intervention, study_count, analysis_count ORDER BY study_count DESC LIMIT 10"
  },
  {
    "question": "What conditions have more than 20 Phase 1 studies with average enrollment below 50 participants?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id), AVG(studies.enrollment), MIN(studies.enrollment) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id WHERE studies.phase = 'Phase 1' AND studies.enrollment IS NOT NULL GROUP BY conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 20 AND AVG(studies.enrollment) < 50 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (conditions)<-[FOR_CONDITION]-(conditions_studies)<-[HAS_CONDITION_RECORD]-(studies) WHERE studies.phase = 'Phase 1' AND studies.enrollment IS NOT NULL WITH conditions.mesh_term AS condition, COUNT(DISTINCT studies) AS study_count, AVG(studies.enrollment) AS avg_enrollment, MIN(studies.enrollment) AS min_enrollment WHERE study_count > 20 AND avg_enrollment < 50 RETURN condition, study_count, avg_enrollment, min_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "Which industry sponsors have funded more than 100 studies across at least 25 states with average enrollment over 150?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT facilities.state), AVG(studies.enrollment) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN facilities_studies ON studies.nct_id = facilities_studies.nct_id JOIN facilities ON facilities_studies.facility_id = facilities.facility_id WHERE sponsors.agency_class = 'INDUSTRY' AND facilities.country = 'United States' AND studies.enrollment IS NOT NULL GROUP BY sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 100 AND COUNT(DISTINCT facilities.state) >= 25 AND AVG(studies.enrollment) > 150 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsors)<-[BY_SPONSOR]-(sponsors_studies)<-[HAS_SPONSOR_RECORD]-(studies)-[HAS_FACILITY_RECORD]->(facilities_studies)-[AT_FACILITY]->(facilities) WHERE sponsors.agency_class = 'INDUSTRY' AND facilities.country = 'United States' AND studies.enrollment IS NOT NULL WITH sponsors.name AS sponsor_name, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT facilities.state) AS state_count, AVG(studies.enrollment) AS avg_enrollment WHERE study_count > 100 AND state_count >= 25 AND avg_enrollment > 150 RETURN sponsor_name, study_count, state_count, avg_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "What are the top 5 interventions with the highest total enrollment in diabetes studies across all phases?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id), SUM(studies.enrollment) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN conditions_studies ON studies.nct_id = conditions_studies.nct_id JOIN conditions ON conditions_studies.condition_id = conditions.condition_id WHERE conditions.mesh_term = 'Diabetes Mellitus' AND studies.enrollment IS NOT NULL GROUP BY interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) >= 5 ORDER BY SUM(studies.enrollment) DESC LIMIT 5",
    "cypher": "MATCH (interventions)<-[FOR_INTERVENTION]-(interventions_studies)<-[HAS_INTERVENTION_RECORD]-(studies)-[HAS_CONDITION_RECORD]->(conditions_studies)-[FOR_CONDITION]->(conditions) WHERE conditions.mesh_term = 'Diabetes Mellitus' AND studies.enrollment IS NOT NULL WITH interventions.mesh_term AS intervention, COUNT(DISTINCT studies) AS study_count, SUM(studies.enrollment) AS total_enrollment WHERE study_count >= 5 RETURN intervention, study_count, total_enrollment ORDER BY total_enrollment DESC LIMIT 5"
  },
  {
    "question": "Which facilities conduct more than 40 randomized studies with both primary and secondary outcomes?",
    "sql": "SELECT facilities.name, facilities.city, facilities.state, COUNT(DISTINCT studies.nct_id) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id JOIN outcomes ON studies.nct_id = outcomes.nct_id WHERE designs.allocation = 'Randomized' AND outcomes.outcome_type IN ('Primary', 'Secondary') GROUP BY facilities.name, facilities.city, facilities.state HAVING COUNT(DISTINCT studies.nct_id) > 40 ORDER BY COUNT(DISTINCT studies.nct_id) DESC LIMIT 15",
    "cypher": "MATCH (facilities)<-[AT_FACILITY]-(facilities_studies)<-[HAS_FACILITY_RECORD]-(studies)-[HAS_DESIGN]->(designs), (studies)-[HAS_OUTCOME]->(outcomes) WHERE designs.allocation = 'Randomized' AND outcomes.outcome_type IN ['Primary', 'Secondary'] WITH facilities.name AS facility_name, facilities.city AS city, facilities.state AS state, COUNT(DISTINCT studies) AS study_count WHERE study_count > 40 RETURN facility_name, city, state, study_count ORDER BY study_count DESC LIMIT 15"
  },
  {
    "question": "What conditions are studied in more than 30 prospective cohort studies with average enrollment over 300?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id), AVG(studies.enrollment) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE studies.study_type = 'Observational' AND designs.observational_model = 'Cohort' AND designs.time_perspective = 'Prospective' AND studies.enrollment IS NOT NULL GROUP BY conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 30 AND AVG(studies.enrollment) > 300 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (conditions)<-[FOR_CONDITION]-(conditions_studies)<-[HAS_CONDITION_RECORD]-(studies)-[HAS_DESIGN]->(designs) WHERE studies.study_type = 'Observational' AND designs.observational_model = 'Cohort' AND designs.time_perspective = 'Prospective' AND studies.enrollment IS NOT NULL WITH conditions.mesh_term AS condition, COUNT(DISTINCT studies) AS study_count, AVG(studies.enrollment) AS avg_enrollment WHERE study_count > 30 AND avg_enrollment > 300 RETURN condition, study_count, avg_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "Which sponsors fund more than 50 Phase 3 studies with quadruple masking across multiple conditions?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT conditions.condition_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id JOIN conditions_studies ON studies.nct_id = conditions_studies.nct_id JOIN conditions ON conditions_studies.condition_id = conditions.condition_id WHERE studies.phase = 'Phase 3' AND designs.masking = 'Quadruple' GROUP BY sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 50 AND COUNT(DISTINCT conditions.condition_id) >= 5 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsors)<-[BY_SPONSOR]-(sponsors_studies)<-[HAS_SPONSOR_RECORD]-(studies)-[HAS_DESIGN]->(designs), (studies)-[HAS_CONDITION_RECORD]->(conditions_studies)-[FOR_CONDITION]->(conditions) WHERE studies.phase = 'Phase 3' AND designs.masking = 'Quadruple' WITH sponsors.name AS sponsor_name, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT conditions) AS condition_count WHERE study_count > 50 AND condition_count >= 5 RETURN sponsor_name, study_count, condition_count ORDER BY study_count DESC"
  },
  {
    "question": "What are the top 10 interventions tested in female-only studies with more than 20 studies each?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id), AVG(studies.enrollment) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN eligibilities ON studies.nct_id = eligibilities.nct_id WHERE eligibilities.gender = 'Female' GROUP BY interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 20 ORDER BY COUNT(DISTINCT studies.nct_id) DESC LIMIT 10",
    "cypher": "MATCH (interventions)<-[FOR_INTERVENTION]-(interventions_studies)<-[HAS_INTERVENTION_RECORD]-(studies)-[HAS_ELIGIBILITY]->(eligibilities) WHERE eligibilities.gender = 'Female' WITH interventions.mesh_term AS intervention, COUNT(DISTINCT studies) AS study_count, AVG(studies.enrollment) AS avg_enrollment WHERE study_count > 20 RETURN intervention, study_count, avg_enrollment ORDER BY study_count DESC LIMIT 10"
  },
  {
    "question": "Which conditions are studied in more than 25 single group assignment studies with enrollment over 100?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id), AVG(studies.enrollment), SUM(studies.enrollment) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE designs.intervention_model = 'Single Group Assignment' AND studies.enrollment > 100 GROUP BY conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 25 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (conditions)<-[FOR_CONDITION]-(conditions_studies)<-[HAS_CONDITION_RECORD]-(studies)-[HAS_DESIGN]->(designs) WHERE designs.intervention_model = 'Single Group Assignment' AND studies.enrollment > 100 WITH conditions.mesh_term AS condition, COUNT(DISTINCT studies) AS study_count, AVG(studies.enrollment) AS avg_enrollment, SUM(studies.enrollment) AS total_enrollment WHERE study_count > 25 RETURN condition, study_count, avg_enrollment, total_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "What facilities in New York conduct more than 30 studies with reported adverse events affecting at least 5 subjects?",
    "sql": "SELECT facilities.name, COUNT(DISTINCT studies.nct_id), AVG(reported_event_totals.subjects_affected) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id JOIN reported_event_totals ON studies.nct_id = reported_event_totals.nct_id WHERE facilities.state = 'New York' AND reported_event_totals.subjects_affected >= 5 GROUP BY facilities.name HAVING COUNT(DISTINCT studies.nct_id) > 30 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (facilities)<-[AT_FACILITY]-(facilities_studies)<-[HAS_FACILITY_RECORD]-(studies)-[HAS_EVENT_TOTAL]->(reported_event_totals) WHERE facilities.state = 'New York' AND reported_event_totals.subjects_affected >= 5 WITH facilities.name AS facility_name, COUNT(DISTINCT studies) AS study_count, AVG(reported_event_totals.subjects_affected) AS avg_affected WHERE study_count > 30 RETURN facility_name, study_count, avg_affected ORDER BY study_count DESC"
  },
  {
    "question": "Which interventions are tested in more than 15 prevention studies that include adults and older adults?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id), AVG(studies.enrollment) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id JOIN eligibilities ON studies.nct_id = eligibilities.nct_id WHERE designs.primary_purpose = 'Prevention' AND eligibilities.adult = 'true' AND eligibilities.older_adult = 'true' GROUP BY interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 15 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (interventions)<-[FOR_INTERVENTION]-(interventions_studies)<-[HAS_INTERVENTION_RECORD]-(studies)-[HAS_DESIGN]->(designs), (studies)-[HAS_ELIGIBILITY]->(eligibilities) WHERE designs.primary_purpose = 'Prevention' AND eligibilities.adult = 'true' AND eligibilities.older_adult = 'true' WITH interventions.mesh_term AS intervention, COUNT(DISTINCT studies) AS study_count, AVG(studies.enrollment) AS avg_enrollment WHERE study_count > 15 RETURN intervention, study_count, avg_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "What are the top 5 states by number of Phase 2 diabetes studies with total enrollment exceeding 5000?",
    "sql": "SELECT facilities.state, COUNT(DISTINCT studies.nct_id), SUM(studies.enrollment) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id JOIN conditions_studies ON studies.nct_id = conditions_studies.nct_id JOIN conditions ON conditions_studies.condition_id = conditions.condition_id WHERE studies.phase = 'Phase 2' AND conditions.mesh_term = 'Diabetes Mellitus' AND studies.enrollment IS NOT NULL AND facilities.country = 'United States' GROUP BY facilities.state HAVING SUM(studies.enrollment) > 5000 ORDER BY COUNT(DISTINCT studies.nct_id) DESC LIMIT 5",
    "cypher": "MATCH (facilities)<-[AT_FACILITY]-(facilities_studies)<-[HAS_FACILITY_RECORD]-(studies)-[HAS_CONDITION_RECORD]->(conditions_studies)-[FOR_CONDITION]->(conditions) WHERE studies.phase = 'Phase 2' AND conditions.mesh_term = 'Diabetes Mellitus' AND studies.enrollment IS NOT NULL AND facilities.country = 'United States' WITH facilities.state AS state, COUNT(DISTINCT studies) AS study_count, SUM(studies.enrollment) AS total_enrollment WHERE total_enrollment > 5000 RETURN state, study_count, total_enrollment ORDER BY study_count DESC LIMIT 5"
  },
  {
    "question": "Which conditions have more than 100 studies with at least one primary outcome analysis with confidence intervals?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT outcome_analyses.id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN outcomes ON studies.nct_id = outcomes.nct_id JOIN outcome_analyses ON outcomes.id = outcome_analyses.outcome_id WHERE outcomes.outcome_type = 'Primary' AND outcome_analyses.ci_lower_limit IS NOT NULL AND outcome_analyses.ci_upper_limit IS NOT NULL GROUP BY conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 100 ORDER BY COUNT(DISTINCT studies.nct_id) DESC LIMIT 10",
    "cypher": "MATCH (conditions)<-[FOR_CONDITION]-(conditions_studies)<-[HAS_CONDITION_RECORD]-(studies)-[HAS_OUTCOME]->(outcomes)-[HAS_ANALYSIS]->(outcome_analyses) WHERE outcomes.outcome_type = 'Primary' AND outcome_analyses.ci_lower_limit IS NOT NULL AND outcome_analyses.ci_upper_limit IS NOT NULL WITH conditions.mesh_term AS condition, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT outcome_analyses) AS analysis_count WHERE study_count > 100 RETURN condition, study_count, analysis_count ORDER BY study_count DESC LIMIT 10"
  },
  {
    "question": "What sponsors fund more than 75 interventional studies with parallel assignment and more than 2 arms?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id), AVG(studies.number_of_arms) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE studies.study_type = 'Interventional' AND designs.intervention_model = 'Parallel Assignment' AND studies.number_of_arms > 2 GROUP BY sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 75 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsors)<-[BY_SPONSOR]-(sponsors_studies)<-[HAS_SPONSOR_RECORD]-(studies)-[HAS_DESIGN]->(designs) WHERE studies.study_type = 'Interventional' AND designs.intervention_model = 'Parallel Assignment' AND studies.number_of_arms > 2 WITH sponsors.name AS sponsor_name, COUNT(DISTINCT studies) AS study_count, AVG(studies.number_of_arms) AS avg_arms WHERE study_count > 75 RETURN sponsor_name, study_count, avg_arms ORDER BY study_count DESC"
  },
  {
    "question": "Which facilities conduct more than 20 diagnostic studies across at least 8 different conditions?",
    "sql": "SELECT facilities.name, facilities.city, facilities.state, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT conditions.condition_id) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id JOIN conditions_studies ON studies.nct_id = conditions_studies.nct_id JOIN conditions ON conditions_studies.condition_id = conditions.condition_id WHERE designs.primary_purpose = 'Diagnostic' GROUP BY facilities.name, facilities.city, facilities.state HAVING COUNT(DISTINCT studies.nct_id) > 20 AND COUNT(DISTINCT conditions.condition_id) >= 8 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (facilities)<-[AT_FACILITY]-(facilities_studies)<-[HAS_FACILITY_RECORD]-(studies)-[HAS_DESIGN]->(designs), (studies)-[HAS_CONDITION_RECORD]->(conditions_studies)-[FOR_CONDITION]->(conditions) WHERE designs.primary_purpose = 'Diagnostic' WITH facilities.name AS facility_name, facilities.city AS city, facilities.state AS state, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT conditions) AS condition_count WHERE study_count > 20 AND condition_count >= 8 RETURN facility_name, city, state, study_count, condition_count ORDER BY study_count DESC"
  },
  {
    "question": "What interventions are tested in more than 40 studies with enrollment between 100 and 500 across multiple phases?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT studies.phase), AVG(studies.enrollment) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id WHERE studies.enrollment BETWEEN 100 AND 500 GROUP BY interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 40 AND COUNT(DISTINCT studies.phase) >= 2 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (interventions)<-[FOR_INTERVENTION]-(interventions_studies)<-[HAS_INTERVENTION_RECORD]-(studies) WHERE studies.enrollment >= 100 AND studies.enrollment <= 500 WITH interventions.mesh_term AS intervention, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT studies.phase) AS phase_count, AVG(studies.enrollment) AS avg_enrollment WHERE study_count > 40 AND phase_count >= 2 RETURN intervention, study_count, phase_count, avg_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "Which conditions are studied in more than 50 studies with both NIH and industry sponsorship?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT sponsors.sponsor_id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN sponsors_studies ON studies.nct_id = sponsors_studies.nct_id JOIN sponsors ON sponsors_studies.sponsor_id = sponsors.sponsor_id WHERE sponsors.agency_class IN ('NIH', 'INDUSTRY') GROUP BY conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 50 AND COUNT(DISTINCT sponsors.agency_class) = 2 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (conditions)<-[FOR_CONDITION]-(conditions_studies)<-[HAS_CONDITION_RECORD]-(studies)-[HAS_SPONSOR_RECORD]->(sponsors_studies)-[BY_SPONSOR]->(sponsors) WHERE sponsors.agency_class IN ['NIH', 'INDUSTRY'] WITH conditions.mesh_term AS condition, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT sponsors) AS sponsor_count, COLLECT(DISTINCT sponsors.agency_class) AS agency_classes WHERE study_count > 50 AND SIZE(agency_classes) = 2 RETURN condition, study_count, sponsor_count ORDER BY study_count DESC"
  },
  {
    "question": "What are the top 10 facilities by number of studies with outcomes that have statistical analyses?",
    "sql": "SELECT facilities.name, facilities.city, facilities.state, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT outcome_analyses.id) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id JOIN outcomes ON studies.nct_id = outcomes.nct_id JOIN outcome_analyses ON outcomes.id = outcome_analyses.outcome_id GROUP BY facilities.name, facilities.city, facilities.state HAVING COUNT(DISTINCT outcome_analyses.id) >= 10 ORDER BY COUNT(DISTINCT studies.nct_id) DESC LIMIT 10",
    "cypher": "MATCH (facilities)<-[AT_FACILITY]-(facilities_studies)<-[HAS_FACILITY_RECORD]-(studies)-[HAS_OUTCOME]->(outcomes)-[HAS_ANALYSIS]->(outcome_analyses) WITH facilities.name AS facility_name, facilities.city AS city, facilities.state AS state, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT outcome_analyses) AS analysis_count WHERE analysis_count >= 10 RETURN facility_name, city, state, study_count, analysis_count ORDER BY study_count DESC LIMIT 10"
  },
  {
    "question": "Which interventions are used in more than 30 male-only studies with average enrollment over 75?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id), AVG(studies.enrollment) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN eligibilities ON studies.nct_id = eligibilities.nct_id WHERE eligibilities.gender = 'Male' AND studies.enrollment IS NOT NULL GROUP BY interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 30 AND AVG(studies.enrollment) > 75 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (interventions)<-[FOR_INTERVENTION]-(interventions_studies)<-[HAS_INTERVENTION_RECORD]-(studies)-[HAS_ELIGIBILITY]->(eligibilities) WHERE eligibilities.gender = 'Male' AND studies.enrollment IS NOT NULL WITH interventions.mesh_term AS intervention, COUNT(DISTINCT studies) AS study_count, AVG(studies.enrollment) AS avg_enrollment WHERE study_count > 30 AND avg_enrollment > 75 RETURN intervention, study_count, avg_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "What conditions are studied in more than 40 case-control studies with at least 200 total participants on average?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id), AVG(studies.enrollment) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE designs.observational_model = 'Case-Control' AND studies.enrollment IS NOT NULL GROUP BY conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 40 AND AVG(studies.enrollment) >= 200 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (conditions)<-[FOR_CONDITION]-(conditions_studies)<-[HAS_CONDITION_RECORD]-(studies)-[HAS_DESIGN]->(designs) WHERE designs.observational_model = 'Case-Control' AND studies.enrollment IS NOT NULL WITH conditions.mesh_term AS condition, COUNT(DISTINCT studies) AS study_count, AVG(studies.enrollment) AS avg_enrollment WHERE study_count > 40 AND avg_enrollment >= 200 RETURN condition, study_count, avg_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "Which conditions have more than 120 studies with actual enrollment type and average enrollment exceeding 175?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id), AVG(studies.enrollment), MAX(studies.enrollment) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id WHERE studies.enrollment_type = 'Actual' AND studies.enrollment IS NOT NULL GROUP BY conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 120 AND AVG(studies.enrollment) > 175 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (conditions)<-[FOR_CONDITION]-(conditions_studies)<-[HAS_CONDITION_RECORD]-(studies) WHERE studies.enrollment_type = 'Actual' AND studies.enrollment IS NOT NULL WITH conditions.mesh_term AS condition, COUNT(DISTINCT studies) AS study_count, AVG(studies.enrollment) AS avg_enrollment, MAX(studies.enrollment) AS max_enrollment WHERE study_count > 120 AND avg_enrollment > 175 RETURN condition, study_count, avg_enrollment, max_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "What sponsors fund more than 40 studies in Florida with at least 15 different interventions tested?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT interventions.intervention_id), AVG(studies.enrollment) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN facilities_studies ON studies.nct_id = facilities_studies.nct_id JOIN facilities ON facilities_studies.facility_id = facilities.facility_id JOIN interventions_studies ON studies.nct_id = interventions_studies.nct_id JOIN interventions ON interventions_studies.intervention_id = interventions.intervention_id WHERE facilities.state = 'Florida' GROUP BY sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 40 AND COUNT(DISTINCT interventions.intervention_id) >= 15 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsors)<-[BY_SPONSOR]-(sponsors_studies)<-[HAS_SPONSOR_RECORD]-(studies)-[HAS_FACILITY_RECORD]->(facilities_studies)-[AT_FACILITY]->(facilities), (studies)-[HAS_INTERVENTION_RECORD]->(interventions_studies)-[FOR_INTERVENTION]->(interventions) WHERE facilities.state = 'Florida' WITH sponsors.name AS sponsor_name, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT interventions) AS intervention_count, AVG(studies.enrollment) AS avg_enrollment WHERE study_count > 40 AND intervention_count >= 15 RETURN sponsor_name, study_count, intervention_count, avg_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "Which interventions are tested in more than 30 Phase 4 studies with total enrollment over 12000?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id), SUM(studies.enrollment), AVG(studies.enrollment) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id WHERE studies.phase = 'Phase 4' AND studies.enrollment IS NOT NULL GROUP BY interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 30 AND SUM(studies.enrollment) > 12000 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (interventions)<-[FOR_INTERVENTION]-(interventions_studies)<-[HAS_INTERVENTION_RECORD]-(studies) WHERE studies.phase = 'Phase 4' AND studies.enrollment IS NOT NULL WITH interventions.mesh_term AS intervention, COUNT(DISTINCT studies) AS study_count, SUM(studies.enrollment) AS total_enrollment, AVG(studies.enrollment) AS avg_enrollment WHERE study_count > 30 AND total_enrollment > 12000 RETURN intervention, study_count, total_enrollment, avg_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "What facilities in Massachusetts conduct more than 40 treatment studies across at least 25 different conditions?",
    "sql": "SELECT facilities.name, facilities.city, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT conditions.condition_id) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id JOIN conditions_studies ON studies.nct_id = conditions_studies.nct_id JOIN conditions ON conditions_studies.condition_id = conditions.condition_id WHERE facilities.state = 'Massachusetts' AND designs.primary_purpose = 'Treatment' GROUP BY facilities.name, facilities.city HAVING COUNT(DISTINCT studies.nct_id) > 40 AND COUNT(DISTINCT conditions.condition_id) >= 25 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (facilities)<-[AT_FACILITY]-(facilities_studies)<-[HAS_FACILITY_RECORD]-(studies)-[HAS_DESIGN]->(designs), (studies)-[HAS_CONDITION_RECORD]->(conditions_studies)-[FOR_CONDITION]->(conditions) WHERE facilities.state = 'Massachusetts' AND designs.primary_purpose = 'Treatment' WITH facilities.name AS facility_name, facilities.city AS city, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT conditions) AS condition_count WHERE study_count > 40 AND condition_count >= 25 RETURN facility_name, city, study_count, condition_count ORDER BY study_count DESC"
  },
  {
    "question": "Which conditions are studied in more than 55 factorial assignment trials with at least 20 industry sponsors?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT sponsors.sponsor_id), AVG(studies.enrollment) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id JOIN sponsors_studies ON studies.nct_id = sponsors_studies.nct_id JOIN sponsors ON sponsors_studies.sponsor_id = sponsors.sponsor_id WHERE designs.intervention_model = 'Factorial Assignment' AND sponsors.agency_class = 'INDUSTRY' GROUP BY conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 55 AND COUNT(DISTINCT sponsors.sponsor_id) >= 20 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (conditions)<-[FOR_CONDITION]-(conditions_studies)<-[HAS_CONDITION_RECORD]-(studies)-[HAS_DESIGN]->(designs), (studies)-[HAS_SPONSOR_RECORD]->(sponsors_studies)-[BY_SPONSOR]->(sponsors) WHERE designs.intervention_model = 'Factorial Assignment' AND sponsors.agency_class = 'INDUSTRY' WITH conditions.mesh_term AS condition, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT sponsors) AS sponsor_count, AVG(studies.enrollment) AS avg_enrollment WHERE study_count > 55 AND sponsor_count >= 20 RETURN condition, study_count, sponsor_count, avg_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "What are the top 10 interventions tested in studies that do not accept healthy volunteers with at least 25 studies?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id), AVG(studies.enrollment) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN eligibilities ON studies.nct_id = eligibilities.nct_id WHERE eligibilities.healthy_volunteers = 'No' GROUP BY interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) >= 25 ORDER BY COUNT(DISTINCT studies.nct_id) DESC LIMIT 10",
    "cypher": "MATCH (interventions)<-[FOR_INTERVENTION]-(interventions_studies)<-[HAS_INTERVENTION_RECORD]-(studies)-[HAS_ELIGIBILITY]->(eligibilities) WHERE eligibilities.healthy_volunteers = 'No' WITH interventions.mesh_term AS intervention, COUNT(DISTINCT studies) AS study_count, AVG(studies.enrollment) AS avg_enrollment WHERE study_count >= 25 RETURN intervention, study_count, avg_enrollment ORDER BY study_count DESC LIMIT 10"
  },
  {
    "question": "Which sponsors fund more than 65 studies with non-randomized allocation across at least 12 states?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT facilities.state), AVG(studies.enrollment) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id JOIN facilities_studies ON studies.nct_id = facilities_studies.nct_id JOIN facilities ON facilities_studies.facility_id = facilities.facility_id WHERE designs.allocation = 'Non-Randomized' AND facilities.country = 'United States' GROUP BY sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 65 AND COUNT(DISTINCT facilities.state) >= 12 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsors)<-[BY_SPONSOR]-(sponsors_studies)<-[HAS_SPONSOR_RECORD]-(studies)-[HAS_DESIGN]->(designs), (studies)-[HAS_FACILITY_RECORD]->(facilities_studies)-[AT_FACILITY]->(facilities) WHERE designs.allocation = 'Non-Randomized' AND facilities.country = 'United States' WITH sponsors.name AS sponsor_name, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT facilities.state) AS state_count, AVG(studies.enrollment) AS avg_enrollment WHERE study_count > 65 AND state_count >= 12 RETURN sponsor_name, study_count, state_count, avg_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "What conditions are studied in more than 85 studies with outcomes and have at least 150 total outcome analyses?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT outcomes.id), COUNT(outcome_analyses.id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN outcomes ON studies.nct_id = outcomes.nct_id JOIN outcome_analyses ON outcomes.id = outcome_analyses.outcome_id GROUP BY conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 85 AND COUNT(outcome_analyses.id) >= 150 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (conditions)<-[FOR_CONDITION]-(conditions_studies)<-[HAS_CONDITION_RECORD]-(studies)-[HAS_OUTCOME]->(outcomes)-[HAS_ANALYSIS]->(outcome_analyses) WITH conditions.mesh_term AS condition, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT outcomes) AS outcome_count, COUNT(outcome_analyses) AS analysis_count WHERE study_count > 85 AND analysis_count >= 150 RETURN condition, study_count, outcome_count, analysis_count ORDER BY study_count DESC"
  },
  {
    "question": "Which facilities conduct more than 55 studies with at least 4 arms and average enrollment over 180?",
    "sql": "SELECT facilities.name, facilities.city, facilities.state, COUNT(DISTINCT studies.nct_id), AVG(studies.enrollment) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id WHERE studies.number_of_arms >= 4 AND studies.enrollment IS NOT NULL GROUP BY facilities.name, facilities.city, facilities.state HAVING COUNT(DISTINCT studies.nct_id) > 55 AND AVG(studies.enrollment) > 180 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (facilities)<-[AT_FACILITY]-(facilities_studies)<-[HAS_FACILITY_RECORD]-(studies) WHERE studies.number_of_arms >= 4 AND studies.enrollment IS NOT NULL WITH facilities.name AS facility_name, facilities.city AS city, facilities.state AS state, COUNT(DISTINCT studies) AS study_count, AVG(studies.enrollment) AS avg_enrollment WHERE study_count > 55 AND avg_enrollment > 180 RETURN facility_name, city, state, study_count, avg_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "What interventions are tested in more than 45 observational studies with crossover model across multiple conditions?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT conditions.condition_id) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id JOIN conditions_studies ON studies.nct_id = conditions_studies.nct_id JOIN conditions ON conditions_studies.condition_id = conditions.condition_id WHERE studies.study_type = 'Observational' AND designs.observational_model = 'Crossover' GROUP BY interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 45 AND COUNT(DISTINCT conditions.condition_id) >= 5 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (interventions)<-[FOR_INTERVENTION]-(interventions_studies)<-[HAS_INTERVENTION_RECORD]-(studies)-[HAS_DESIGN]->(designs), (studies)-[HAS_CONDITION_RECORD]->(conditions_studies)-[FOR_CONDITION]->(conditions) WHERE studies.study_type = 'Observational' AND designs.observational_model = 'Crossover' WITH interventions.mesh_term AS intervention, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT conditions) AS condition_count WHERE study_count > 45 AND condition_count >= 5 RETURN intervention, study_count, condition_count ORDER BY study_count DESC"
  },
  {
    "question": "Which conditions have more than 110 studies with subjects at risk for adverse events exceeding 1000 total subjects?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id), SUM(reported_event_totals.subjects_at_risk), AVG(reported_event_totals.subjects_at_risk) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN reported_event_totals ON studies.nct_id = reported_event_totals.nct_id WHERE reported_event_totals.subjects_at_risk IS NOT NULL GROUP BY conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 110 AND SUM(reported_event_totals.subjects_at_risk) > 1000 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (conditions)<-[FOR_CONDITION]-(conditions_studies)<-[HAS_CONDITION_RECORD]-(studies)-[HAS_EVENT_TOTAL]->(reported_event_totals) WHERE reported_event_totals.subjects_at_risk IS NOT NULL WITH conditions.mesh_term AS condition, COUNT(DISTINCT studies) AS study_count, SUM(reported_event_totals.subjects_at_risk) AS total_at_risk, AVG(reported_event_totals.subjects_at_risk) AS avg_at_risk WHERE study_count > 110 AND total_at_risk > 1000 RETURN condition, study_count, total_at_risk, avg_at_risk ORDER BY study_count DESC"
  },
  {
    "question": "What are the top 15 sponsors by number of studies with biospecimen retention in at least 8 different states?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT facilities.state) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN facilities_studies ON studies.nct_id = facilities_studies.nct_id JOIN facilities ON facilities_studies.facility_id = facilities.facility_id WHERE studies.biospec_retention IS NOT NULL AND facilities.country = 'United States' GROUP BY sponsors.name HAVING COUNT(DISTINCT facilities.state) >= 8 ORDER BY COUNT(DISTINCT studies.nct_id) DESC LIMIT 15",
    "cypher": "MATCH (sponsors)<-[BY_SPONSOR]-(sponsors_studies)<-[HAS_SPONSOR_RECORD]-(studies)-[HAS_FACILITY_RECORD]->(facilities_studies)-[AT_FACILITY]->(facilities) WHERE studies.biospec_retention IS NOT NULL AND facilities.country = 'United States' WITH sponsors.name AS sponsor_name, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT facilities.state) AS state_count WHERE state_count >= 8 RETURN sponsor_name, study_count, state_count ORDER BY study_count DESC LIMIT 15"
  },
  {
    "question": "Which facilities in Pennsylvania conduct more than 35 randomized parallel assignment studies with total enrollment over 7500?",
    "sql": "SELECT facilities.name, facilities.city, COUNT(DISTINCT studies.nct_id), SUM(studies.enrollment) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE facilities.state = 'Pennsylvania' AND designs.allocation = 'Randomized' AND designs.intervention_model = 'Parallel Assignment' AND studies.enrollment IS NOT NULL GROUP BY facilities.name, facilities.city HAVING COUNT(DISTINCT studies.nct_id) > 35 AND SUM(studies.enrollment) > 7500 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (facilities)<-[AT_FACILITY]-(facilities_studies)<-[HAS_FACILITY_RECORD]-(studies)-[HAS_DESIGN]->(designs) WHERE facilities.state = 'Pennsylvania' AND designs.allocation = 'Randomized' AND designs.intervention_model = 'Parallel Assignment' AND studies.enrollment IS NOT NULL WITH facilities.name AS facility_name, facilities.city AS city, COUNT(DISTINCT studies) AS study_count, SUM(studies.enrollment) AS total_enrollment WHERE study_count > 35 AND total_enrollment > 7500 RETURN facility_name, city, study_count, total_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "What conditions are studied in more than 75 interventional studies that plan to share individual participant data?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id), AVG(studies.enrollment) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id WHERE studies.study_type = 'Interventional' AND studies.plan_to_share_ipd = 'Yes' GROUP BY conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 75 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (conditions)<-[FOR_CONDITION]-(conditions_studies)<-[HAS_CONDITION_RECORD]-(studies) WHERE studies.study_type = 'Interventional' AND studies.plan_to_share_ipd = 'Yes' WITH conditions.mesh_term AS condition, COUNT(DISTINCT studies) AS study_count, AVG(studies.enrollment) AS avg_enrollment WHERE study_count > 75 RETURN condition, study_count, avg_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "Which interventions are tested in more than 60 studies with data monitoring committees and average enrollment over 140?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id), AVG(studies.enrollment), SUM(studies.enrollment) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id WHERE studies.has_dmc = 'true' AND studies.enrollment IS NOT NULL GROUP BY interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 60 AND AVG(studies.enrollment) > 140 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (interventions)<-[FOR_INTERVENTION]-(interventions_studies)<-[HAS_INTERVENTION_RECORD]-(studies) WHERE studies.has_dmc = 'true' AND studies.enrollment IS NOT NULL WITH interventions.mesh_term AS intervention, COUNT(DISTINCT studies) AS study_count, AVG(studies.enrollment) AS avg_enrollment, SUM(studies.enrollment) AS total_enrollment WHERE study_count > 60 AND avg_enrollment > 140 RETURN intervention, study_count, avg_enrollment, total_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "What are the top 10 states with the most Phase 1 studies that have at least 5 industry sponsors?",
    "sql": "SELECT facilities.state, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT sponsors.sponsor_id) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id JOIN sponsors_studies ON studies.nct_id = sponsors_studies.nct_id JOIN sponsors ON sponsors_studies.sponsor_id = sponsors.sponsor_id WHERE studies.phase = 'Phase 1' AND sponsors.agency_class = 'INDUSTRY' AND facilities.country = 'United States' GROUP BY facilities.state HAVING COUNT(DISTINCT sponsors.sponsor_id) >= 5 ORDER BY COUNT(DISTINCT studies.nct_id) DESC LIMIT 10",
    "cypher": "MATCH (facilities)<-[AT_FACILITY]-(facilities_studies)<-[HAS_FACILITY_RECORD]-(studies)-[HAS_SPONSOR_RECORD]->(sponsors_studies)-[BY_SPONSOR]->(sponsors) WHERE studies.phase = 'Phase 1' AND sponsors.agency_class = 'INDUSTRY' AND facilities.country = 'United States' WITH facilities.state AS state, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT sponsors) AS sponsor_count WHERE sponsor_count >= 5 RETURN state, study_count, sponsor_count ORDER BY study_count DESC LIMIT 10"
  },
  {
    "question": "Which sponsors fund more than 90 studies with anticipated enrollment type across at least 18 conditions?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT conditions.condition_id), AVG(studies.enrollment) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN conditions_studies ON studies.nct_id = conditions_studies.nct_id JOIN conditions ON conditions_studies.condition_id = conditions.condition_id WHERE studies.enrollment_type = 'Anticipated' GROUP BY sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 90 AND COUNT(DISTINCT conditions.condition_id) >= 18 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsors)<-[BY_SPONSOR]-(sponsors_studies)<-[HAS_SPONSOR_RECORD]-(studies)-[HAS_CONDITION_RECORD]->(conditions_studies)-[FOR_CONDITION]->(conditions) WHERE studies.enrollment_type = 'Anticipated' WITH sponsors.name AS sponsor_name, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT conditions) AS condition_count, AVG(studies.enrollment) AS avg_enrollment WHERE study_count > 90 AND condition_count >= 18 RETURN sponsor_name, study_count, condition_count, avg_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "What conditions are studied in more than 95 studies with primary outcomes and at least 200 total primary outcomes?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id), COUNT(outcomes.id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN outcomes ON studies.nct_id = outcomes.nct_id WHERE outcomes.outcome_type = 'Primary' GROUP BY conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 95 AND COUNT(outcomes.id) >= 200 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (conditions)<-[FOR_CONDITION]-(conditions_studies)<-[HAS_CONDITION_RECORD]-(studies)-[HAS_OUTCOME]->(outcomes) WHERE outcomes.outcome_type = 'Primary' WITH conditions.mesh_term AS condition, COUNT(DISTINCT studies) AS study_count, COUNT(outcomes) AS outcome_count WHERE study_count > 95 AND outcome_count >= 200 RETURN condition, study_count, outcome_count ORDER BY study_count DESC"
  },
  {
    "question": "Which facilities conduct more than 48 studies for conditions with at least 10 different interventions tested?",
    "sql": "SELECT facilities.name, facilities.city, facilities.state, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT conditions.condition_id), COUNT(DISTINCT interventions.intervention_id) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id JOIN conditions_studies ON studies.nct_id = conditions_studies.nct_id JOIN conditions ON conditions_studies.condition_id = conditions.condition_id JOIN interventions_studies ON studies.nct_id = interventions_studies.nct_id JOIN interventions ON interventions_studies.intervention_id = interventions.intervention_id GROUP BY facilities.name, facilities.city, facilities.state HAVING COUNT(DISTINCT studies.nct_id) > 48 AND COUNT(DISTINCT interventions.intervention_id) >= 10 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (facilities)<-[AT_FACILITY]-(facilities_studies)<-[HAS_FACILITY_RECORD]-(studies)-[HAS_CONDITION_RECORD]->(conditions_studies)-[FOR_CONDITION]->(conditions), (studies)-[HAS_INTERVENTION_RECORD]->(interventions_studies)-[FOR_INTERVENTION]->(interventions) WITH facilities.name AS facility_name, facilities.city AS city, facilities.state AS state, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT conditions) AS condition_count, COUNT(DISTINCT interventions) AS intervention_count WHERE study_count > 48 AND intervention_count >= 10 RETURN facility_name, city, state, study_count, condition_count, intervention_count ORDER BY study_count DESC"
  },
  {
    "question": "What interventions are tested in more than 70 studies with enrollment between 200 and 1000 participants?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id), AVG(studies.enrollment), MIN(studies.enrollment), MAX(studies.enrollment) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id WHERE studies.enrollment BETWEEN 200 AND 1000 GROUP BY interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 70 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (interventions)<-[FOR_INTERVENTION]-(interventions_studies)<-[HAS_INTERVENTION_RECORD]-(studies) WHERE studies.enrollment >= 200 AND studies.enrollment <= 1000 WITH interventions.mesh_term AS intervention, COUNT(DISTINCT studies) AS study_count, AVG(studies.enrollment) AS avg_enrollment, MIN(studies.enrollment) AS min_enrollment, MAX(studies.enrollment) AS max_enrollment WHERE study_count > 70 RETURN intervention, study_count, avg_enrollment, min_enrollment, max_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "Which conditions are studied in more than 65 studies with both withdrawal data and adverse event reports?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT drop_withdrawals.id), COUNT(DISTINCT reported_event_totals.id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN drop_withdrawals ON studies.nct_id = drop_withdrawals.nct_id JOIN reported_event_totals ON studies.nct_id = reported_event_totals.nct_id GROUP BY conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 65 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (conditions)<-[FOR_CONDITION]-(conditions_studies)<-[HAS_CONDITION_RECORD]-(studies)-[HAS_WITHDRAWAL]->(drop_withdrawals), (studies)-[HAS_EVENT_TOTAL]->(reported_event_totals) WITH conditions.mesh_term AS condition, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT drop_withdrawals) AS withdrawal_count, COUNT(DISTINCT reported_event_totals) AS event_count WHERE study_count > 65 RETURN condition, study_count, withdrawal_count, event_count ORDER BY study_count DESC"
  },
  {
    "question": "What are the top 12 sponsors by number of studies in observational research with at least 10 facilities involved?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT facilities.facility_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN facilities_studies ON studies.nct_id = facilities_studies.nct_id JOIN facilities ON facilities_studies.facility_id = facilities.facility_id WHERE studies.study_type = 'Observational' GROUP BY sponsors.name HAVING COUNT(DISTINCT facilities.facility_id) >= 10 ORDER BY COUNT(DISTINCT studies.nct_id) DESC LIMIT 12",
    "cypher": "MATCH (sponsors)<-[BY_SPONSOR]-(sponsors_studies)<-[HAS_SPONSOR_RECORD]-(studies)-[HAS_FACILITY_RECORD]->(facilities_studies)-[AT_FACILITY]->(facilities) WHERE studies.study_type = 'Observational' WITH sponsors.name AS sponsor_name, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT facilities) AS facility_count WHERE facility_count >= 10 RETURN sponsor_name, study_count, facility_count ORDER BY study_count DESC LIMIT 12"
  },
  {
    "question": "Which facilities in Illinois conduct more than 42 studies with triple or quadruple masking and total enrollment over 8500?",
    "sql": "SELECT facilities.name, facilities.city, COUNT(DISTINCT studies.nct_id), SUM(studies.enrollment) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE facilities.state = 'Illinois' AND designs.masking IN ('Triple', 'Quadruple') AND studies.enrollment IS NOT NULL GROUP BY facilities.name, facilities.city HAVING COUNT(DISTINCT studies.nct_id) > 42 AND SUM(studies.enrollment) > 8500 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (facilities)<-[AT_FACILITY]-(facilities_studies)<-[HAS_FACILITY_RECORD]-(studies)-[HAS_DESIGN]->(designs) WHERE facilities.state = 'Illinois' AND designs.masking IN ['Triple', 'Quadruple'] AND studies.enrollment IS NOT NULL WITH facilities.name AS facility_name, facilities.city AS city, COUNT(DISTINCT studies) AS study_count, SUM(studies.enrollment) AS total_enrollment WHERE study_count > 42 AND total_enrollment > 8500 RETURN facility_name, city, study_count, total_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "What interventions are tested in more than 55 prevention studies across at least 22 different facilities?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT facilities.facility_id), AVG(studies.enrollment) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id JOIN facilities_studies ON studies.nct_id = facilities_studies.nct_id JOIN facilities ON facilities_studies.facility_id = facilities.facility_id WHERE designs.primary_purpose = 'Prevention' GROUP BY interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 55 AND COUNT(DISTINCT facilities.facility_id) >= 22 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (interventions)<-[FOR_INTERVENTION]-(interventions_studies)<-[HAS_INTERVENTION_RECORD]-(studies)-[HAS_DESIGN]->(designs), (studies)-[HAS_FACILITY_RECORD]->(facilities_studies)-[AT_FACILITY]->(facilities) WHERE designs.primary_purpose = 'Prevention' WITH interventions.mesh_term AS intervention, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT facilities) AS facility_count, AVG(studies.enrollment) AS avg_enrollment WHERE study_count > 55 AND facility_count >= 22 RETURN intervention, study_count, facility_count, avg_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "Which conditions have more than 130 studies with Federal or NIH sponsorship and average enrollment over 165?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id), AVG(studies.enrollment), COUNT(DISTINCT sponsors.sponsor_id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN sponsors_studies ON studies.nct_id = sponsors_studies.nct_id JOIN sponsors ON sponsors_studies.sponsor_id = sponsors.sponsor_id WHERE sponsors.agency_class IN ('FED', 'NIH') AND studies.enrollment IS NOT NULL GROUP BY conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 130 AND AVG(studies.enrollment) > 165 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (conditions)<-[FOR_CONDITION]-(conditions_studies)<-[HAS_CONDITION_RECORD]-(studies)-[HAS_SPONSOR_RECORD]->(sponsors_studies)-[BY_SPONSOR]->(sponsors) WHERE sponsors.agency_class IN ['FED', 'NIH'] AND studies.enrollment IS NOT NULL WITH conditions.mesh_term AS condition, COUNT(DISTINCT studies) AS study_count, AVG(studies.enrollment) AS avg_enrollment, COUNT(DISTINCT sponsors) AS sponsor_count WHERE study_count > 130 AND avg_enrollment > 165 RETURN condition, study_count, avg_enrollment, sponsor_count ORDER BY study_count DESC"
  },
  [
  {
    "question": "Which sponsors fund more than 60 studies testing interventions in at least 20 facilities across 10 states?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT facilities.facility_id), COUNT(DISTINCT facilities.state) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN interventions_studies ON studies.nct_id = interventions_studies.nct_id JOIN facilities_studies ON studies.nct_id = facilities_studies.nct_id JOIN facilities ON facilities_studies.facility_id = facilities.facility_id WHERE facilities.country = 'United States' GROUP BY sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 60 AND COUNT(DISTINCT facilities.facility_id) >= 20 AND COUNT(DISTINCT facilities.state) >= 10 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsors)<-[BY_SPONSOR]-(sponsors_studies)<-[HAS_SPONSOR_RECORD]-(studies)-[HAS_INTERVENTION_RECORD]->(interventions_studies), (studies)-[HAS_FACILITY_RECORD]->(facilities_studies)-[AT_FACILITY]->(facilities) WHERE facilities.country = 'United States' WITH sponsors.name AS sponsor_name, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT facilities) AS facility_count, COUNT(DISTINCT facilities.state) AS state_count WHERE study_count > 60 AND facility_count >= 20 AND state_count >= 10 RETURN sponsor_name, study_count, facility_count, state_count ORDER BY study_count DESC"
  },
  {
    "question": "What are the top 5 conditions with the most studies that have withdrawn participants for adverse events?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id), AVG(drop_withdrawals.count) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN drop_withdrawals ON studies.nct_id = drop_withdrawals.nct_id WHERE drop_withdrawals.reason LIKE '%Adverse Event%' GROUP BY conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) >= 10 ORDER BY COUNT(DISTINCT studies.nct_id) DESC LIMIT 5",
    "cypher": "MATCH (conditions)<-[FOR_CONDITION]-(conditions_studies)<-[HAS_CONDITION_RECORD]-(studies)-[HAS_WITHDRAWAL]->(drop_withdrawals) WHERE drop_withdrawals.reason CONTAINS 'Adverse Event' WITH conditions.mesh_term AS condition, COUNT(DISTINCT studies) AS study_count, AVG(drop_withdrawals.count) AS avg_withdrawals WHERE study_count >= 10 RETURN condition, study_count, avg_withdrawals ORDER BY study_count DESC LIMIT 5"
  },
  {
    "question": "Which interventions are tested in more than 25 screening studies with total enrollment exceeding 8000?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id), SUM(studies.enrollment) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE designs.primary_purpose = 'Screening' AND studies.enrollment IS NOT NULL GROUP BY interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 25 AND SUM(studies.enrollment) > 8000 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (interventions)<-[FOR_INTERVENTION]-(interventions_studies)<-[HAS_INTERVENTION_RECORD]-(studies)-[HAS_DESIGN]->(designs) WHERE designs.primary_purpose = 'Screening' AND studies.enrollment IS NOT NULL WITH interventions.mesh_term AS intervention, COUNT(DISTINCT studies) AS study_count, SUM(studies.enrollment) AS total_enrollment WHERE study_count > 25 AND total_enrollment > 8000 RETURN intervention, study_count, total_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "What facilities in Texas conduct more than 35 FDA regulated studies across at least 12 different conditions?",
    "sql": "SELECT facilities.name, facilities.city, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT conditions.condition_id) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id JOIN conditions_studies ON studies.nct_id = conditions_studies.nct_id JOIN conditions ON conditions_studies.condition_id = conditions.condition_id WHERE facilities.state = 'Texas' AND (studies.is_fda_regulated_drug = 'true' OR studies.is_fda_regulated_device = 'true') GROUP BY facilities.name, facilities.city HAVING COUNT(DISTINCT studies.nct_id) > 35 AND COUNT(DISTINCT conditions.condition_id) >= 12 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (facilities)<-[AT_FACILITY]-(facilities_studies)<-[HAS_FACILITY_RECORD]-(studies)-[HAS_CONDITION_RECORD]->(conditions_studies)-[FOR_CONDITION]->(conditions) WHERE facilities.state = 'Texas' AND (studies.is_fda_regulated_drug = 'true' OR studies.is_fda_regulated_device = 'true') WITH facilities.name AS facility_name, facilities.city AS city, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT conditions) AS condition_count WHERE study_count > 35 AND condition_count >= 12 RETURN facility_name, city, study_count, condition_count ORDER BY study_count DESC"
  },
  {
    "question": "Which conditions are studied in more than 80 randomized treatment studies with at least 2 different interventions tested?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT interventions.intervention_id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id JOIN interventions_studies ON studies.nct_id = interventions_studies.nct_id JOIN interventions ON interventions_studies.intervention_id = interventions.intervention_id WHERE designs.allocation = 'Randomized' AND designs.primary_purpose = 'Treatment' GROUP BY conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 80 AND COUNT(DISTINCT interventions.intervention_id) >= 2 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (conditions)<-[FOR_CONDITION]-(conditions_studies)<-[HAS_CONDITION_RECORD]-(studies)-[HAS_DESIGN]->(designs), (studies)-[HAS_INTERVENTION_RECORD]->(interventions_studies)-[FOR_INTERVENTION]->(interventions) WHERE designs.allocation = 'Randomized' AND designs.primary_purpose = 'Treatment' WITH conditions.mesh_term AS condition, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT interventions) AS intervention_count WHERE study_count > 80 AND intervention_count >= 2 RETURN condition, study_count, intervention_count ORDER BY study_count DESC"
  },
  {
    "question": "What are the top 10 sponsors by total enrollment in Phase 3 studies with at least 50 studies?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id), SUM(studies.enrollment) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id WHERE studies.phase = 'Phase 3' AND studies.enrollment IS NOT NULL GROUP BY sponsors.name HAVING COUNT(DISTINCT studies.nct_id) >= 50 ORDER BY SUM(studies.enrollment) DESC LIMIT 10",
    "cypher": "MATCH (sponsors)<-[BY_SPONSOR]-(sponsors_studies)<-[HAS_SPONSOR_RECORD]-(studies) WHERE studies.phase = 'Phase 3' AND studies.enrollment IS NOT NULL WITH sponsors.name AS sponsor_name, COUNT(DISTINCT studies) AS study_count, SUM(studies.enrollment) AS total_enrollment WHERE study_count >= 50 RETURN sponsor_name, study_count, total_enrollment ORDER BY total_enrollment DESC LIMIT 10"
  },
  {
    "question": "Which interventions are tested in more than 20 studies that reported serious adverse events with more than 20 subjects affected?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id), AVG(reported_event_totals.subjects_affected) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN reported_event_totals ON studies.nct_id = reported_event_totals.nct_id WHERE reported_event_totals.event_type = 'serious' AND reported_event_totals.subjects_affected > 20 GROUP BY interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 20 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (interventions)<-[FOR_INTERVENTION]-(interventions_studies)<-[HAS_INTERVENTION_RECORD]-(studies)-[HAS_EVENT_TOTAL]->(reported_event_totals) WHERE reported_event_totals.event_type = 'serious' AND reported_event_totals.subjects_affected > 20 WITH interventions.mesh_term AS intervention, COUNT(DISTINCT studies) AS study_count, AVG(reported_event_totals.subjects_affected) AS avg_affected WHERE study_count > 20 RETURN intervention, study_count, avg_affected ORDER BY study_count DESC"
  },
  {
    "question": "What conditions have more than 70 interventional studies with open label design and average enrollment over 120?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id), AVG(studies.enrollment) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE studies.study_type = 'Interventional' AND designs.masking = 'None (Open Label)' AND studies.enrollment IS NOT NULL GROUP BY conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 70 AND AVG(studies.enrollment) > 120 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (conditions)<-[FOR_CONDITION]-(conditions_studies)<-[HAS_CONDITION_RECORD]-(studies)-[HAS_DESIGN]->(designs) WHERE studies.study_type = 'Interventional' AND designs.masking = 'None (Open Label)' AND studies.enrollment IS NOT NULL WITH conditions.mesh_term AS condition, COUNT(DISTINCT studies) AS study_count, AVG(studies.enrollment) AS avg_enrollment WHERE study_count > 70 AND avg_enrollment > 120 RETURN condition, study_count, avg_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "Which facilities conduct more than 45 Phase 2 studies with at least 3 arms and total enrollment over 6000?",
    "sql": "SELECT facilities.name, facilities.city, facilities.state, COUNT(DISTINCT studies.nct_id), SUM(studies.enrollment) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id WHERE studies.phase = 'Phase 2' AND studies.number_of_arms >= 3 AND studies.enrollment IS NOT NULL GROUP BY facilities.name, facilities.city, facilities.state HAVING COUNT(DISTINCT studies.nct_id) > 45 AND SUM(studies.enrollment) > 6000 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (facilities)<-[AT_FACILITY]-(facilities_studies)<-[HAS_FACILITY_RECORD]-(studies) WHERE studies.phase = 'Phase 2' AND studies.number_of_arms >= 3 AND studies.enrollment IS NOT NULL WITH facilities.name AS facility_name, facilities.city AS city, facilities.state AS state, COUNT(DISTINCT studies) AS study_count, SUM(studies.enrollment) AS total_enrollment WHERE study_count > 45 AND total_enrollment > 6000 RETURN facility_name, city, state, study_count, total_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "What are the top 15 interventions by number of studies with primary outcomes that have p-values less than 0.01?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT outcome_analyses.id) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN outcomes ON studies.nct_id = outcomes.nct_id JOIN outcome_analyses ON outcomes.id = outcome_analyses.outcome_id WHERE outcomes.outcome_type = 'Primary' AND outcome_analyses.p_value < 0.01 GROUP BY interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) >= 5 ORDER BY COUNT(DISTINCT studies.nct_id) DESC LIMIT 15",
    "cypher": "MATCH (interventions)<-[FOR_INTERVENTION]-(interventions_studies)<-[HAS_INTERVENTION_RECORD]-(studies)-[HAS_OUTCOME]->(outcomes)-[HAS_ANALYSIS]->(outcome_analyses) WHERE outcomes.outcome_type = 'Primary' AND outcome_analyses.p_value < 0.01 WITH interventions.mesh_term AS intervention, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT outcome_analyses) AS analysis_count WHERE study_count >= 5 RETURN intervention, study_count, analysis_count ORDER BY study_count DESC LIMIT 15"
  },
  {
    "question": "Which sponsors fund more than 55 studies with probability sampling methods across multiple conditions?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT conditions.condition_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN eligibilities ON studies.nct_id = eligibilities.nct_id JOIN conditions_studies ON studies.nct_id = conditions_studies.nct_id JOIN conditions ON conditions_studies.condition_id = conditions.condition_id WHERE eligibilities.sampling_method = 'Probability Sample' GROUP BY sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 55 AND COUNT(DISTINCT conditions.condition_id) >= 8 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsors)<-[BY_SPONSOR]-(sponsors_studies)<-[HAS_SPONSOR_RECORD]-(studies)-[HAS_ELIGIBILITY]->(eligibilities), (studies)-[HAS_CONDITION_RECORD]->(conditions_studies)-[FOR_CONDITION]->(conditions) WHERE eligibilities.sampling_method = 'Probability Sample' WITH sponsors.name AS sponsor_name, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT conditions) AS condition_count WHERE study_count > 55 AND condition_count >= 8 RETURN sponsor_name, study_count, condition_count ORDER BY study_count DESC"
  },
  {
    "question": "What conditions are studied in more than 60 studies that include both children and adults with average enrollment over 150?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id), AVG(studies.enrollment) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN eligibilities ON studies.nct_id = eligibilities.nct_id WHERE eligibilities.child = 'true' AND eligibilities.adult = 'true' AND studies.enrollment IS NOT NULL GROUP BY conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 60 AND AVG(studies.enrollment) > 150 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (conditions)<-[FOR_CONDITION]-(conditions_studies)<-[HAS_CONDITION_RECORD]-(studies)-[HAS_ELIGIBILITY]->(eligibilities) WHERE eligibilities.child = 'true' AND eligibilities.adult = 'true' AND studies.enrollment IS NOT NULL WITH conditions.mesh_term AS condition, COUNT(DISTINCT studies) AS study_count, AVG(studies.enrollment) AS avg_enrollment WHERE study_count > 60 AND avg_enrollment > 150 RETURN condition, study_count, avg_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "Which facilities in California conduct more than 50 studies with secondary outcomes across at least 15 conditions?",
    "sql": "SELECT facilities.name, facilities.city, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT conditions.condition_id), COUNT(outcomes.id) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id JOIN outcomes ON studies.nct_id = outcomes.nct_id JOIN conditions_studies ON studies.nct_id = conditions_studies.nct_id JOIN conditions ON conditions_studies.condition_id = conditions.condition_id WHERE facilities.state = 'California' AND outcomes.outcome_type = 'Secondary' GROUP BY facilities.name, facilities.city HAVING COUNT(DISTINCT studies.nct_id) > 50 AND COUNT(DISTINCT conditions.condition_id) >= 15 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (facilities)<-[AT_FACILITY]-(facilities_studies)<-[HAS_FACILITY_RECORD]-(studies)-[HAS_OUTCOME]->(outcomes), (studies)-[HAS_CONDITION_RECORD]->(conditions_studies)-[FOR_CONDITION]->(conditions) WHERE facilities.state = 'California' AND outcomes.outcome_type = 'Secondary' WITH facilities.name AS facility_name, facilities.city AS city, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT conditions) AS condition_count, COUNT(outcomes) AS outcome_count WHERE study_count > 50 AND condition_count >= 15 RETURN facility_name, city, study_count, condition_count, outcome_count ORDER BY study_count DESC"
  },
  {
    "question": "What interventions are tested in more than 35 supportive care studies with enrollment over 50?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id), AVG(studies.enrollment), SUM(studies.enrollment) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE designs.primary_purpose = 'Supportive Care' AND studies.enrollment > 50 GROUP BY interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 35 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (interventions)<-[FOR_INTERVENTION]-(interventions_studies)<-[HAS_INTERVENTION_RECORD]-(studies)-[HAS_DESIGN]->(designs) WHERE designs.primary_purpose = 'Supportive Care' AND studies.enrollment > 50 WITH interventions.mesh_term AS intervention, COUNT(DISTINCT studies) AS study_count, AVG(studies.enrollment) AS avg_enrollment, SUM(studies.enrollment) AS total_enrollment WHERE study_count > 35 RETURN intervention, study_count, avg_enrollment, total_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "Which conditions have more than 90 Phase 2 or Phase 3 studies with total enrollment exceeding 25000?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id), SUM(studies.enrollment), AVG(studies.enrollment) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id WHERE studies.phase IN ('Phase 2', 'Phase 3') AND studies.enrollment IS NOT NULL GROUP BY conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 90 AND SUM(studies.enrollment) > 25000 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (conditions)<-[FOR_CONDITION]-(conditions_studies)<-[HAS_CONDITION_RECORD]-(studies) WHERE studies.phase IN ['Phase 2', 'Phase 3'] AND studies.enrollment IS NOT NULL WITH conditions.mesh_term AS condition, COUNT(DISTINCT studies) AS study_count, SUM(studies.enrollment) AS total_enrollment, AVG(studies.enrollment) AS avg_enrollment WHERE study_count > 90 AND total_enrollment > 25000 RETURN condition, study_count, total_enrollment, avg_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "What are the top 10 cities by number of observational cohort studies with total enrollment over 15000?",
    "sql": "SELECT facilities.city, facilities.state, COUNT(DISTINCT studies.nct_id), SUM(studies.enrollment) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE studies.study_type = 'Observational' AND designs.observational_model = 'Cohort' AND studies.enrollment IS NOT NULL GROUP BY facilities.city, facilities.state HAVING SUM(studies.enrollment) > 15000 ORDER BY COUNT(DISTINCT studies.nct_id) DESC LIMIT 10",
    "cypher": "MATCH (facilities)<-[AT_FACILITY]-(facilities_studies)<-[HAS_FACILITY_RECORD]-(studies)-[HAS_DESIGN]->(designs) WHERE studies.study_type = 'Observational' AND designs.observational_model = 'Cohort' AND studies.enrollment IS NOT NULL WITH facilities.city AS city, facilities.state AS state, COUNT(DISTINCT studies) AS study_count, SUM(studies.enrollment) AS total_enrollment WHERE total_enrollment > 15000 RETURN city, state, study_count, total_enrollment ORDER BY study_count DESC LIMIT 10"
  },
  {
    "question": "Which sponsors fund more than 80 studies with double masking across at least 30 different facilities?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT facilities.facility_id) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id JOIN facilities_studies ON studies.nct_id = facilities_studies.nct_id JOIN facilities ON facilities_studies.facility_id = facilities.facility_id WHERE designs.masking = 'Double' GROUP BY sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 80 AND COUNT(DISTINCT facilities.facility_id) >= 30 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsors)<-[BY_SPONSOR]-(sponsors_studies)<-[HAS_SPONSOR_RECORD]-(studies)-[HAS_DESIGN]->(designs), (studies)-[HAS_FACILITY_RECORD]->(facilities_studies)-[AT_FACILITY]->(facilities) WHERE designs.masking = 'Double' WITH sponsors.name AS sponsor_name, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT facilities) AS facility_count WHERE study_count > 80 AND facility_count >= 30 RETURN sponsor_name, study_count, facility_count ORDER BY study_count DESC"
  },
  {
    "question": "What interventions are tested in more than 50 studies with retrospective time perspective and enrollment over 100?",
    "sql": "SELECT interventions.mesh_term, COUNT(DISTINCT studies.nct_id), AVG(studies.enrollment) FROM interventions JOIN interventions_studies ON interventions.intervention_id = interventions_studies.intervention_id JOIN studies ON interventions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id WHERE designs.time_perspective = 'Retrospective' AND studies.enrollment > 100 GROUP BY interventions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 50 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (interventions)<-[FOR_INTERVENTION]-(interventions_studies)<-[HAS_INTERVENTION_RECORD]-(studies)-[HAS_DESIGN]->(designs) WHERE designs.time_perspective = 'Retrospective' AND studies.enrollment > 100 WITH interventions.mesh_term AS intervention, COUNT(DISTINCT studies) AS study_count, AVG(studies.enrollment) AS avg_enrollment WHERE study_count > 50 RETURN intervention, study_count, avg_enrollment ORDER BY study_count DESC"
  },
  {
    "question": "Which conditions are studied in more than 45 sequential assignment trials across at least 10 different sponsors?",
    "sql": "SELECT conditions.mesh_term, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT sponsors.sponsor_id) FROM conditions JOIN conditions_studies ON conditions.condition_id = conditions_studies.condition_id JOIN studies ON conditions_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id JOIN sponsors_studies ON studies.nct_id = sponsors_studies.nct_id JOIN sponsors ON sponsors_studies.sponsor_id = sponsors.sponsor_id WHERE designs.intervention_model = 'Sequential Assignment' GROUP BY conditions.mesh_term HAVING COUNT(DISTINCT studies.nct_id) > 45 AND COUNT(DISTINCT sponsors.sponsor_id) >= 10 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (conditions)<-[FOR_CONDITION]-(conditions_studies)<-[HAS_CONDITION_RECORD]-(studies)-[HAS_DESIGN]->(designs), (studies)-[HAS_SPONSOR_RECORD]->(sponsors_studies)-[BY_SPONSOR]->(sponsors) WHERE designs.intervention_model = 'Sequential Assignment' WITH conditions.mesh_term AS condition, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT sponsors) AS sponsor_count WHERE study_count > 45 AND sponsor_count >= 10 RETURN condition, study_count, sponsor_count ORDER BY study_count DESC"
  },
  {
    "question": "What are the top 8 cities by number of studies with outcome analyses showing confidence intervals and at least 30 studies?",
    "sql": "SELECT facilities.city, facilities.state, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT outcome_analyses.id) FROM facilities JOIN facilities_studies ON facilities.facility_id = facilities_studies.facility_id JOIN studies ON facilities_studies.nct_id = studies.nct_id JOIN outcomes ON studies.nct_id = outcomes.nct_id JOIN outcome_analyses ON outcomes.id = outcome_analyses.outcome_id WHERE outcome_analyses.ci_lower_limit IS NOT NULL AND outcome_analyses.ci_upper_limit IS NOT NULL GROUP BY facilities.city, facilities.state HAVING COUNT(DISTINCT studies.nct_id) >= 30 ORDER BY COUNT(DISTINCT studies.nct_id) DESC LIMIT 8",
    "cypher": "MATCH (facilities)<-[AT_FACILITY]-(facilities_studies)<-[HAS_FACILITY_RECORD]-(studies)-[HAS_OUTCOME]->(outcomes)-[HAS_ANALYSIS]->(outcome_analyses) WHERE outcome_analyses.ci_lower_limit IS NOT NULL AND outcome_analyses.ci_upper_limit IS NOT NULL WITH facilities.city AS city, facilities.state AS state, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT outcome_analyses) AS analysis_count WHERE study_count >= 30 RETURN city, state, study_count, analysis_count ORDER BY study_count DESC LIMIT 8"
  },
  {
    "question": "Which sponsors fund more than 72 Phase 2 studies with randomized allocation across at least 14 different conditions?",
    "sql": "SELECT sponsors.name, COUNT(DISTINCT studies.nct_id), COUNT(DISTINCT conditions.condition_id), AVG(studies.enrollment) FROM sponsors JOIN sponsors_studies ON sponsors.sponsor_id = sponsors_studies.sponsor_id JOIN studies ON sponsors_studies.nct_id = studies.nct_id JOIN designs ON studies.nct_id = designs.nct_id JOIN conditions_studies ON studies.nct_id = conditions_studies.nct_id JOIN conditions ON conditions_studies.condition_id = conditions.condition_id WHERE studies.phase = 'Phase 2' AND designs.allocation = 'Randomized' GROUP BY sponsors.name HAVING COUNT(DISTINCT studies.nct_id) > 72 AND COUNT(DISTINCT conditions.condition_id) >= 14 ORDER BY COUNT(DISTINCT studies.nct_id) DESC",
    "cypher": "MATCH (sponsors)<-[BY_SPONSOR]-(sponsors_studies)<-[HAS_SPONSOR_RECORD]-(studies)-[HAS_DESIGN]->(designs), (studies)-[HAS_CONDITION_RECORD]->(conditions_studies)-[FOR_CONDITION]->(conditions) WHERE studies.phase = 'Phase 2' AND designs.allocation = 'Randomized' WITH sponsors.name AS sponsor_name, COUNT(DISTINCT studies) AS study_count, COUNT(DISTINCT conditions) AS condition_count, AVG(studies.enrollment) AS avg_enrollment WHERE study_count > 72 AND condition_count >= 14 RETURN sponsor_name, study_count, condition_count, avg_enrollment ORDER BY study_count DESC"
  }
]