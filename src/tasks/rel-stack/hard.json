[
  {
    "question": "Which users have written more than 5 comments on posts tagged with 'python' and have earned at least 3 badges?",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT comments.Id), COUNT(DISTINCT badges.Id) FROM users JOIN comments ON users.Id = comments.UserId JOIN posts ON comments.PostId = posts.Id JOIN badges ON users.Id = badges.UserId WHERE posts.Tags LIKE '%python%' GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT comments.Id) > 5 AND COUNT(DISTINCT badges.Id) >= 3 ORDER BY COUNT(DISTINCT comments.Id) DESC",
    "cypher": "MATCH (user:users)-[:WROTE]->(comment:comments)-[:IS_ON]->(post:posts), (user)-[:EARNED]->(badge:badges) WHERE post.Tags CONTAINS 'python' WITH user, count(DISTINCT comment) AS commentCount, count(DISTINCT badge) AS badgeCount WHERE commentCount > 5 AND badgeCount >= 3 RETURN user.DisplayName, commentCount, badgeCount ORDER BY commentCount DESC"
  },
  {
    "question": "Find posts that have received more than 10 votes and have at least 3 comments from users located in the United States",
    "sql": "SELECT posts.Title, COUNT(DISTINCT votes.Id), COUNT(DISTINCT comments.Id) FROM posts JOIN votes ON posts.Id = votes.PostId JOIN comments ON posts.Id = comments.PostId JOIN users ON comments.UserId = users.Id WHERE users.Location LIKE '%United States%' GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT votes.Id) > 10 AND COUNT(DISTINCT comments.Id) >= 3 ORDER BY COUNT(DISTINCT votes.Id) DESC",
    "cypher": "MATCH (vote:votes)-[:VOTED_ON]->(post:posts)<-[:IS_ON]-(comment:comments)<-[:WROTE]-(user:users) WHERE user.Location CONTAINS 'United States' WITH post, count(DISTINCT vote) AS voteCount, count(DISTINCT comment) AS commentCount WHERE voteCount > 10 AND commentCount >= 3 RETURN post.Title, voteCount, commentCount ORDER BY voteCount DESC"
  },
  {
    "question": "Which users own posts with accepted answers and have written more than 2 comments on other posts?",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT posts.Id), COUNT(DISTINCT comments.Id) FROM users JOIN posts ON users.Id = posts.OwnerUserId JOIN comments ON users.Id = comments.UserId WHERE posts.AcceptedAnswerId IS NOT NULL AND comments.PostId != posts.Id GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT posts.Id) >= 1 AND COUNT(DISTINCT comments.Id) > 2 ORDER BY COUNT(DISTINCT posts.Id) DESC",
    "cypher": "MATCH (user:users)-[:OWNS]->(post:posts), (user)-[:WROTE]->(comment:comments)-[:IS_ON]->(otherPost:posts) WHERE post.AcceptedAnswerId <> '' AND post.Id <> otherPost.Id WITH user, count(DISTINCT post) AS postCount, count(DISTINCT comment) AS commentCount WHERE postCount >= 1 AND commentCount > 2 RETURN user.DisplayName, postCount, commentCount ORDER BY postCount DESC"
  },
  {
    "question": "Find users who have earned badges of all three classes (1, 2, and 3) and have created at least 2 posts",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT badges.Class), COUNT(DISTINCT posts.Id) FROM users JOIN badges ON users.Id = badges.UserId JOIN posts ON users.Id = posts.OwnerUserId WHERE badges.Class IN (1, 2, 3) GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT badges.Class) = 3 AND COUNT(DISTINCT posts.Id) >= 2 ORDER BY COUNT(DISTINCT posts.Id) DESC",
    "cypher": "MATCH (user:users)-[:EARNED]->(badge:badges), (user)-[:OWNS]->(post:posts) WHERE badge.Class IN ['1', '2', '3'] WITH user, count(DISTINCT badge.Class) AS classCount, count(DISTINCT post) AS postCount WHERE classCount = 3 AND postCount >= 2 RETURN user.DisplayName, classCount, postCount ORDER BY postCount DESC"
  },
  {
    "question": "Which posts have been edited more than 3 times and received upvotes (VoteTypeId 2) from at least 2 different users?",
    "sql": "SELECT posts.Title, COUNT(DISTINCT postHistory.Id), COUNT(DISTINCT votes.UserId) FROM posts JOIN postHistory ON posts.Id = postHistory.PostId JOIN votes ON posts.Id = votes.PostId WHERE votes.VoteTypeId = 2 GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT postHistory.Id) > 3 AND COUNT(DISTINCT votes.UserId) >= 2 ORDER BY COUNT(DISTINCT postHistory.Id) DESC",
    "cypher": "MATCH (ph:postHistory)-[:RELATES_TO]->(post:posts)<-[:VOTED_ON]-(vote:votes) WHERE vote.VoteTypeId = '2' WITH post, count(DISTINCT ph) AS editCount, count(DISTINCT vote.UserId) AS voterCount WHERE editCount > 3 AND voterCount >= 2 RETURN post.Title, editCount, voterCount ORDER BY editCount DESC"
  },
  {
    "question": "Find users in Europe who have written comments on posts tagged with 'javascript' and earned more than 5 badges",
    "sql": "SELECT users.DisplayName, users.Location, COUNT(DISTINCT comments.Id), COUNT(DISTINCT badges.Id) FROM users JOIN comments ON users.Id = comments.UserId JOIN posts ON comments.PostId = posts.Id JOIN badges ON users.Id = badges.UserId WHERE (users.Location LIKE '%UK%' OR users.Location LIKE '%Germany%' OR users.Location LIKE '%France%') AND posts.Tags LIKE '%javascript%' GROUP BY users.Id, users.DisplayName, users.Location HAVING COUNT(DISTINCT badges.Id) > 5 ORDER BY COUNT(DISTINCT badges.Id) DESC",
    "cypher": "MATCH (user:users)-[:WROTE]->(comment:comments)-[:IS_ON]->(post:posts), (user)-[:EARNED]->(badge:badges) WHERE (user.Location CONTAINS 'UK' OR user.Location CONTAINS 'Germany' OR user.Location CONTAINS 'France') AND post.Tags CONTAINS 'javascript' WITH user, count(DISTINCT comment) AS commentCount, count(DISTINCT badge) AS badgeCount WHERE badgeCount > 5 RETURN user.DisplayName, user.Location, commentCount, badgeCount ORDER BY badgeCount DESC"
  },
  {
    "question": "Which posts have comments from more than 3 distinct users and have been linked to other posts?",
    "sql": "SELECT posts.Title, COUNT(DISTINCT comments.UserId), COUNT(DISTINCT postLinks.Id) FROM posts JOIN comments ON posts.Id = comments.PostId JOIN postLinks ON posts.Id = postLinks.PostId GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT comments.UserId) > 3 AND COUNT(DISTINCT postLinks.Id) >= 1 ORDER BY COUNT(DISTINCT comments.UserId) DESC",
    "cypher": "MATCH (comment:comments)-[:IS_ON]->(post:posts)-[:HAS_LINK]->(pl:postLinks) WITH post, count(DISTINCT comment.UserId) AS commenterCount, count(DISTINCT pl) AS linkCount WHERE commenterCount > 3 AND linkCount >= 1 RETURN post.Title, commenterCount, linkCount ORDER BY commenterCount DESC"
  },
  {
    "question": "Find users who have cast more than 10 votes on posts they did not create and have earned at least 2 tag-based badges",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT votes.Id), COUNT(DISTINCT badges.Id) FROM users JOIN votes ON users.Id = votes.UserId JOIN posts ON votes.PostId = posts.Id JOIN badges ON users.Id = badges.UserId WHERE posts.OwnerUserId != users.Id AND badges.TagBased = true GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT votes.Id) > 10 AND COUNT(DISTINCT badges.Id) >= 2 ORDER BY COUNT(DISTINCT votes.Id) DESC",
    "cypher": "MATCH (user:users)-[:CAST]->(vote:votes)-[:VOTED_ON]->(post:posts), (user)-[:EARNED]->(badge:badges) WHERE post.OwnerUserId <> user.Id AND badge.TagBased = 'true' WITH user, count(DISTINCT vote) AS voteCount, count(DISTINCT badge) AS badgeCount WHERE voteCount > 10 AND badgeCount >= 2 RETURN user.DisplayName, voteCount, badgeCount ORDER BY voteCount DESC"
  },
  {
    "question": "Which users have created posts in multiple content licenses and have more than 5 comments across all their posts?",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT posts.ContentLicense), COUNT(DISTINCT comments.Id) FROM users JOIN posts ON users.Id = posts.OwnerUserId JOIN comments ON posts.Id = comments.PostId GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT posts.ContentLicense) > 1 AND COUNT(DISTINCT comments.Id) > 5 ORDER BY COUNT(DISTINCT comments.Id) DESC",
    "cypher": "MATCH (user:users)-[:OWNS]->(post:posts)<-[:IS_ON]-(comment:comments) WITH user, count(DISTINCT post.ContentLicense) AS licenseCount, count(DISTINCT comment) AS commentCount WHERE licenseCount > 1 AND commentCount > 5 RETURN user.DisplayName, licenseCount, commentCount ORDER BY commentCount DESC"
  },
  {
    "question": "Find posts created by users who joined before 2014 that have received votes after 2018 and have at least 2 comments",
    "sql": "SELECT posts.Title, users.DisplayName, COUNT(DISTINCT votes.Id), COUNT(DISTINCT comments.Id) FROM posts JOIN users ON posts.OwnerUserId = users.Id JOIN votes ON posts.Id = votes.PostId JOIN comments ON posts.Id = comments.PostId WHERE users.CreationDate < '2014-01-01 00:00:00' AND votes.CreationDate > '2018-01-01 00:00:00' GROUP BY posts.Id, posts.Title, users.DisplayName HAVING COUNT(DISTINCT comments.Id) >= 2 ORDER BY COUNT(DISTINCT votes.Id) DESC",
    "cypher": "MATCH (user:users)-[:OWNS]->(post:posts)<-[:VOTED_ON]-(vote:votes), (comment:comments)-[:IS_ON]->(post) WHERE user.CreationDate < '2014-01-01T00:00:00' AND vote.CreationDate > '2018-01-01T00:00:00' WITH post, user, count(DISTINCT vote) AS voteCount, count(DISTINCT comment) AS commentCount WHERE commentCount >= 2 RETURN post.Title, user.DisplayName, voteCount, commentCount ORDER BY voteCount DESC"
  },
  {
    "question": "Which users have edited posts they commented on and earned more than 3 badges?",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT postHistory.Id), COUNT(DISTINCT badges.Id) FROM users JOIN postHistory ON users.Id = postHistory.UserId JOIN comments ON users.Id = comments.UserId AND postHistory.PostId = comments.PostId JOIN badges ON users.Id = badges.UserId GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT postHistory.Id) >= 1 AND COUNT(DISTINCT badges.Id) > 3 ORDER BY COUNT(DISTINCT badges.Id) DESC",
    "cypher": "MATCH (user:users)-[:EDITED]->(ph:postHistory)-[:RELATES_TO]->(post:posts)<-[:IS_ON]-(comment:comments)<-[:WROTE]-(user), (user)-[:EARNED]->(badge:badges) WITH user, count(DISTINCT ph) AS editCount, count(DISTINCT badge) AS badgeCount WHERE editCount >= 1 AND badgeCount > 3 RETURN user.DisplayName, editCount, badgeCount ORDER BY badgeCount DESC"
  },
  {
    "question": "Find posts with more than 5 upvotes that have comments containing 'thanks' and were created after 2016",
    "sql": "SELECT posts.Title, COUNT(DISTINCT votes.Id), COUNT(DISTINCT comments.Id) FROM posts JOIN votes ON posts.Id = votes.PostId JOIN comments ON posts.Id = comments.PostId WHERE votes.VoteTypeId = 2 AND comments.Text LIKE '%thanks%' AND posts.CreationDate > '2016-01-01 00:00:00' GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT votes.Id) > 5 ORDER BY COUNT(DISTINCT votes.Id) DESC",
    "cypher": "MATCH (vote:votes)-[:VOTED_ON]->(post:posts)<-[:IS_ON]-(comment:comments) WHERE vote.VoteTypeId = '2' AND comment.Text CONTAINS 'thanks' AND post.CreationDate > '2016-01-01T00:00:00' WITH post, count(DISTINCT vote) AS voteCount, count(DISTINCT comment) AS commentCount WHERE voteCount > 5 RETURN post.Title, voteCount, commentCount ORDER BY voteCount DESC"
  },
  {
    "question": "Which users have written comments on posts owned by users in different locations and have more than 2 badges?",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT comments.Id), COUNT(DISTINCT badges.Id) FROM users JOIN comments ON users.Id = comments.UserId JOIN posts ON comments.PostId = posts.Id JOIN users AS postOwners ON posts.OwnerUserId = postOwners.Id JOIN badges ON users.Id = badges.UserId WHERE users.Location != postOwners.Location GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT comments.Id) >= 1 AND COUNT(DISTINCT badges.Id) > 2 ORDER BY COUNT(DISTINCT comments.Id) DESC",
    "cypher": "MATCH (user:users)-[:WROTE]->(comment:comments)-[:IS_ON]->(post:posts)<-[:OWNS]-(owner:users), (user)-[:EARNED]->(badge:badges) WHERE user.Location <> owner.Location WITH user, count(DISTINCT comment) AS commentCount, count(DISTINCT badge) AS badgeCount WHERE commentCount >= 1 AND badgeCount > 2 RETURN user.DisplayName, commentCount, badgeCount ORDER BY commentCount DESC"
  },
  {
    "question": "Find posts that have been voted on by more than 5 users and have at least 2 post history entries",
    "sql": "SELECT posts.Title, COUNT(DISTINCT votes.UserId), COUNT(DISTINCT postHistory.Id) FROM posts JOIN votes ON posts.Id = votes.PostId JOIN postHistory ON posts.Id = postHistory.PostId GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT votes.UserId) > 5 AND COUNT(DISTINCT postHistory.Id) >= 2 ORDER BY COUNT(DISTINCT votes.UserId) DESC",
    "cypher": "MATCH (vote:votes)-[:VOTED_ON]->(post:posts)<-[:RELATES_TO]-(ph:postHistory) WITH post, count(DISTINCT vote.UserId) AS voterCount, count(DISTINCT ph) AS historyCount WHERE voterCount > 5 AND historyCount >= 2 RETURN post.Title, voterCount, historyCount ORDER BY voterCount DESC"
  },
  {
    "question": "Which users have earned both 'Teacher' and 'Student' badges and have created more than 3 posts?",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT badges.Name), COUNT(DISTINCT posts.Id) FROM users JOIN badges ON users.Id = badges.UserId JOIN posts ON users.Id = posts.OwnerUserId WHERE badges.Name IN ('Teacher', 'Student') GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT badges.Name) = 2 AND COUNT(DISTINCT posts.Id) > 3 ORDER BY COUNT(DISTINCT posts.Id) DESC",
    "cypher": "MATCH (user:users)-[:EARNED]->(badge:badges), (user)-[:OWNS]->(post:posts) WHERE badge.Name IN ['Teacher', 'Student'] WITH user, count(DISTINCT badge.Name) AS badgeNames, count(DISTINCT post) AS postCount WHERE badgeNames = 2 AND postCount > 3 RETURN user.DisplayName, badgeNames, postCount ORDER BY postCount DESC"
  },
  {
    "question": "Find users who have commented on posts with more than 10 votes and have earned Class 1 badges",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT comments.Id), COUNT(DISTINCT badges.Id) FROM users JOIN comments ON users.Id = comments.UserId JOIN posts ON comments.PostId = posts.Id JOIN votes ON posts.Id = votes.PostId JOIN badges ON users.Id = badges.UserId WHERE badges.Class = 1 GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT votes.Id) > 10 ORDER BY COUNT(DISTINCT comments.Id) DESC",
    "cypher": "MATCH (user:users)-[:WROTE]->(comment:comments)-[:IS_ON]->(post:posts)<-[:VOTED_ON]-(vote:votes), (user)-[:EARNED]->(badge:badges) WHERE badge.Class = '1' WITH user, count(DISTINCT comment) AS commentCount, count(DISTINCT vote) AS voteCount WHERE voteCount > 10 RETURN user.DisplayName, commentCount, voteCount ORDER BY commentCount DESC"
  },
  {
    "question": "Which posts tagged with 'java' have comments from users who have earned more than 5 badges?",
    "sql": "SELECT posts.Title, COUNT(DISTINCT comments.Id), COUNT(DISTINCT badges.Id) FROM posts JOIN comments ON posts.Id = comments.PostId JOIN users ON comments.UserId = users.Id JOIN badges ON users.Id = badges.UserId WHERE posts.Tags LIKE '%java%' GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT badges.Id) > 5 ORDER BY COUNT(DISTINCT comments.Id) DESC",
    "cypher": "MATCH (comment:comments)-[:IS_ON]->(post:posts), (user:users)-[:WROTE]->(comment), (user)-[:EARNED]->(badge:badges) WHERE post.Tags CONTAINS 'java' WITH post, count(DISTINCT comment) AS commentCount, count(DISTINCT badge) AS badgeCount WHERE badgeCount > 5 RETURN post.Title, commentCount, badgeCount ORDER BY commentCount DESC"
  },
  {
    "question": "Find users who own posts with ParentId set and have cast more than 5 votes",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT posts.Id), COUNT(DISTINCT votes.Id) FROM users JOIN posts ON users.Id = posts.OwnerUserId JOIN votes ON users.Id = votes.UserId WHERE posts.ParentId IS NOT NULL GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT posts.Id) >= 1 AND COUNT(DISTINCT votes.Id) > 5 ORDER BY COUNT(DISTINCT votes.Id) DESC",
    "cypher": "MATCH (user:users)-[:OWNS]->(post:posts), (user)-[:CAST]->(vote:votes) WHERE post.ParentId <> '' WITH user, count(DISTINCT post) AS postCount, count(DISTINCT vote) AS voteCount WHERE postCount >= 1 AND voteCount > 5 RETURN user.DisplayName, postCount, voteCount ORDER BY voteCount DESC"
  },
  {
    "question": "Which posts have been linked to more than 2 other posts and have received comments from at least 3 users?",
    "sql": "SELECT posts.Title, COUNT(DISTINCT postLinks.RelatedPostId), COUNT(DISTINCT comments.UserId) FROM posts JOIN postLinks ON posts.Id = postLinks.PostId JOIN comments ON posts.Id = comments.PostId GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT postLinks.RelatedPostId) > 2 AND COUNT(DISTINCT comments.UserId) >= 3 ORDER BY COUNT(DISTINCT postLinks.RelatedPostId) DESC",
    "cypher": "MATCH (post:posts)-[:HAS_LINK]->(pl:postLinks), (comment:comments)-[:IS_ON]->(post) WITH post, count(DISTINCT pl.RelatedPostId) AS linkCount, count(DISTINCT comment.UserId) AS commenterCount WHERE linkCount > 2 AND commenterCount >= 3 RETURN post.Title, linkCount, commenterCount ORDER BY linkCount DESC"
  },
  {
    "question": "Find users in India who have written more than 3 comments and earned badges after 2017",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT comments.Id), COUNT(DISTINCT badges.Id) FROM users JOIN comments ON users.Id = comments.UserId JOIN badges ON users.Id = badges.UserId WHERE users.Location = 'India' AND badges.Date > '2017-01-01 00:00:00' GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT comments.Id) > 3 ORDER BY COUNT(DISTINCT badges.Id) DESC",
    "cypher": "MATCH (user:users)-[:WROTE]->(comment:comments), (user)-[:EARNED]->(badge:badges) WHERE user.Location = 'India' AND badge.Date > '2017-01-01T00:00:00' WITH user, count(DISTINCT comment) AS commentCount, count(DISTINCT badge) AS badgeCount WHERE commentCount > 3 RETURN user.DisplayName, commentCount, badgeCount ORDER BY badgeCount DESC"
  },
  {
    "question": "Which posts have PostTypeId 1 and received both upvotes and downvotes with at least 2 of each?",
    "sql": "SELECT posts.Title, SUM(CASE WHEN votes.VoteTypeId = 2 THEN 1 ELSE 0 END), SUM(CASE WHEN votes.VoteTypeId = 3 THEN 1 ELSE 0 END) FROM posts JOIN votes ON posts.Id = votes.PostId WHERE posts.PostTypeId = 1 AND votes.VoteTypeId IN (2, 3) GROUP BY posts.Id, posts.Title HAVING SUM(CASE WHEN votes.VoteTypeId = 2 THEN 1 ELSE 0 END) >= 2 AND SUM(CASE WHEN votes.VoteTypeId = 3 THEN 1 ELSE 0 END) >= 2 ORDER BY SUM(CASE WHEN votes.VoteTypeId = 2 THEN 1 ELSE 0 END) DESC",
    "cypher": "MATCH (vote:votes)-[:VOTED_ON]->(post:posts) WHERE post.PostTypeId = '1' AND vote.VoteTypeId IN ['2', '3'] WITH post, sum(CASE WHEN vote.VoteTypeId = '2' THEN 1 ELSE 0 END) AS upvotes, sum(CASE WHEN vote.VoteTypeId = '3' THEN 1 ELSE 0 END) AS downvotes WHERE upvotes >= 2 AND downvotes >= 2 RETURN post.Title, upvotes, downvotes ORDER BY upvotes DESC"
  },
  {
    "question": "Find users who have created posts with more than 5 comments and have more than 3 post history entries",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT comments.Id), COUNT(DISTINCT postHistory.Id) FROM users JOIN posts ON users.Id = posts.OwnerUserId JOIN comments ON posts.Id = comments.PostId JOIN postHistory ON posts.Id = postHistory.PostId GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT comments.Id) > 5 AND COUNT(DISTINCT postHistory.Id) > 3 ORDER BY COUNT(DISTINCT comments.Id) DESC",
    "cypher": "MATCH (user:users)-[:OWNS]->(post:posts)<-[:IS_ON]-(comment:comments), (ph:postHistory)-[:RELATES_TO]->(post) WITH user, count(DISTINCT comment) AS commentCount, count(DISTINCT ph) AS historyCount WHERE commentCount > 5 AND historyCount > 3 RETURN user.DisplayName, commentCount, historyCount ORDER BY commentCount DESC"
  },
  {
    "question": "Which users have earned more than 10 badges and have written comments on posts tagged with 'sql'?",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT badges.Id), COUNT(DISTINCT comments.Id) FROM users JOIN badges ON users.Id = badges.UserId JOIN comments ON users.Id = comments.UserId JOIN posts ON comments.PostId = posts.Id WHERE posts.Tags LIKE '%sql%' GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT badges.Id) > 10 ORDER BY COUNT(DISTINCT badges.Id) DESC",
    "cypher": "MATCH (user:users)-[:EARNED]->(badge:badges), (user)-[:WROTE]->(comment:comments)-[:IS_ON]->(post:posts) WHERE post.Tags CONTAINS 'sql' WITH user, count(DISTINCT badge) AS badgeCount, count(DISTINCT comment) AS commentCount WHERE badgeCount > 10 RETURN user.DisplayName, badgeCount, commentCount ORDER BY badgeCount DESC"
  },
  {
    "question": "Find posts created in 2017 that have more than 3 votes and at least 2 comments from different users",
    "sql": "SELECT posts.Title, COUNT(DISTINCT votes.Id), COUNT(DISTINCT comments.UserId) FROM posts JOIN votes ON posts.Id = votes.PostId JOIN comments ON posts.Id = comments.PostId WHERE posts.CreationDate >= '2017-01-01 00:00:00' AND posts.CreationDate < '2018-01-01 00:00:00' GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT votes.Id) > 3 AND COUNT(DISTINCT comments.UserId) >= 2 ORDER BY COUNT(DISTINCT votes.Id) DESC",
    "cypher": "MATCH (vote:votes)-[:VOTED_ON]->(post:posts)<-[:IS_ON]-(comment:comments) WHERE post.CreationDate >= '2017-01-01T00:00:00' AND post.CreationDate < '2018-01-01T00:00:00' WITH post, count(DISTINCT vote) AS voteCount, count(DISTINCT comment.UserId) AS commenterCount WHERE voteCount > 3 AND commenterCount >= 2 RETURN post.Title, voteCount, commenterCount ORDER BY voteCount DESC"
  },
  {
    "question": "Which users have more than 5 posts with accepted answers and have earned Class 2 badges?",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT posts.Id), COUNT(DISTINCT badges.Id) FROM users JOIN posts ON users.Id = posts.OwnerUserId JOIN badges ON users.Id = badges.UserId WHERE posts.AcceptedAnswerId IS NOT NULL AND badges.Class = 2 GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT posts.Id) > 5 ORDER BY COUNT(DISTINCT posts.Id) DESC",
    "cypher": "MATCH (user:users)-[:OWNS]->(post:posts), (user)-[:EARNED]->(badge:badges) WHERE post.AcceptedAnswerId <> '' AND badge.Class = '2' WITH user, count(DISTINCT post) AS postCount, count(DISTINCT badge) AS badgeCount WHERE postCount > 5 RETURN user.DisplayName, postCount, badgeCount ORDER BY postCount DESC"
  },
  {
    "question": "Find posts that have comments from users who have earned more than 3 different badge names",
    "sql": "SELECT posts.Title, COUNT(DISTINCT comments.Id), COUNT(DISTINCT badges.Name) FROM posts JOIN comments ON posts.Id = comments.PostId JOIN users ON comments.UserId = users.Id JOIN badges ON users.Id = badges.UserId GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT badges.Name) > 3 ORDER BY COUNT(DISTINCT comments.Id) DESC",
    "cypher": "MATCH (comment:comments)-[:IS_ON]->(post:posts), (user:users)-[:WROTE]->(comment), (user)-[:EARNED]->(badge:badges) WITH post, count(DISTINCT comment) AS commentCount, count(DISTINCT badge.Name) AS badgeNames WHERE badgeNames > 3 RETURN post.Title, commentCount, badgeNames ORDER BY commentCount DESC"
  },
  {
    "question": "Which users have voted on posts created by users in London and have written more than 2 comments?",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT votes.Id), COUNT(DISTINCT comments.Id) FROM users JOIN votes ON users.Id = votes.UserId JOIN posts ON votes.PostId = posts.Id JOIN users AS postOwners ON posts.OwnerUserId = postOwners.Id JOIN comments ON users.Id = comments.UserId WHERE postOwners.Location = 'London' GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT comments.Id) > 2 ORDER BY COUNT(DISTINCT votes.Id) DESC",
    "cypher": "MATCH (user:users)-[:CAST]->(vote:votes)-[:VOTED_ON]->(post:posts)<-[:OWNS]-(owner:users), (user)-[:WROTE]->(comment:comments) WHERE owner.Location = 'London' WITH user, count(DISTINCT vote) AS voteCount, count(DISTINCT comment) AS commentCount WHERE commentCount > 2 RETURN user.DisplayName, voteCount, commentCount ORDER BY voteCount DESC"
  },
  {
    "question": "Find posts with titles containing 'error' that have more than 2 edits and at least 5 votes",
    "sql": "SELECT posts.Title, COUNT(DISTINCT postHistory.Id), COUNT(DISTINCT votes.Id) FROM posts JOIN postHistory ON posts.Id = postHistory.PostId JOIN votes ON posts.Id = votes.PostId WHERE posts.Title LIKE '%error%' GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT postHistory.Id) > 2 AND COUNT(DISTINCT votes.Id) >= 5 ORDER BY COUNT(DISTINCT votes.Id) DESC",
    "cypher": "MATCH (ph:postHistory)-[:RELATES_TO]->(post:posts)<-[:VOTED_ON]-(vote:votes) WHERE post.Title CONTAINS 'error' WITH post, count(DISTINCT ph) AS editCount, count(DISTINCT vote) AS voteCount WHERE editCount > 2 AND voteCount >= 5 RETURN post.Title, editCount, voteCount ORDER BY voteCount DESC"
  },
  {
    "question": "Which users have created posts in multiple post types and have earned at least 5 badges?",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT posts.PostTypeId), COUNT(DISTINCT badges.Id) FROM users JOIN posts ON users.Id = posts.OwnerUserId JOIN badges ON users.Id = badges.UserId GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT posts.PostTypeId) > 1 AND COUNT(DISTINCT badges.Id) >= 5 ORDER BY COUNT(DISTINCT badges.Id) DESC",
    "cypher": "MATCH (user:users)-[:OWNS]->(post:posts), (user)-[:EARNED]->(badge:badges) WITH user, count(DISTINCT post.PostTypeId) AS typeCount, count(DISTINCT badge) AS badgeCount WHERE typeCount > 1 AND badgeCount >= 5 RETURN user.DisplayName, typeCount, badgeCount ORDER BY badgeCount DESC"
  },
  {
    "question": "Find users who have commented on posts with more than 10 upvotes and have created at least 2 posts themselves",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT comments.Id), COUNT(DISTINCT userPosts.Id) FROM users JOIN comments ON users.Id = comments.UserId JOIN posts ON comments.PostId = posts.Id JOIN votes ON posts.Id = votes.PostId JOIN posts AS userPosts ON users.Id = userPosts.OwnerUserId WHERE votes.VoteTypeId = 2 GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT votes.Id) > 10 AND COUNT(DISTINCT userPosts.Id) >= 2 ORDER BY COUNT(DISTINCT comments.Id) DESC",
    "cypher": "MATCH (user:users)-[:WROTE]->(comment:comments)-[:IS_ON]->(post:posts)<-[:VOTED_ON]-(vote:votes), (user)-[:OWNS]->(ownPost:posts) WHERE vote.VoteTypeId = '2' WITH user, count(DISTINCT comment) AS commentCount, count(DISTINCT vote) AS voteCount, count(DISTINCT ownPost) AS ownPostCount WHERE voteCount > 10 AND ownPostCount >= 2 RETURN user.DisplayName, commentCount, ownPostCount ORDER BY commentCount DESC"
  },
  {
    "question": "Which posts have comments from users who joined before 2015 and have received votes after 2019?",
    "sql": "SELECT posts.Title, COUNT(DISTINCT comments.Id), COUNT(DISTINCT votes.Id) FROM posts JOIN comments ON posts.Id = comments.PostId JOIN users ON comments.UserId = users.Id JOIN votes ON posts.Id = votes.PostId WHERE users.CreationDate < '2015-01-01 00:00:00' AND votes.CreationDate > '2019-01-01 00:00:00' GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT comments.Id) >= 1 AND COUNT(DISTINCT votes.Id) >= 1 ORDER BY COUNT(DISTINCT votes.Id) DESC",
    "cypher": "MATCH (user:users)-[:WROTE]->(comment:comments)-[:IS_ON]->(post:posts)<-[:VOTED_ON]-(vote:votes) WHERE user.CreationDate < '2015-01-01T00:00:00' AND vote.CreationDate > '2019-01-01T00:00:00' WITH post, count(DISTINCT comment) AS commentCount, count(DISTINCT vote) AS voteCount WHERE commentCount >= 1 AND voteCount >= 1 RETURN post.Title, commentCount, voteCount ORDER BY voteCount DESC"
  },
  {
    "question": "Find users who have earned non-tag-based badges and have written comments containing 'solution'",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT badges.Id), COUNT(DISTINCT comments.Id) FROM users JOIN badges ON users.Id = badges.UserId JOIN comments ON users.Id = comments.UserId WHERE badges.TagBased = false AND comments.Text LIKE '%solution%' GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT badges.Id) >= 1 AND COUNT(DISTINCT comments.Id) >= 1 ORDER BY COUNT(DISTINCT badges.Id) DESC",
    "cypher": "MATCH (user:users)-[:EARNED]->(badge:badges), (user)-[:WROTE]->(comment:comments) WHERE badge.TagBased = 'false' AND comment.Text CONTAINS 'solution' WITH user, count(DISTINCT badge) AS badgeCount, count(DISTINCT comment) AS commentCount WHERE badgeCount >= 1 AND commentCount >= 1 RETURN user.DisplayName, badgeCount, commentCount ORDER BY badgeCount DESC"
  },
  {
    "question": "Which posts have been edited by more than 2 different users and have at least 3 comments?",
    "sql": "SELECT posts.Title, COUNT(DISTINCT postHistory.UserId), COUNT(DISTINCT comments.Id) FROM posts JOIN postHistory ON posts.Id = postHistory.PostId JOIN comments ON posts.Id = comments.PostId GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT postHistory.UserId) > 2 AND COUNT(DISTINCT comments.Id) >= 3 ORDER BY COUNT(DISTINCT postHistory.UserId) DESC",
    "cypher": "MATCH (ph:postHistory)-[:RELATES_TO]->(post:posts)<-[:IS_ON]-(comment:comments) WITH post, count(DISTINCT ph.UserId) AS editorCount, count(DISTINCT comment) AS commentCount WHERE editorCount > 2 AND commentCount >= 3 RETURN post.Title, editorCount, commentCount ORDER BY editorCount DESC"
  },
  {
    "question": "Find users with more than 20 badges who have voted on posts tagged with 'c#'",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT badges.Id), COUNT(DISTINCT votes.Id) FROM users JOIN badges ON users.Id = badges.UserId JOIN votes ON users.Id = votes.UserId JOIN posts ON votes.PostId = posts.Id WHERE posts.Tags LIKE '%c#%' GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT badges.Id) > 20 ORDER BY COUNT(DISTINCT badges.Id) DESC",
    "cypher": "MATCH (user:users)-[:EARNED]->(badge:badges), (user)-[:CAST]->(vote:votes)-[:VOTED_ON]->(post:posts) WHERE post.Tags CONTAINS 'c#' WITH user, count(DISTINCT badge) AS badgeCount, count(DISTINCT vote) AS voteCount WHERE badgeCount > 20 RETURN user.DisplayName, badgeCount, voteCount ORDER BY badgeCount DESC"
  },
  {
    "question": "Which users have posts with more than 5 post links and have earned badges in 2019?",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT postLinks.Id), COUNT(DISTINCT badges.Id) FROM users JOIN posts ON users.Id = posts.OwnerUserId JOIN postLinks ON posts.Id = postLinks.PostId JOIN badges ON users.Id = badges.UserId WHERE badges.Date >= '2019-01-01 00:00:00' AND badges.Date < '2020-01-01 00:00:00' GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT postLinks.Id) > 5 ORDER BY COUNT(DISTINCT postLinks.Id) DESC",
    "cypher": "MATCH (user:users)-[:OWNS]->(post:posts)-[:HAS_LINK]->(pl:postLinks), (user)-[:EARNED]->(badge:badges) WHERE badge.Date >= '2019-01-01T00:00:00' AND badge.Date < '2020-01-01T00:00:00' WITH user, count(DISTINCT pl) AS linkCount, count(DISTINCT badge) AS badgeCount WHERE linkCount > 5 RETURN user.DisplayName, linkCount, badgeCount ORDER BY linkCount DESC"
  },
  {
    "question": "Find posts that have received VoteTypeId 1, 2, and 3 votes with at least 2 of each type",
    "sql": "SELECT posts.Title, COUNT(DISTINCT CASE WHEN votes.VoteTypeId = 1 THEN votes.Id END), COUNT(DISTINCT CASE WHEN votes.VoteTypeId = 2 THEN votes.Id END), COUNT(DISTINCT CASE WHEN votes.VoteTypeId = 3 THEN votes.Id END) FROM posts JOIN votes ON posts.Id = votes.PostId WHERE votes.VoteTypeId IN (1, 2, 3) GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT CASE WHEN votes.VoteTypeId = 1 THEN votes.Id END) >= 2 AND COUNT(DISTINCT CASE WHEN votes.VoteTypeId = 2 THEN votes.Id END) >= 2 AND COUNT(DISTINCT CASE WHEN votes.VoteTypeId = 3 THEN votes.Id END) >= 2",
    "cypher": "MATCH (vote:votes)-[:VOTED_ON]->(post:posts) WHERE vote.VoteTypeId IN ['1', '2', '3'] WITH post, sum(CASE WHEN vote.VoteTypeId = '1' THEN 1 ELSE 0 END) AS type1, sum(CASE WHEN vote.VoteTypeId = '2' THEN 1 ELSE 0 END) AS type2, sum(CASE WHEN vote.VoteTypeId = '3' THEN 1 ELSE 0 END) AS type3 WHERE type1 >= 2 AND type2 >= 2 AND type3 >= 2 RETURN post.Title, type1, type2, type3"
  },
  {
    "question": "Which users have commented on more than 10 different posts and have cast at least 5 votes?",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT comments.PostId), COUNT(DISTINCT votes.Id) FROM users JOIN comments ON users.Id = comments.UserId JOIN votes ON users.Id = votes.UserId GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT comments.PostId) > 10 AND COUNT(DISTINCT votes.Id) >= 5 ORDER BY COUNT(DISTINCT comments.PostId) DESC",
    "cypher": "MATCH (user:users)-[:WROTE]->(comment:comments), (user)-[:CAST]->(vote:votes) WITH user, count(DISTINCT comment.PostId) AS postCount, count(DISTINCT vote) AS voteCount WHERE postCount > 10 AND voteCount >= 5 RETURN user.DisplayName, postCount, voteCount ORDER BY postCount DESC"
  },
  {
    "question": "Find posts with body containing 'function' that have more than 3 comments from users with badges",
    "sql": "SELECT posts.Title, COUNT(DISTINCT comments.Id), COUNT(DISTINCT badges.Id) FROM posts JOIN comments ON posts.Id = comments.PostId JOIN users ON comments.UserId = users.Id JOIN badges ON users.Id = badges.UserId WHERE posts.Body LIKE '%function%' GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT comments.Id) > 3 ORDER BY COUNT(DISTINCT comments.Id) DESC",
    "cypher": "MATCH (comment:comments)-[:IS_ON]->(post:posts), (user:users)-[:WROTE]->(comment), (user)-[:EARNED]->(badge:badges) WHERE post.Body CONTAINS 'function' WITH post, count(DISTINCT comment) AS commentCount, count(DISTINCT badge) AS badgeCount WHERE commentCount > 3 RETURN post.Title, commentCount, badgeCount ORDER BY commentCount DESC"
  },
  {
    "question": "Which users own posts that have been linked to by at least 3 other posts and have more than 5 badges?",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT postLinks.Id), COUNT(DISTINCT badges.Id) FROM users JOIN posts ON users.Id = posts.OwnerUserId JOIN postLinks ON posts.Id = postLinks.RelatedPostId JOIN badges ON users.Id = badges.UserId GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT postLinks.Id) >= 3 AND COUNT(DISTINCT badges.Id) > 5 ORDER BY COUNT(DISTINCT postLinks.Id) DESC",
    "cypher": "MATCH (pl:postLinks)-[:POINTS_TO]->(post:posts)<-[:OWNS]-(user:users), (user)-[:EARNED]->(badge:badges) WITH user, count(DISTINCT pl) AS linkCount, count(DISTINCT badge) AS badgeCount WHERE linkCount >= 3 AND badgeCount > 5 RETURN user.DisplayName, linkCount, badgeCount ORDER BY linkCount DESC"
  },
  {
    "question": "Find users who have written comments on posts created before 2014 and have earned at least 10 badges",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT comments.Id), COUNT(DISTINCT badges.Id) FROM users JOIN comments ON users.Id = comments.UserId JOIN posts ON comments.PostId = posts.Id JOIN badges ON users.Id = badges.UserId WHERE posts.CreationDate < '2014-01-01 00:00:00' GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT badges.Id) >= 10 ORDER BY COUNT(DISTINCT badges.Id) DESC",
    "cypher": "MATCH (user:users)-[:WROTE]->(comment:comments)-[:IS_ON]->(post:posts), (user)-[:EARNED]->(badge:badges) WHERE post.CreationDate < '2014-01-01T00:00:00' WITH user, count(DISTINCT comment) AS commentCount, count(DISTINCT badge) AS badgeCount WHERE badgeCount >= 10 RETURN user.DisplayName, commentCount, badgeCount ORDER BY badgeCount DESC"
  },
  {
    "question": "Which posts have been edited with PostHistoryTypeId 1 or 2 and received more than 5 upvotes?",
    "sql": "SELECT posts.Title, COUNT(DISTINCT postHistory.Id), COUNT(DISTINCT votes.Id) FROM posts JOIN postHistory ON posts.Id = postHistory.PostId JOIN votes ON posts.Id = votes.PostId WHERE postHistory.PostHistoryTypeId IN (1, 2) AND votes.VoteTypeId = 2 GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT postHistory.Id) >= 1 AND COUNT(DISTINCT votes.Id) > 5 ORDER BY COUNT(DISTINCT votes.Id) DESC",
    "cypher": "MATCH (ph:postHistory)-[:RELATES_TO]->(post:posts)<-[:VOTED_ON]-(vote:votes) WHERE ph.PostHistoryTypeId IN ['1', '2'] AND vote.VoteTypeId = '2' WITH post, count(DISTINCT ph) AS editCount, count(DISTINCT vote) AS voteCount WHERE editCount >= 1 AND voteCount > 5 RETURN post.Title, editCount, voteCount ORDER BY voteCount DESC"
  },
  {
    "question": "Find users who have earned both tag-based and non-tag-based badges and have created more than 2 posts",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT CASE WHEN badges.TagBased = true THEN badges.Id END), COUNT(DISTINCT CASE WHEN badges.TagBased = false THEN badges.Id END), COUNT(DISTINCT posts.Id) FROM users JOIN badges ON users.Id = badges.UserId JOIN posts ON users.Id = posts.OwnerUserId GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT CASE WHEN badges.TagBased = true THEN badges.Id END) >= 1 AND COUNT(DISTINCT CASE WHEN badges.TagBased = false THEN badges.Id END) >= 1 AND COUNT(DISTINCT posts.Id) > 2 ORDER BY COUNT(DISTINCT posts.Id) DESC",
    "cypher": "MATCH (user:users)-[:EARNED]->(badge:badges), (user)-[:OWNS]->(post:posts) WITH user, sum(CASE WHEN badge.TagBased = 'true' THEN 1 ELSE 0 END) AS tagBased, sum(CASE WHEN badge.TagBased = 'false' THEN 1 ELSE 0 END) AS nonTagBased, count(DISTINCT post) AS postCount WHERE tagBased >= 1 AND nonTagBased >= 1 AND postCount > 2 RETURN user.DisplayName, tagBased, nonTagBased, postCount ORDER BY postCount DESC"
  },
  {
    "question": "Which posts tagged with 'html' or 'css' have comments from more than 3 distinct users and at least 5 votes?",
    "sql": "SELECT posts.Title, COUNT(DISTINCT comments.UserId), COUNT(DISTINCT votes.Id) FROM posts JOIN comments ON posts.Id = comments.PostId JOIN votes ON posts.Id = votes.PostId WHERE posts.Tags LIKE '%html%' OR posts.Tags LIKE '%css%' GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT comments.UserId) > 3 AND COUNT(DISTINCT votes.Id) >= 5 ORDER BY COUNT(DISTINCT votes.Id) DESC",
    "cypher": "MATCH (comment:comments)-[:IS_ON]->(post:posts)<-[:VOTED_ON]-(vote:votes) WHERE post.Tags CONTAINS 'html' OR post.Tags CONTAINS 'css' WITH post, count(DISTINCT comment.UserId) AS commenterCount, count(DISTINCT vote) AS voteCount WHERE commenterCount > 3 AND voteCount >= 5 RETURN post.Title, commenterCount, voteCount ORDER BY voteCount DESC"
  },
  {
    "question": "Find users who have commented on their own posts and have more than 5 total badges",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT comments.Id), COUNT(DISTINCT badges.Id) FROM users JOIN posts ON users.Id = posts.OwnerUserId JOIN comments ON posts.Id = comments.PostId AND users.Id = comments.UserId JOIN badges ON users.Id = badges.UserId GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT comments.Id) >= 1 AND COUNT(DISTINCT badges.Id) > 5 ORDER BY COUNT(DISTINCT badges.Id) DESC",
    "cypher": "MATCH (user:users)-[:OWNS]->(post:posts)<-[:IS_ON]-(comment:comments)<-[:WROTE]-(user), (user)-[:EARNED]->(badge:badges) WITH user, count(DISTINCT comment) AS commentCount, count(DISTINCT badge) AS badgeCount WHERE commentCount >= 1 AND badgeCount > 5 RETURN user.DisplayName, commentCount, badgeCount ORDER BY badgeCount DESC"
  },
  {
    "question": "Which posts created by users with 'developer' in their AboutMe have more than 3 comments and 5 votes?",
    "sql": "SELECT posts.Title, users.DisplayName, COUNT(DISTINCT comments.Id), COUNT(DISTINCT votes.Id) FROM posts JOIN users ON posts.OwnerUserId = users.Id JOIN comments ON posts.Id = comments.PostId JOIN votes ON posts.Id = votes.PostId WHERE users.AboutMe LIKE '%developer%' GROUP BY posts.Id, posts.Title, users.DisplayName HAVING COUNT(DISTINCT comments.Id) > 3 AND COUNT(DISTINCT votes.Id) > 5 ORDER BY COUNT(DISTINCT votes.Id) DESC",
    "cypher": "MATCH (user:users)-[:OWNS]->(post:posts)<-[:IS_ON]-(comment:comments), (vote:votes)-[:VOTED_ON]->(post) WHERE user.AboutMe CONTAINS 'developer' WITH post, user, count(DISTINCT comment) AS commentCount, count(DISTINCT vote) AS voteCount WHERE commentCount > 3 AND voteCount > 5 RETURN post.Title, user.DisplayName, commentCount, voteCount ORDER BY voteCount DESC"
  },
  {
    "question": "Find users who have cast votes on more than 20 posts and have earned at least 3 Class 1 badges",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT votes.PostId), COUNT(DISTINCT badges.Id) FROM users JOIN votes ON users.Id = votes.UserId JOIN badges ON users.Id = badges.UserId WHERE badges.Class = 1 GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT votes.PostId) > 20 AND COUNT(DISTINCT badges.Id) >= 3 ORDER BY COUNT(DISTINCT votes.PostId) DESC",
    "cypher": "MATCH (user:users)-[:CAST]->(vote:votes), (user)-[:EARNED]->(badge:badges) WHERE badge.Class = '1' WITH user, count(DISTINCT vote.PostId) AS votedPosts, count(DISTINCT badge) AS badgeCount WHERE votedPosts > 20 AND badgeCount >= 3 RETURN user.DisplayName, votedPosts, badgeCount ORDER BY votedPosts DESC"
  },
  {
    "question": "Which posts have history entries from more than 3 different users and comments from at least 2 users?",
    "sql": "SELECT posts.Title, COUNT(DISTINCT postHistory.UserId), COUNT(DISTINCT comments.UserId) FROM posts JOIN postHistory ON posts.Id = postHistory.PostId JOIN comments ON posts.Id = comments.PostId GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT postHistory.UserId) > 3 AND COUNT(DISTINCT comments.UserId) >= 2 ORDER BY COUNT(DISTINCT postHistory.UserId) DESC",
    "cypher": "MATCH (ph:postHistory)-[:RELATES_TO]->(post:posts)<-[:IS_ON]-(comment:comments) WITH post, count(DISTINCT ph.UserId) AS editorCount, count(DISTINCT comment.UserId) AS commenterCount WHERE editorCount > 3 AND commenterCount >= 2 RETURN post.Title, editorCount, commenterCount ORDER BY editorCount DESC"
  },
  {
    "question": "Find users who have written more than 5 comments on posts with PostTypeId 2 and have earned badges after 2018",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT comments.Id), COUNT(DISTINCT badges.Id) FROM users JOIN comments ON users.Id = comments.UserId JOIN posts ON comments.PostId = posts.Id JOIN badges ON users.Id = badges.UserId WHERE posts.PostTypeId = 2 AND badges.Date > '2018-01-01 00:00:00' GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT comments.Id) > 5 ORDER BY COUNT(DISTINCT comments.Id) DESC",
    "cypher": "MATCH (user:users)-[:WROTE]->(comment:comments)-[:IS_ON]->(post:posts), (user)-[:EARNED]->(badge:badges) WHERE post.PostTypeId = '2' AND badge.Date > '2018-01-01T00:00:00' WITH user, count(DISTINCT comment) AS commentCount, count(DISTINCT badge) AS badgeCount WHERE commentCount > 5 RETURN user.DisplayName, commentCount, badgeCount ORDER BY commentCount DESC"
  },
  {
    "question": "Which users have posts linked with LinkTypeId 1 and have voted on more than 10 posts?",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT postLinks.Id), COUNT(DISTINCT votes.PostId) FROM users JOIN posts ON users.Id = posts.OwnerUserId JOIN postLinks ON posts.Id = postLinks.PostId JOIN votes ON users.Id = votes.UserId WHERE postLinks.LinkTypeId = 1 GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT votes.PostId) > 10 ORDER BY COUNT(DISTINCT postLinks.Id) DESC",
    "cypher": "MATCH (user:users)-[:OWNS]->(post:posts)-[:HAS_LINK]->(pl:postLinks), (user)-[:CAST]->(vote:votes) WHERE pl.LinkTypeId = '1' WITH user, count(DISTINCT pl) AS linkCount, count(DISTINCT vote.PostId) AS votedPosts WHERE votedPosts > 10 RETURN user.DisplayName, linkCount, votedPosts ORDER BY linkCount DESC"
  },
  {
    "question": "Find posts created in 2018 or 2019 that have more than 5 comments and at least 10 votes",
    "sql": "SELECT posts.Title, posts.CreationDate, COUNT(DISTINCT comments.Id), COUNT(DISTINCT votes.Id) FROM posts JOIN comments ON posts.Id = comments.PostId JOIN votes ON posts.Id = votes.PostId WHERE posts.CreationDate >= '2018-01-01 00:00:00' AND posts.CreationDate < '2020-01-01 00:00:00' GROUP BY posts.Id, posts.Title, posts.CreationDate HAVING COUNT(DISTINCT comments.Id) > 5 AND COUNT(DISTINCT votes.Id) >= 10 ORDER BY COUNT(DISTINCT votes.Id) DESC",
    "cypher": "MATCH (comment:comments)-[:IS_ON]->(post:posts)<-[:VOTED_ON]-(vote:votes) WHERE post.CreationDate >= '2018-01-01T00:00:00' AND post.CreationDate < '2020-01-01T00:00:00' WITH post, count(DISTINCT comment) AS commentCount, count(DISTINCT vote) AS voteCount WHERE commentCount > 5 AND voteCount >= 10 RETURN post.Title, post.CreationDate, commentCount, voteCount ORDER BY voteCount DESC"
  },
  {
    "question": "Which users have created posts in at least 2 different content licenses and have earned badges named 'Editor'?",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT posts.ContentLicense), COUNT(DISTINCT badges.Id) FROM users JOIN posts ON users.Id = posts.OwnerUserId JOIN badges ON users.Id = badges.UserId WHERE badges.Name = 'Editor' GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT posts.ContentLicense) >= 2 ORDER BY COUNT(DISTINCT posts.ContentLicense) DESC",
    "cypher": "MATCH (user:users)-[:OWNS]->(post:posts), (user)-[:EARNED]->(badge:badges) WHERE badge.Name = 'Editor' WITH user, count(DISTINCT post.ContentLicense) AS licenseCount, count(DISTINCT badge) AS badgeCount WHERE licenseCount >= 2 RETURN user.DisplayName, licenseCount, badgeCount ORDER BY licenseCount DESC"
  },
  {
    "question": "Find posts that have comments containing 'help' from users who have more than 3 badges",
    "sql": "SELECT posts.Title, COUNT(DISTINCT comments.Id), COUNT(DISTINCT badges.Id) FROM posts JOIN comments ON posts.Id = comments.PostId JOIN users ON comments.UserId = users.Id JOIN badges ON users.Id = badges.UserId WHERE comments.Text LIKE '%help%' GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT badges.Id) > 3 ORDER BY COUNT(DISTINCT comments.Id) DESC",
    "cypher": "MATCH (user:users)-[:WROTE]->(comment:comments)-[:IS_ON]->(post:posts), (user)-[:EARNED]->(badge:badges) WHERE comment.Text CONTAINS 'help' WITH post, count(DISTINCT comment) AS commentCount, count(DISTINCT badge) AS badgeCount WHERE badgeCount > 3 RETURN post.Title, commentCount, badgeCount ORDER BY commentCount DESC"
  },
  {
    "question": "Which users have written comments on posts owned by users who joined before 2013 and have voted on at least 5 posts?",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT comments.Id), COUNT(DISTINCT votes.PostId) FROM users JOIN comments ON users.Id = comments.UserId JOIN posts ON comments.PostId = posts.Id JOIN users AS postOwners ON posts.OwnerUserId = postOwners.Id JOIN votes ON users.Id = votes.UserId WHERE postOwners.CreationDate < '2013-01-01 00:00:00' GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT votes.PostId) >= 5 ORDER BY COUNT(DISTINCT comments.Id) DESC",
    "cypher": "MATCH (user:users)-[:WROTE]->(comment:comments)-[:IS_ON]->(post:posts)<-[:OWNS]-(owner:users), (user)-[:CAST]->(vote:votes) WHERE owner.CreationDate < '2013-01-01T00:00:00' WITH user, count(DISTINCT comment) AS commentCount, count(DISTINCT vote.PostId) AS votedPosts WHERE votedPosts >= 5 RETURN user.DisplayName, commentCount, votedPosts ORDER BY commentCount DESC"
  },
  {
    "question": "Find posts with more than 2 links and more than 3 edits that have at least one comment",
    "sql": "SELECT posts.Title, COUNT(DISTINCT postLinks.Id), COUNT(DISTINCT postHistory.Id), COUNT(DISTINCT comments.Id) FROM posts JOIN postLinks ON posts.Id = postLinks.PostId JOIN postHistory ON posts.Id = postHistory.PostId JOIN comments ON posts.Id = comments.PostId GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT postLinks.Id) > 2 AND COUNT(DISTINCT postHistory.Id) > 3 AND COUNT(DISTINCT comments.Id) >= 1 ORDER BY COUNT(DISTINCT postLinks.Id) DESC",
    "cypher": "MATCH (post:posts)-[:HAS_LINK]->(pl:postLinks), (ph:postHistory)-[:RELATES_TO]->(post), (comment:comments)-[:IS_ON]->(post) WITH post, count(DISTINCT pl) AS linkCount, count(DISTINCT ph) AS editCount, count(DISTINCT comment) AS commentCount WHERE linkCount > 2 AND editCount > 3 AND commentCount >= 1 RETURN post.Title, linkCount, editCount, commentCount ORDER BY linkCount DESC"
  },
  {
    "question": "Which users have earned more than 15 badges and have created posts that received more than 20 votes?",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT badges.Id), COUNT(DISTINCT votes.Id) FROM users JOIN badges ON users.Id = badges.UserId JOIN posts ON users.Id = posts.OwnerUserId JOIN votes ON posts.Id = votes.PostId GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT badges.Id) > 15 AND COUNT(DISTINCT votes.Id) > 20 ORDER BY COUNT(DISTINCT badges.Id) DESC",
    "cypher": "MATCH (user:users)-[:EARNED]->(badge:badges), (user)-[:OWNS]->(post:posts)<-[:VOTED_ON]-(vote:votes) WITH user, count(DISTINCT badge) AS badgeCount, count(DISTINCT vote) AS voteCount WHERE badgeCount > 15 AND voteCount > 20 RETURN user.DisplayName, badgeCount, voteCount ORDER BY badgeCount DESC"
  },
  {
    "question": "Find users who have edited posts they did not create and have earned at least 5 badges",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT postHistory.Id), COUNT(DISTINCT badges.Id) FROM users JOIN postHistory ON users.Id = postHistory.UserId JOIN posts ON postHistory.PostId = posts.Id JOIN badges ON users.Id = badges.UserId WHERE posts.OwnerUserId != users.Id GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT postHistory.Id) >= 1 AND COUNT(DISTINCT badges.Id) >= 5 ORDER BY COUNT(DISTINCT badges.Id) DESC",
    "cypher": "MATCH (user:users)-[:EDITED]->(ph:postHistory)-[:RELATES_TO]->(post:posts), (user)-[:EARNED]->(badge:badges) WHERE post.OwnerUserId <> user.Id WITH user, count(DISTINCT ph) AS editCount, count(DISTINCT badge) AS badgeCount WHERE editCount >= 1 AND badgeCount >= 5 RETURN user.DisplayName, editCount, badgeCount ORDER BY badgeCount DESC"
  },
  {
    "question": "Which posts tagged with 'database' have comments from users in California and at least 3 votes?",
    "sql": "SELECT posts.Title, COUNT(DISTINCT comments.Id), COUNT(DISTINCT votes.Id) FROM posts JOIN comments ON posts.Id = comments.PostId JOIN users ON comments.UserId = users.Id JOIN votes ON posts.Id = votes.PostId WHERE posts.Tags LIKE '%database%' AND users.Location LIKE '%California%' GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT votes.Id) >= 3 ORDER BY COUNT(DISTINCT votes.Id) DESC",
    "cypher": "MATCH (user:users)-[:WROTE]->(comment:comments)-[:IS_ON]->(post:posts)<-[:VOTED_ON]-(vote:votes) WHERE post.Tags CONTAINS 'database' AND user.Location CONTAINS 'California' WITH post, count(DISTINCT comment) AS commentCount, count(DISTINCT vote) AS voteCount WHERE voteCount >= 3 RETURN post.Title, commentCount, voteCount ORDER BY voteCount DESC"
  },
  {
    "question": "Find users who have written more than 10 comments and have earned Class 3 badges",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT comments.Id), COUNT(DISTINCT badges.Id) FROM users JOIN comments ON users.Id = comments.UserId JOIN badges ON users.Id = badges.UserId WHERE badges.Class = 3 GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT comments.Id) > 10 ORDER BY COUNT(DISTINCT comments.Id) DESC",
    "cypher": "MATCH (user:users)-[:WROTE]->(comment:comments), (user)-[:EARNED]->(badge:badges) WHERE badge.Class = '3' WITH user, count(DISTINCT comment) AS commentCount, count(DISTINCT badge) AS badgeCount WHERE commentCount > 10 RETURN user.DisplayName, commentCount, badgeCount ORDER BY commentCount DESC"
  },
  {
    "question": "Which posts have been voted on by users who have earned the 'Supporter' badge and have more than 2 comments?",
    "sql": "SELECT posts.Title, COUNT(DISTINCT votes.Id), COUNT(DISTINCT comments.Id) FROM posts JOIN votes ON posts.Id = votes.PostId JOIN users ON votes.UserId = users.Id JOIN badges ON users.Id = badges.UserId JOIN comments ON posts.Id = comments.PostId WHERE badges.Name = 'Supporter' GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT comments.Id) > 2 ORDER BY COUNT(DISTINCT votes.Id) DESC",
    "cypher": "MATCH (user:users)-[:CAST]->(vote:votes)-[:VOTED_ON]->(post:posts), (user)-[:EARNED]->(badge:badges), (comment:comments)-[:IS_ON]->(post) WHERE badge.Name = 'Supporter' WITH post, count(DISTINCT vote) AS voteCount, count(DISTINCT comment) AS commentCount WHERE commentCount > 2 RETURN post.Title, voteCount, commentCount ORDER BY voteCount DESC"
  },
  {
    "question": "Find posts created by users who have a website URL and have received more than 5 votes and 2 comments",
    "sql": "SELECT posts.Title, users.DisplayName, COUNT(DISTINCT votes.Id), COUNT(DISTINCT comments.Id) FROM posts JOIN users ON posts.OwnerUserId = users.Id JOIN votes ON posts.Id = votes.PostId JOIN comments ON posts.Id = comments.PostId WHERE users.WebsiteUrl IS NOT NULL GROUP BY posts.Id, posts.Title, users.DisplayName HAVING COUNT(DISTINCT votes.Id) > 5 AND COUNT(DISTINCT comments.Id) >= 2 ORDER BY COUNT(DISTINCT votes.Id) DESC",
    "cypher": "MATCH (user:users)-[:OWNS]->(post:posts)<-[:VOTED_ON]-(vote:votes), (comment:comments)-[:IS_ON]->(post) WHERE user.WebsiteUrl <> '' WITH post, user, count(DISTINCT vote) AS voteCount, count(DISTINCT comment) AS commentCount WHERE voteCount > 5 AND commentCount >= 2 RETURN post.Title, user.DisplayName, voteCount, commentCount ORDER BY voteCount DESC"
  },
  {
    "question": "Which users have created more than 5 posts and have received comments from at least 10 different users?",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT posts.Id), COUNT(DISTINCT comments.UserId) FROM users JOIN posts ON users.Id = posts.OwnerUserId JOIN comments ON posts.Id = comments.PostId GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT posts.Id) > 5 AND COUNT(DISTINCT comments.UserId) >= 10 ORDER BY COUNT(DISTINCT comments.UserId) DESC",
    "cypher": "MATCH (user:users)-[:OWNS]->(post:posts)<-[:IS_ON]-(comment:comments) WITH user, count(DISTINCT post) AS postCount, count(DISTINCT comment.UserId) AS commenterCount WHERE postCount > 5 AND commenterCount >= 10 RETURN user.DisplayName, postCount, commenterCount ORDER BY commenterCount DESC"
  },
  {
    "question": "Find posts with titles starting with 'How' that have more than 3 votes and at least 2 history entries",
    "sql": "SELECT posts.Title, COUNT(DISTINCT votes.Id), COUNT(DISTINCT postHistory.Id) FROM posts JOIN votes ON posts.Id = votes.PostId JOIN postHistory ON posts.Id = postHistory.PostId WHERE posts.Title LIKE 'How%' GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT votes.Id) > 3 AND COUNT(DISTINCT postHistory.Id) >= 2 ORDER BY COUNT(DISTINCT votes.Id) DESC",
    "cypher": "MATCH (vote:votes)-[:VOTED_ON]->(post:posts)<-[:RELATES_TO]-(ph:postHistory) WHERE post.Title STARTS WITH 'How' WITH post, count(DISTINCT vote) AS voteCount, count(DISTINCT ph) AS historyCount WHERE voteCount > 3 AND historyCount >= 2 RETURN post.Title, voteCount, historyCount ORDER BY voteCount DESC"
  },
  {
    "question": "Which users have earned badges in at least 3 different months and have written more than 5 comments?",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT badges.Id), COUNT(DISTINCT comments.Id) FROM users JOIN badges ON users.Id = badges.UserId JOIN comments ON users.Id = comments.UserId GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT badges.Id) >= 3 AND COUNT(DISTINCT comments.Id) > 5 ORDER BY COUNT(DISTINCT badges.Id) DESC",
    "cypher": "MATCH (user:users)-[:EARNED]->(badge:badges), (user)-[:WROTE]->(comment:comments) WITH user, count(DISTINCT badge) AS badgeCount, count(DISTINCT comment) AS commentCount WHERE badgeCount >= 3 AND commentCount > 5 RETURN user.DisplayName, badgeCount, commentCount ORDER BY badgeCount DESC"
  },
  {
    "question": "Find posts that have comments from users who have cast more than 20 votes",
    "sql": "SELECT posts.Title, COUNT(DISTINCT comments.Id), COUNT(DISTINCT votes.Id) FROM posts JOIN comments ON posts.Id = comments.PostId JOIN users ON comments.UserId = users.Id JOIN votes ON users.Id = votes.UserId GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT votes.Id) > 20 ORDER BY COUNT(DISTINCT comments.Id) DESC",
    "cypher": "MATCH (user:users)-[:WROTE]->(comment:comments)-[:IS_ON]->(post:posts), (user)-[:CAST]->(vote:votes) WITH post, count(DISTINCT comment) AS commentCount, count(DISTINCT vote) AS voteCount WHERE voteCount > 20 RETURN post.Title, commentCount, voteCount ORDER BY commentCount DESC"
  },
  {
    "question": "Which posts have been edited by users who have earned the 'Critic' badge and received at least 3 votes?",
    "sql": "SELECT posts.Title, COUNT(DISTINCT postHistory.Id), COUNT(DISTINCT votes.Id) FROM posts JOIN postHistory ON posts.Id = postHistory.PostId JOIN users ON postHistory.UserId = users.Id JOIN badges ON users.Id = badges.UserId JOIN votes ON posts.Id = votes.PostId WHERE badges.Name = 'Critic' GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT votes.Id) >= 3 ORDER BY COUNT(DISTINCT votes.Id) DESC",
    "cypher": "MATCH (user:users)-[:EDITED]->(ph:postHistory)-[:RELATES_TO]->(post:posts), (user)-[:EARNED]->(badge:badges), (vote:votes)-[:VOTED_ON]->(post) WHERE badge.Name = 'Critic' WITH post, count(DISTINCT ph) AS editCount, count(DISTINCT vote) AS voteCount WHERE voteCount >= 3 RETURN post.Title, editCount, voteCount ORDER BY voteCount DESC"
  },
  {
    "question": "Find users in Asia who have more than 5 badges and have created at least 2 posts",
    "sql": "SELECT users.DisplayName, users.Location, COUNT(DISTINCT badges.Id), COUNT(DISTINCT posts.Id) FROM users JOIN badges ON users.Id = badges.UserId JOIN posts ON users.Id = posts.OwnerUserId WHERE users.Location IN ('India', 'Japan', 'China') GROUP BY users.Id, users.DisplayName, users.Location HAVING COUNT(DISTINCT badges.Id) > 5 AND COUNT(DISTINCT posts.Id) >= 2 ORDER BY COUNT(DISTINCT badges.Id) DESC",
    "cypher": "MATCH (user:users)-[:EARNED]->(badge:badges), (user)-[:OWNS]->(post:posts) WHERE user.Location IN ['India', 'Japan', 'China'] WITH user, count(DISTINCT badge) AS badgeCount, count(DISTINCT post) AS postCount WHERE badgeCount > 5 AND postCount >= 2 RETURN user.DisplayName, user.Location, badgeCount, postCount ORDER BY badgeCount DESC"
  },
  {
    "question": "Which posts have body containing 'return' and have received upvotes from more than 5 users?",
    "sql": "SELECT posts.Title, COUNT(DISTINCT votes.UserId) FROM posts JOIN votes ON posts.Id = votes.PostId WHERE posts.Body LIKE '%return%' AND votes.VoteTypeId = 2 GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT votes.UserId) > 5 ORDER BY COUNT(DISTINCT votes.UserId) DESC",
    "cypher": "MATCH (vote:votes)-[:VOTED_ON]->(post:posts) WHERE post.Body CONTAINS 'return' AND vote.VoteTypeId = '2' WITH post, count(DISTINCT vote.UserId) AS voterCount WHERE voterCount > 5 RETURN post.Title, voterCount ORDER BY voterCount DESC"
  },
  {
    "question": "Find users who own posts with accepted answers that have received comments from at least 3 different users",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT posts.Id), COUNT(DISTINCT comments.UserId) FROM users JOIN posts ON users.Id = posts.OwnerUserId JOIN comments ON posts.Id = comments.PostId WHERE posts.AcceptedAnswerId IS NOT NULL GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT comments.UserId) >= 3 ORDER BY COUNT(DISTINCT posts.Id) DESC",
    "cypher": "MATCH (user:users)-[:OWNS]->(post:posts)<-[:IS_ON]-(comment:comments) WHERE post.AcceptedAnswerId <> '' WITH user, count(DISTINCT post) AS postCount, count(DISTINCT comment.UserId) AS commenterCount WHERE commenterCount >= 3 RETURN user.DisplayName, postCount, commenterCount ORDER BY postCount DESC"
  },
  {
    "question": "Which users have voted on posts tagged with 'api' and have earned more than 3 non-tag-based badges?",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT votes.Id), COUNT(DISTINCT badges.Id) FROM users JOIN votes ON users.Id = votes.UserId JOIN posts ON votes.PostId = posts.Id JOIN badges ON users.Id = badges.UserId WHERE posts.Tags LIKE '%api%' AND badges.TagBased = false GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT badges.Id) > 3 ORDER BY COUNT(DISTINCT badges.Id) DESC",
    "cypher": "MATCH (user:users)-[:CAST]->(vote:votes)-[:VOTED_ON]->(post:posts), (user)-[:EARNED]->(badge:badges) WHERE post.Tags CONTAINS 'api' AND badge.TagBased = 'false' WITH user, count(DISTINCT vote) AS voteCount, count(DISTINCT badge) AS badgeCount WHERE badgeCount > 3 RETURN user.DisplayName, voteCount, badgeCount ORDER BY badgeCount DESC"
  },
  {
    "question": "Find posts created by users with more than 10 badges that have at least 5 votes and 3 comments",
    "sql": "SELECT posts.Title, COUNT(DISTINCT badges.Id), COUNT(DISTINCT votes.Id), COUNT(DISTINCT comments.Id) FROM posts JOIN users ON posts.OwnerUserId = users.Id JOIN badges ON users.Id = badges.UserId JOIN votes ON posts.Id = votes.PostId JOIN comments ON posts.Id = comments.PostId GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT badges.Id) > 10 AND COUNT(DISTINCT votes.Id) >= 5 AND COUNT(DISTINCT comments.Id) >= 3 ORDER BY COUNT(DISTINCT votes.Id) DESC",
    "cypher": "MATCH (user:users)-[:OWNS]->(post:posts), (user)-[:EARNED]->(badge:badges), (vote:votes)-[:VOTED_ON]->(post), (comment:comments)-[:IS_ON]->(post) WITH post, count(DISTINCT badge) AS badgeCount, count(DISTINCT vote) AS voteCount, count(DISTINCT comment) AS commentCount WHERE badgeCount > 10 AND voteCount >= 5 AND commentCount >= 3 RETURN post.Title, badgeCount, voteCount, commentCount ORDER BY voteCount DESC"
  },
  {
    "question": "Which users have created posts in ContentLicense 'CC BY-SA 4.0' and have more than 5 comments total?",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT posts.Id), COUNT(DISTINCT comments.Id) FROM users JOIN posts ON users.Id = posts.OwnerUserId JOIN comments ON users.Id = comments.UserId WHERE posts.ContentLicense = 'CC BY-SA 4.0' GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT comments.Id) > 5 ORDER BY COUNT(DISTINCT posts.Id) DESC",
    "cypher": "MATCH (user:users)-[:OWNS]->(post:posts), (user)-[:WROTE]->(comment:comments) WHERE post.ContentLicense = 'CC BY-SA 4.0' WITH user, count(DISTINCT post) AS postCount, count(DISTINCT comment) AS commentCount WHERE commentCount > 5 RETURN user.DisplayName, postCount, commentCount ORDER BY postCount DESC"
  },
  {
    "question": "Find posts that have been voted on after 2019 by users who have earned badges before 2015",
    "sql": "SELECT posts.Title, COUNT(DISTINCT votes.Id), COUNT(DISTINCT badges.Id) FROM posts JOIN votes ON posts.Id = votes.PostId JOIN users ON votes.UserId = users.Id JOIN badges ON users.Id = badges.UserId WHERE votes.CreationDate > '2019-01-01 00:00:00' AND badges.Date < '2015-01-01 00:00:00' GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT votes.Id) >= 1 ORDER BY COUNT(DISTINCT votes.Id) DESC",
    "cypher": "MATCH (user:users)-[:CAST]->(vote:votes)-[:VOTED_ON]->(post:posts), (user)-[:EARNED]->(badge:badges) WHERE vote.CreationDate > '2019-01-01T00:00:00' AND badge.Date < '2015-01-01T00:00:00' WITH post, count(DISTINCT vote) AS voteCount, count(DISTINCT badge) AS badgeCount WHERE voteCount >= 1 RETURN post.Title, voteCount, badgeCount ORDER BY voteCount DESC"
  },
  {
    "question": "Which users have written comments on posts with more than 20 votes and have created at least 3 posts themselves?",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT comments.Id), COUNT(DISTINCT userPosts.Id) FROM users JOIN comments ON users.Id = comments.UserId JOIN posts ON comments.PostId = posts.Id JOIN votes ON posts.Id = votes.PostId JOIN posts AS userPosts ON users.Id = userPosts.OwnerUserId GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT votes.Id) > 20 AND COUNT(DISTINCT userPosts.Id) >= 3 ORDER BY COUNT(DISTINCT comments.Id) DESC",
    "cypher": "MATCH (user:users)-[:WROTE]->(comment:comments)-[:IS_ON]->(post:posts)<-[:VOTED_ON]-(vote:votes), (user)-[:OWNS]->(ownPost:posts) WITH user, count(DISTINCT comment) AS commentCount, count(DISTINCT vote) AS voteCount, count(DISTINCT ownPost) AS ownPostCount WHERE voteCount > 20 AND ownPostCount >= 3 RETURN user.DisplayName, commentCount, ownPostCount ORDER BY commentCount DESC"
  },
  {
    "question": "Find posts tagged with 'react' or 'angular' that have comments from users with more than 5 badges",
    "sql": "SELECT posts.Title, COUNT(DISTINCT comments.Id), COUNT(DISTINCT badges.Id) FROM posts JOIN comments ON posts.Id = comments.PostId JOIN users ON comments.UserId = users.Id JOIN badges ON users.Id = badges.UserId WHERE posts.Tags LIKE '%react%' OR posts.Tags LIKE '%angular%' GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT badges.Id) > 5 ORDER BY COUNT(DISTINCT comments.Id) DESC",
    "cypher": "MATCH (user:users)-[:WROTE]->(comment:comments)-[:IS_ON]->(post:posts), (user)-[:EARNED]->(badge:badges) WHERE post.Tags CONTAINS 'react' OR post.Tags CONTAINS 'angular' WITH post, count(DISTINCT comment) AS commentCount, count(DISTINCT badge) AS badgeCount WHERE badgeCount > 5 RETURN post.Title, commentCount, badgeCount ORDER BY commentCount DESC"
  },
  {
    "question": "Which users have posts with more than 10 history entries and have earned at least 8 badges?",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT postHistory.Id), COUNT(DISTINCT badges.Id) FROM users JOIN posts ON users.Id = posts.OwnerUserId JOIN postHistory ON posts.Id = postHistory.PostId JOIN badges ON users.Id = badges.UserId GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT postHistory.Id) > 10 AND COUNT(DISTINCT badges.Id) >= 8 ORDER BY COUNT(DISTINCT postHistory.Id) DESC",
    "cypher": "MATCH (user:users)-[:OWNS]->(post:posts)<-[:RELATES_TO]-(ph:postHistory), (user)-[:EARNED]->(badge:badges) WITH user, count(DISTINCT ph) AS historyCount, count(DISTINCT badge) AS badgeCount WHERE historyCount > 10 AND badgeCount >= 8 RETURN user.DisplayName, historyCount, badgeCount ORDER BY historyCount DESC"
  },
  {
    "question": "Find users who have voted on and commented on the same post with at least 5 such posts",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT posts.Id) FROM users JOIN votes ON users.Id = votes.UserId JOIN posts ON votes.PostId = posts.Id JOIN comments ON posts.Id = comments.PostId AND users.Id = comments.UserId GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT posts.Id) >= 5 ORDER BY COUNT(DISTINCT posts.Id) DESC",
    "cypher": "MATCH (user:users)-[:CAST]->(vote:votes)-[:VOTED_ON]->(post:posts)<-[:IS_ON]-(comment:comments)<-[:WROTE]-(user) WITH user, count(DISTINCT post) AS postCount WHERE postCount >= 5 RETURN user.DisplayName, postCount ORDER BY postCount DESC"
  },
  {
    "question": "Which posts have comments from at least 5 users who have earned the 'Student' badge?",
    "sql": "SELECT posts.Title, COUNT(DISTINCT comments.UserId) FROM posts JOIN comments ON posts.Id = comments.PostId JOIN users ON comments.UserId = users.Id JOIN badges ON users.Id = badges.UserId WHERE badges.Name = 'Student' GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT comments.UserId) >= 5 ORDER BY COUNT(DISTINCT comments.UserId) DESC",
    "cypher": "MATCH (user:users)-[:WROTE]->(comment:comments)-[:IS_ON]->(post:posts), (user)-[:EARNED]->(badge:badges) WHERE badge.Name = 'Student' WITH post, count(DISTINCT user) AS commenterCount WHERE commenterCount >= 5 RETURN post.Title, commenterCount ORDER BY commenterCount DESC"
  },
  {
    "question": "Find posts with PostTypeId 1 that have more than 5 upvotes and have been edited by users other than the owner",
    "sql": "SELECT posts.Title, COUNT(DISTINCT votes.Id), COUNT(DISTINCT postHistory.UserId) FROM posts JOIN votes ON posts.Id = votes.PostId JOIN postHistory ON posts.Id = postHistory.PostId WHERE posts.PostTypeId = 1 AND votes.VoteTypeId = 2 AND postHistory.UserId != posts.OwnerUserId GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT votes.Id) > 5 AND COUNT(DISTINCT postHistory.UserId) >= 1 ORDER BY COUNT(DISTINCT votes.Id) DESC",
    "cypher": "MATCH (vote:votes)-[:VOTED_ON]->(post:posts)<-[:RELATES_TO]-(ph:postHistory) WHERE post.PostTypeId = '1' AND vote.VoteTypeId = '2' AND ph.UserId <> post.OwnerUserId WITH post, count(DISTINCT vote) AS voteCount, count(DISTINCT ph.UserId) AS editorCount WHERE voteCount > 5 AND editorCount >= 1 RETURN post.Title, voteCount, editorCount ORDER BY voteCount DESC"
  },
  {
    "question": "Which users have earned more than 10 badges of a single name?",
    "sql": "SELECT users.DisplayName, badges.Name, COUNT(badges.Id) FROM users JOIN badges ON users.Id = badges.UserId GROUP BY users.Id, users.DisplayName, badges.Name HAVING COUNT(badges.Id) > 10 ORDER BY COUNT(badges.Id) DESC",
    "cypher": "MATCH (user:users)-[:EARNED]->(badge:badges) WITH user, badge.Name AS badgeName, count(badge) AS badgeCount WHERE badgeCount > 10 RETURN user.DisplayName, badgeName, badgeCount ORDER BY badgeCount DESC"
  },
  {
    "question": "Find posts that have been linked to by posts created in 2018 and have more than 3 comments",
    "sql": "SELECT posts.Title, COUNT(DISTINCT postLinks.Id), COUNT(DISTINCT comments.Id) FROM posts JOIN postLinks ON posts.Id = postLinks.RelatedPostId JOIN posts AS sourcePosts ON postLinks.PostId = sourcePosts.Id JOIN comments ON posts.Id = comments.PostId WHERE sourcePosts.CreationDate >= '2018-01-01 00:00:00' AND sourcePosts.CreationDate < '2019-01-01 00:00:00' GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT comments.Id) > 3 ORDER BY COUNT(DISTINCT postLinks.Id) DESC",
    "cypher": "MATCH (sourcePost:posts)-[:HAS_LINK]->(pl:postLinks)-[:POINTS_TO]->(post:posts)<-[:IS_ON]-(comment:comments) WHERE sourcePost.CreationDate >= '2018-01-01T00:00:00' AND sourcePost.CreationDate < '2019-01-01T00:00:00' WITH post, count(DISTINCT pl) AS linkCount, count(DISTINCT comment) AS commentCount WHERE commentCount > 3 RETURN post.Title, linkCount, commentCount ORDER BY linkCount DESC"
  },
  {
    "question": "Which users have written comments on posts with all three vote types (1, 2, 3)?",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT comments.Id), COUNT(DISTINCT votes.VoteTypeId) FROM users JOIN comments ON users.Id = comments.UserId JOIN posts ON comments.PostId = posts.Id JOIN votes ON posts.Id = votes.PostId WHERE votes.VoteTypeId IN (1, 2, 3) GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT votes.VoteTypeId) = 3 ORDER BY COUNT(DISTINCT comments.Id) DESC",
    "cypher": "MATCH (user:users)-[:WROTE]->(comment:comments)-[:IS_ON]->(post:posts)<-[:VOTED_ON]-(vote:votes) WHERE vote.VoteTypeId IN ['1', '2', '3'] WITH user, count(DISTINCT comment) AS commentCount, count(DISTINCT vote.VoteTypeId) AS voteTypes WHERE voteTypes = 3 RETURN user.DisplayName, commentCount, voteTypes ORDER BY commentCount DESC"
  },
  {
    "question": "Find users who have created posts with ParentId set that received more than 5 upvotes",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT posts.Id), COUNT(DISTINCT votes.Id) FROM users JOIN posts ON users.Id = posts.OwnerUserId JOIN votes ON posts.Id = votes.PostId WHERE posts.ParentId IS NOT NULL AND votes.VoteTypeId = 2 GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT votes.Id) > 5 ORDER BY COUNT(DISTINCT votes.Id) DESC",
    "cypher": "MATCH (user:users)-[:OWNS]->(post:posts)<-[:VOTED_ON]-(vote:votes) WHERE post.ParentId <> '' AND vote.VoteTypeId = '2' WITH user, count(DISTINCT post) AS postCount, count(DISTINCT vote) AS voteCount WHERE voteCount > 5 RETURN user.DisplayName, postCount, voteCount ORDER BY voteCount DESC"
  },
  {
    "question": "Which posts have comments from users who have earned badges named 'Teacher' or 'Student'?",
    "sql": "SELECT posts.Title, COUNT(DISTINCT comments.Id), COUNT(DISTINCT badges.Name) FROM posts JOIN comments ON posts.Id = comments.PostId JOIN users ON comments.UserId = users.Id JOIN badges ON users.Id = badges.UserId WHERE badges.Name IN ('Teacher', 'Student') GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT badges.Name) >= 1 ORDER BY COUNT(DISTINCT comments.Id) DESC",
    "cypher": "MATCH (user:users)-[:WROTE]->(comment:comments)-[:IS_ON]->(post:posts), (user)-[:EARNED]->(badge:badges) WHERE badge.Name IN ['Teacher', 'Student'] WITH post, count(DISTINCT comment) AS commentCount, count(DISTINCT badge.Name) AS badgeNames WHERE badgeNames >= 1 RETURN post.Title, commentCount, badgeNames ORDER BY commentCount DESC"
  },
  {
    "question": "Find users who have more than 5 posts with votes and at least 10 badges",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT posts.Id), COUNT(DISTINCT badges.Id) FROM users JOIN posts ON users.Id = posts.OwnerUserId JOIN votes ON posts.Id = votes.PostId JOIN badges ON users.Id = badges.UserId GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT posts.Id) > 5 AND COUNT(DISTINCT badges.Id) >= 10 ORDER BY COUNT(DISTINCT badges.Id) DESC",
    "cypher": "MATCH (user:users)-[:OWNS]->(post:posts)<-[:VOTED_ON]-(vote:votes), (user)-[:EARNED]->(badge:badges) WITH user, count(DISTINCT post) AS postCount, count(DISTINCT badge) AS badgeCount WHERE postCount > 5 AND badgeCount >= 10 RETURN user.DisplayName, postCount, badgeCount ORDER BY badgeCount DESC"
  },
  {
    "question": "Which posts have been edited with PostHistoryTypeId 4 or 5 and have at least 3 comments?",
    "sql": "SELECT posts.Title, COUNT(DISTINCT postHistory.Id), COUNT(DISTINCT comments.Id) FROM posts JOIN postHistory ON posts.Id = postHistory.PostId JOIN comments ON posts.Id = comments.PostId WHERE postHistory.PostHistoryTypeId IN (4, 5) GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT postHistory.Id) >= 1 AND COUNT(DISTINCT comments.Id) >= 3 ORDER BY COUNT(DISTINCT comments.Id) DESC",
    "cypher": "MATCH (ph:postHistory)-[:RELATES_TO]->(post:posts)<-[:IS_ON]-(comment:comments) WHERE ph.PostHistoryTypeId IN ['4', '5'] WITH post, count(DISTINCT ph) AS historyCount, count(DISTINCT comment) AS commentCount WHERE historyCount >= 1 AND commentCount >= 3 RETURN post.Title, historyCount, commentCount ORDER BY commentCount DESC"
  },
  {
    "question": "Find users who have commented on posts they voted on and have more than 5 badges",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT comments.Id), COUNT(DISTINCT badges.Id) FROM users JOIN comments ON users.Id = comments.UserId JOIN votes ON users.Id = votes.UserId AND comments.PostId = votes.PostId JOIN badges ON users.Id = badges.UserId GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT comments.Id) >= 1 AND COUNT(DISTINCT badges.Id) > 5 ORDER BY COUNT(DISTINCT badges.Id) DESC",
    "cypher": "MATCH (user:users)-[:WROTE]->(comment:comments)-[:IS_ON]->(post:posts)<-[:VOTED_ON]-(vote:votes)<-[:CAST]-(user), (user)-[:EARNED]->(badge:badges) WITH user, count(DISTINCT comment) AS commentCount, count(DISTINCT badge) AS badgeCount WHERE commentCount >= 1 AND badgeCount > 5 RETURN user.DisplayName, commentCount, badgeCount ORDER BY badgeCount DESC"
  },
  {
    "question": "Which posts tagged with 'php' have comments from users who have created more than 3 posts?",
    "sql": "SELECT posts.Title, COUNT(DISTINCT comments.Id), COUNT(DISTINCT userPosts.Id) FROM posts JOIN comments ON posts.Id = comments.PostId JOIN users ON comments.UserId = users.Id JOIN posts AS userPosts ON users.Id = userPosts.OwnerUserId WHERE posts.Tags LIKE '%php%' GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT userPosts.Id) > 3 ORDER BY COUNT(DISTINCT comments.Id) DESC",
    "cypher": "MATCH (user:users)-[:WROTE]->(comment:comments)-[:IS_ON]->(post:posts), (user)-[:OWNS]->(ownPost:posts) WHERE post.Tags CONTAINS 'php' WITH post, count(DISTINCT comment) AS commentCount, count(DISTINCT ownPost) AS ownPostCount WHERE ownPostCount > 3 RETURN post.Title, commentCount, ownPostCount ORDER BY commentCount DESC"
  },
  {
    "question": "Find users who have earned Class 1 badges and have posts with more than 10 total votes",
    "sql": "SELECT users.DisplayName, COUNT(DISTINCT badges.Id), COUNT(DISTINCT votes.Id) FROM users JOIN badges ON users.Id = badges.UserId JOIN posts ON users.Id = posts.OwnerUserId JOIN votes ON posts.Id = votes.PostId WHERE badges.Class = 1 GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT votes.Id) > 10 ORDER BY COUNT(DISTINCT votes.Id) DESC",
    "cypher": "MATCH (user:users)-[:EARNED]->(badge:badges), (user)-[:OWNS]->(post:posts)<-[:VOTED_ON]-(vote:votes) WHERE badge.Class = '1' WITH user, count(DISTINCT badge) AS badgeCount, count(DISTINCT vote) AS voteCount WHERE voteCount > 10 RETURN user.DisplayName, badgeCount, voteCount ORDER BY voteCount DESC"
},
{
"question": "Which users have posts with comments from users who have earned the 'Critic' badge?",
"sql": "SELECT users.DisplayName, COUNT(DISTINCT posts.Id), COUNT(DISTINCT comments.Id) FROM users JOIN posts ON users.Id = posts.OwnerUserId JOIN comments ON posts.Id = comments.PostId JOIN users AS commentUsers ON comments.UserId = commentUsers.Id JOIN badges ON commentUsers.Id = badges.UserId WHERE badges.Name = 'Critic' GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT comments.Id) >= 1 ORDER BY COUNT(DISTINCT posts.Id) DESC",
"cypher": "MATCH (user:users)-[:OWNS]->(post:posts)<-[:IS_ON]-(comment:comments)<-[:WROTE]-(commenter:users)-[:EARNED]->(badge:badges) WHERE badge.Name = 'Critic' WITH user, count(DISTINCT post) AS postCount, count(DISTINCT comment) AS commentCount WHERE commentCount >= 1 RETURN user.DisplayName, postCount, commentCount ORDER BY postCount DESC"
},
{
"question": "Find posts with more than 8 votes that have comments from users located in multiple countries",
"sql": "SELECT posts.Title, COUNT(DISTINCT votes.Id), COUNT(DISTINCT users.Location) FROM posts JOIN votes ON posts.Id = votes.PostId JOIN comments ON posts.Id = comments.PostId JOIN users ON comments.UserId = users.Id GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT votes.Id) > 8 AND COUNT(DISTINCT users.Location) > 1 ORDER BY COUNT(DISTINCT votes.Id) DESC",
"cypher": "MATCH (vote:votes)-[:VOTED_ON]->(post:posts)<-[:IS_ON]-(comment:comments)<-[:WROTE]-(user:users) WITH post, count(DISTINCT vote) AS voteCount, count(DISTINCT user.Location) AS locationCount WHERE voteCount > 8 AND locationCount > 1 RETURN post.Title, voteCount, locationCount ORDER BY voteCount DESC"
},
{
"question": "Which users have created more than 3 questions (PostTypeId 1) and more than 2 answers (PostTypeId 2)?",
"sql": "SELECT users.DisplayName, SUM(CASE WHEN posts.PostTypeId = 1 THEN 1 ELSE 0 END), SUM(CASE WHEN posts.PostTypeId = 2 THEN 1 ELSE 0 END) FROM users JOIN posts ON users.Id = posts.OwnerUserId WHERE posts.PostTypeId IN (1, 2) GROUP BY users.Id, users.DisplayName HAVING SUM(CASE WHEN posts.PostTypeId = 1 THEN 1 ELSE 0 END) > 3 AND SUM(CASE WHEN posts.PostTypeId = 2 THEN 1 ELSE 0 END) > 2 ORDER BY SUM(CASE WHEN posts.PostTypeId = 1 THEN 1 ELSE 0 END) DESC",
"cypher": "MATCH (user:users)-[:OWNS]->(post:posts) WHERE post.PostTypeId IN ['1', '2'] WITH user, sum(CASE WHEN post.PostTypeId = '1' THEN 1 ELSE 0 END) AS questions, sum(CASE WHEN post.PostTypeId = '2' THEN 1 ELSE 0 END) AS answers WHERE questions > 3 AND answers > 2 RETURN user.DisplayName, questions, answers ORDER BY questions DESC"
},
{
"question": "Find posts owned by users with more than 20 badges that have at least 4 comments and 6 votes",
"sql": "SELECT posts.Title, COUNT(DISTINCT badges.Id), COUNT(DISTINCT comments.Id), COUNT(DISTINCT votes.Id) FROM posts JOIN users ON posts.OwnerUserId = users.Id JOIN badges ON users.Id = badges.UserId JOIN comments ON posts.Id = comments.PostId JOIN votes ON posts.Id = votes.PostId GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT badges.Id) > 20 AND COUNT(DISTINCT comments.Id) >= 4 AND COUNT(DISTINCT votes.Id) >= 6 ORDER BY COUNT(DISTINCT badges.Id) DESC",
"cypher": "MATCH (user:users)-[:OWNS]->(post:posts), (user)-[:EARNED]->(badge:badges), (comment:comments)-[:IS_ON]->(post), (vote:votes)-[:VOTED_ON]->(post) WITH post, count(DISTINCT badge) AS badgeCount, count(DISTINCT comment) AS commentCount, count(DISTINCT vote) AS voteCount WHERE badgeCount > 20 AND commentCount >= 4 AND voteCount >= 6 RETURN post.Title, badgeCount, commentCount, voteCount ORDER BY badgeCount DESC"
},
{
"question": "Which users have written comments on posts with titles containing 'best practice' and have earned more than 5 badges?",
"sql": "SELECT users.DisplayName, COUNT(DISTINCT comments.Id), COUNT(DISTINCT badges.Id) FROM users JOIN comments ON users.Id = comments.UserId JOIN posts ON comments.PostId = posts.Id JOIN badges ON users.Id = badges.UserId WHERE posts.Title LIKE '%best practice%' GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT badges.Id) > 5 ORDER BY COUNT(DISTINCT badges.Id) DESC",
"cypher": "MATCH (user:users)-[:WROTE]->(comment:comments)-[:IS_ON]->(post:posts), (user)-[:EARNED]->(badge:badges) WHERE post.Title CONTAINS 'best practice' WITH user, count(DISTINCT comment) AS commentCount, count(DISTINCT badge) AS badgeCount WHERE badgeCount > 5 RETURN user.DisplayName, commentCount, badgeCount ORDER BY badgeCount DESC"
},
{
"question": "Find posts that have been linked to by more than 2 other posts and have votes from users who joined before 2016",
"sql": "SELECT posts.Title, COUNT(DISTINCT postLinks.Id), COUNT(DISTINCT votes.Id) FROM posts JOIN postLinks ON posts.Id = postLinks.RelatedPostId JOIN votes ON posts.Id = votes.PostId JOIN users ON votes.UserId = users.Id WHERE users.CreationDate < '2016-01-01 00:00:00' GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT postLinks.Id) > 2 ORDER BY COUNT(DISTINCT postLinks.Id) DESC",
"cypher": "MATCH (pl:postLinks)-[:POINTS_TO]->(post:posts)<-[:VOTED_ON]-(vote:votes)<-[:CAST]-(user:users) WHERE user.CreationDate < '2016-01-01T00:00:00' WITH post, count(DISTINCT pl) AS linkCount, count(DISTINCT vote) AS voteCount WHERE linkCount > 2 RETURN post.Title, linkCount, voteCount ORDER BY linkCount DESC"
},
{
"question": "Which users have earned badges before 2015 and have voted on posts created after 2018?",
"sql": "SELECT users.DisplayName, COUNT(DISTINCT badges.Id), COUNT(DISTINCT votes.Id) FROM users JOIN badges ON users.Id = badges.UserId JOIN votes ON users.Id = votes.UserId JOIN posts ON votes.PostId = posts.Id WHERE badges.Date < '2015-01-01 00:00:00' AND posts.CreationDate > '2018-01-01 00:00:00' GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT badges.Id) >= 1 AND COUNT(DISTINCT votes.Id) >= 1 ORDER BY COUNT(DISTINCT votes.Id) DESC",
"cypher": "MATCH (user:users)-[:EARNED]->(badge:badges), (user)-[:CAST]->(vote:votes)-[:VOTED_ON]->(post:posts) WHERE badge.Date < '2015-01-01T00:00:00' AND post.CreationDate > '2018-01-01T00:00:00' WITH user, count(DISTINCT badge) AS badgeCount, count(DISTINCT vote) AS voteCount WHERE badgeCount >= 1 AND voteCount >= 1 RETURN user.DisplayName, badgeCount, voteCount ORDER BY voteCount DESC"
},
{
"question": "Find posts with body containing 'exception' that have more than 3 comments and at least 4 votes",
"sql": "SELECT posts.Title, COUNT(DISTINCT comments.Id), COUNT(DISTINCT votes.Id) FROM posts JOIN comments ON posts.Id = comments.PostId JOIN votes ON posts.Id = votes.PostId WHERE posts.Body LIKE '%exception%' GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT comments.Id) > 3 AND COUNT(DISTINCT votes.Id) >= 4 ORDER BY COUNT(DISTINCT votes.Id) DESC",
"cypher": "MATCH (comment:comments)-[:IS_ON]->(post:posts)<-[:VOTED_ON]-(vote:votes) WHERE post.Body CONTAINS 'exception' WITH post, count(DISTINCT comment) AS commentCount, count(DISTINCT vote) AS voteCount WHERE commentCount > 3 AND voteCount >= 4 RETURN post.Title, commentCount, voteCount ORDER BY voteCount DESC"
},
{
"question": "Which users own posts that have been edited by users who have earned the 'Editor' badge?",
"sql": "SELECT users.DisplayName, COUNT(DISTINCT posts.Id), COUNT(DISTINCT postHistory.Id) FROM users JOIN posts ON users.Id = posts.OwnerUserId JOIN postHistory ON posts.Id = postHistory.PostId JOIN users AS editors ON postHistory.UserId = editors.Id JOIN badges ON editors.Id = badges.UserId WHERE badges.Name = 'Editor' GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT postHistory.Id) >= 1 ORDER BY COUNT(DISTINCT posts.Id) DESC",
"cypher": "MATCH (user:users)-[:OWNS]->(post:posts)<-[:RELATES_TO]-(ph:postHistory)<-[:EDITED]-(editor:users)-[:EARNED]->(badge:badges) WHERE badge.Name = 'Editor' WITH user, count(DISTINCT post) AS postCount, count(DISTINCT ph) AS editCount WHERE editCount >= 1 RETURN user.DisplayName, postCount, editCount ORDER BY postCount DESC"
},
{
"question": "Find users who have written more than 8 comments and have voted on posts tagged with 'node.js'",
"sql": "SELECT users.DisplayName, COUNT(DISTINCT comments.Id), COUNT(DISTINCT votes.Id) FROM users JOIN comments ON users.Id = comments.UserId JOIN votes ON users.Id = votes.UserId JOIN posts ON votes.PostId = posts.Id WHERE posts.Tags LIKE '%node.js%' GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT comments.Id) > 8 ORDER BY COUNT(DISTINCT comments.Id) DESC",
"cypher": "MATCH (user:users)-[:WROTE]->(comment:comments), (user)-[:CAST]->(vote:votes)-[:VOTED_ON]->(post:posts) WHERE post.Tags CONTAINS 'node.js' WITH user, count(DISTINCT comment) AS commentCount, count(DISTINCT vote) AS voteCount WHERE commentCount > 8 RETURN user.DisplayName, commentCount, voteCount ORDER BY commentCount DESC"
},
{
"question": "Which posts have been voted on by users in at least 3 different locations?",
"sql": "SELECT posts.Title, COUNT(DISTINCT votes.Id), COUNT(DISTINCT users.Location) FROM posts JOIN votes ON posts.Id = votes.PostId JOIN users ON votes.UserId = users.Id GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT users.Location) >= 3 ORDER BY COUNT(DISTINCT users.Location) DESC",
"cypher": "MATCH (user:users)-[:CAST]->(vote:votes)-[:VOTED_ON]->(post:posts) WITH post, count(DISTINCT vote) AS voteCount, count(DISTINCT user.Location) AS locationCount WHERE locationCount >= 3 RETURN post.Title, voteCount, locationCount ORDER BY locationCount DESC"
},
{
"question": "Find users who have posts that received comments from users who earned more than 10 badges",
"sql": "SELECT users.DisplayName, COUNT(DISTINCT posts.Id), COUNT(DISTINCT comments.Id) FROM users JOIN posts ON users.Id = posts.OwnerUserId JOIN comments ON posts.Id = comments.PostId JOIN users AS commentUsers ON comments.UserId = commentUsers.Id JOIN badges ON commentUsers.Id = badges.UserId GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT badges.Id) > 10 ORDER BY COUNT(DISTINCT posts.Id) DESC",
"cypher": "MATCH (user:users)-[:OWNS]->(post:posts)<-[:IS_ON]-(comment:comments)<-[:WROTE]-(commenter:users)-[:EARNED]->(badge:badges) WITH user, count(DISTINCT post) AS postCount, count(DISTINCT comment) AS commentCount, count(DISTINCT badge) AS badgeCount WHERE badgeCount > 10 RETURN user.DisplayName, postCount, commentCount ORDER BY postCount DESC"
},
{
"question": "Which posts have been edited after 2019 and have received upvotes from users who joined before 2015?",
"sql": "SELECT posts.Title, COUNT(DISTINCT postHistory.Id), COUNT(DISTINCT votes.Id) FROM posts JOIN postHistory ON posts.Id = postHistory.PostId JOIN votes ON posts.Id = votes.PostId JOIN users ON votes.UserId = users.Id WHERE postHistory.CreationDate > '2019-01-01 00:00:00' AND votes.VoteTypeId = 2 AND users.CreationDate < '2015-01-01 00:00:00' GROUP BY posts.Id, posts.Title HAVING COUNT(DISTINCT postHistory.Id) >= 1 AND COUNT(DISTINCT votes.Id) >= 1 ORDER BY COUNT(DISTINCT votes.Id) DESC",
"cypher": "MATCH (ph:postHistory)-[:RELATES_TO]->(post:posts)<-[:VOTED_ON]-(vote:votes)<-[:CAST]-(user:users) WHERE ph.CreationDate > '2019-01-01T00:00:00' AND vote.VoteTypeId = '2' AND user.CreationDate < '2015-01-01T00:00:00' WITH post, count(DISTINCT ph) AS editCount, count(DISTINCT vote) AS voteCount WHERE editCount >= 1 AND voteCount >= 1 RETURN post.Title, editCount, voteCount ORDER BY voteCount DESC"
},
{
"question": "Find users who have written comments on posts they later voted on with at least 3 such interactions",
"sql": "SELECT users.DisplayName, COUNT(DISTINCT posts.Id) FROM users JOIN comments ON users.Id = comments.UserId JOIN posts ON comments.PostId = posts.Id JOIN votes ON posts.Id = votes.PostId AND users.Id = votes.UserId WHERE comments.CreationDate < votes.CreationDate GROUP BY users.Id, users.DisplayName HAVING COUNT(DISTINCT posts.Id) >= 3 ORDER BY COUNT(DISTINCT posts.Id) DESC",
"cypher": "MATCH (user:users)-[:WROTE]->(comment:comments)-[:IS_ON]->(post:posts)<-[:VOTED_ON]-(vote:votes)<-[:CAST]-(user) WHERE comment.CreationDate < vote.CreationDate WITH user, count(DISTINCT post) AS postCount WHERE postCount >= 3 RETURN user.DisplayName, postCount ORDER BY postCount DESC"
}
]